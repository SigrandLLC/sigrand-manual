<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"/usr/share/xml/docbook/schema/dtd/4.5/docbookx.dtd">
<book lang="en">
  <bookinfo>
    <title>SG-17R User Manual</title>

    <copyright>
      <year>2007</year>

      <year>2009</year>

      <year>2010</year>

      <holder>2011 SIGRAND LLC</holder>
    </copyright>

    <author>
       <firstname>A. Kazantsev</firstname>
    </author>

    <legalnotice>
      <para>All the trademarks, signs and copyrights associated with the items
      mentioned in this paper belong to the relevant rights holders.</para>
    </legalnotice>

    <abstract>
      <para>This Manual concernes such aspects as adjustment and operation of
      the routers of the 17th series manufactured by LLC SIGRAND (
      SG-17R).</para>

      <para>A brief description of characteristics, options, operational
      conditions, network interfaces settings and supported modules of the
      router is given.</para>

      <para>Network interfaces and services adjustement procedures, and
      different operational modes of the router (multiplexing, bridging,
      bonding, VLAN, QoS, VoIP and others) are explained.</para>
    </abstract>
  </bookinfo>

  <chapter>
    <title>Description of the Router SG-17R</title>

    <para>The Router SG-17R is a multifunctional device comprising an
    IP-router, DSL modem, E1/DSL multiplexer and VoIP gateway. The Router
    SG-17R has plugin architecture including E1, SHDSL, RS-232 and VoIP (FXO,
    FXS, VF) plugins, which permit the use of various protocols and physical
    links. There exist a possibility of use together with SG-17E signal
    regenerators, which allow to extend the operating distance on retention of
    the correct speed. Using the SHDSL equipment it is possible to obtain
    information about the communication lines for all the regenerators
    operating on line.</para>

    <para>The software for the router is developed on the basis of the
    operational system GNU/Linux with the core ver. 2.6 and is distributed in
    accordance with the licence agreement GNU GPL.</para>

    <important>
      <title>Liability Restriction</title>

      <para>The manufacturer, for obvious reasons, does not hold
      responsibility for the performance of the software developed by third
      parties which was not tested for compatibility with the basic software
      of the LLC SIGRAND device. We are not responsible for the outcomes of
      use of such software which can lead to disability or to limitatiton of
      device functionality.</para>
    </important>

    <para>The Router SG-17R has the following functional:</para>

    <itemizedlist>
      <listitem>
        <para>Adjustement through web-interface.</para>
      </listitem>

      <listitem>
        <para>Configuration upload and failback.</para>
      </listitem>

      <listitem>
        <para>Saving of changeable interfaces settings with reference to slot
        number.</para>
      </listitem>

      <listitem>
        <para>Logging.</para>
      </listitem>
    </itemizedlist>

    <itemizedlist>
      <listitem>
        <para>Independent adjustement of Ethernet-ports forming parts of the
        base platforms.</para>
      </listitem>

      <listitem>
        <para>Additional Ethernet-services on the basis of VLAN
        technologies.</para>
      </listitem>

      <listitem>
        <para>Multiplexing of synchronous channels.</para>
      </listitem>

      <listitem>
        <para>Transfer of IP-traffic under bridging and routing modes.</para>
      </listitem>

      <listitem>
        <para>In multiplexing mode, if multi-pair connection is used, it is
        possible to agregate trace tails of E1 threads into one logical
        channel to transport the Ethernet.</para>
      </listitem>

      <listitem>
        <para>Banding of physical interfaces for data transport
        speeding.</para>
      </listitem>

      <listitem>
        <para>Supporting of network interfaces: SHDSL, E1, Ethernet, RS-232,
        FXO/FXS, VF (TFC).</para>
      </listitem>

      <listitem>
        <para>Working with SHDSL interfaces, providing rates up to 14 Mbit/s
        at one pair.</para>
      </listitem>

      <listitem>
        <para>Providing remote feed for regenerators SG-17E-P, modems SG-17B-P
        .</para>
      </listitem>

      <listitem>
        <para>Supporting network services: DHCP, DNS.</para>
      </listitem>

      <listitem>
        <para>Traffic control: NAT, Firewall, QoS.</para>
      </listitem>

      <listitem>
        <para>Built-in SHDSL track monitoring up to G.SHDSL (G.991.2)
        standard.</para>
      </listitem>

      <listitem>
        <para>Supporting SNMP: MIB-II, HDSL2-SHDSL-LINE-MIB.</para>
      </listitem>
    </itemizedlist>
  </chapter>

  <chapter>
    <title>Distribution Kit</title>

    <section>
      <title>SG-17R</title>

      <itemizedlist>
        <listitem>
          <para>Mounting of the router.</para>
        </listitem>

        <listitem>
          <para>Using DC 36-72V type of power supply— mating connector of
          power socket.</para>
        </listitem>

        <listitem>
          <para>Using 220V/50Hz type of power supply— power cord.</para>
        </listitem>

        <listitem>
          <para>Terminal cord DB-9M — DB-9F — a cord for terminal
          connection.</para>
        </listitem>

        <listitem>
          <para>CD with software and documentation.</para>
        </listitem>

        <listitem>
          <para>Warranty certificate.</para>
        </listitem>
      </itemizedlist>
    </section>
  </chapter>

  <chapter id="hw">
    <title>Technical Description</title>

    <section id="hw.desc">
      <title>Characteristics and Parameters of the Device</title>

      <section id="hw.desc.common">
        <title>Common Parameters</title>

        <itemizedlist>
          <listitem>
            <para><emphasis>Processor</emphasis> : 32-bit MIPS processor with
            4KC core, performance 227 MIPS.</para>
          </listitem>

          <listitem>
            <para><emphasis>Core memory</emphasis> : 64 MB SDRAM.</para>
          </listitem>

          <listitem>
            <para><emphasis>Disk memory </emphasis>: 32 MB flash.</para>
          </listitem>

          <listitem>
            <para><emphasis>Interfaces</emphasis> :</para>

            <itemizedlist>
              <listitem>
                <para>4 Ethernet/Fast Ethernet, auto negotiations, auto
                MDI/MDI-X.</para>
              </listitem>

              <listitem>
                <para><emphasis>RS-232C</emphasis> — for router
                management.</para>
              </listitem>

              <listitem>
                <para>4 slots for optional modules.</para>
              </listitem>
            </itemizedlist>
          </listitem>

          <listitem>
            <para><emphasis>Dimensions, </emphasis>mm : 438x258x43.</para>
          </listitem>

          <listitem>
            <para>Power supply: 220 V/50 Hz or 36-72 V constant current
            (depending on the model and the delivery).</para>
          </listitem>

          <listitem>
            <para><emphasis>Base platform weight, kg </emphasis> : 3,9 for
            220V/50 Hz type and 3,3 for 36-72 V constant current type.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="hw.desc.rs232">
        <title id="hw.desc.rs232.title">Parameters of RS-232C Interface
        (console port)</title>

        <itemizedlist>
          <listitem>
            <para><emphasis>Connector type</emphasis> : DB-9F.</para>
          </listitem>

          <listitem>
            <para><emphasis>Data transfer rate, bit/sec</emphasis> : 115
            200.</para>
          </listitem>

          <listitem>
            <para><emphasis>Protocol</emphasis> : 8-N-1.</para>
          </listitem>

          <listitem>
            <para><emphasis>Traffic control</emphasis> : no.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="hw.desc.shdsl">
        <title>Parameters of SHDSL Line Interface (extension modules)</title>

        <itemizedlist>
          <listitem>
            <para><emphasis>Connector type</emphasis> : RJ-45 (socket).</para>
          </listitem>

          <listitem>
            <para><emphasis>Interface type</emphasis> : G.SHDSL (recommended
            ITU-T G.991.2.bis).</para>
          </listitem>

          <listitem>
            <para><emphasis>Connection type</emphasis> : point-to
            point.</para>
          </listitem>

          <listitem>
            <para><emphasis>Number of communication line cables</emphasis> : 2
            (one pair). Contacts in use 4 and 5.</para>
          </listitem>

          <listitem>
            <para><emphasis>Data transfer rate, Kbit/sec</emphasis> : 192
            to14080.</para>
          </listitem>

          <listitem>
            <para>Linear code : TCPAM.</para>
          </listitem>

          <listitem>
            <para>Connection type : full duplex.</para>
          </listitem>

          <listitem>
            <para>Distant feed (for models with distant feed option)</para>

            <itemizedlist>
              <listitem>
                <para><emphasis>Voltage, V</emphasis> : 240.</para>
              </listitem>

              <listitem>
                <para><emphasis>Maximum current, mA</emphasis> : 70.</para>
              </listitem>
            </itemizedlist>
          </listitem>

          <listitem>
            <para><emphasis>Number of interfaces depending on module
            modification </emphasis>: 1, 2.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="hw.desc.e1">
        <title>Parameters of E1 Interface (extension modules)</title>

        <itemizedlist>
          <listitem>
            <para><emphasis>Connector type</emphasis> : RJ-45 (socket).</para>
          </listitem>

          <listitem>
            <para><emphasis>Number of communication line cables</emphasis> : 4
            (two pairs). Contacts 4, 5 are used for transmission, 1, 2 — for
            reception.</para>
          </listitem>

          <listitem>
            <para><emphasis>Linear code (ITU-T G.703)</emphasis> : HDB3,
            AMI.</para>
          </listitem>

          <listitem>
            <para><emphasis>Data transfer rate</emphasis> : Nx64 Kbit/sec,
            where N=1:32, for each of E1 Interfaces (64:2048 Kbit/sec in
            incriments of 64 Kbit/sec).</para>
          </listitem>

          <listitem>
            <para><emphasis>Distance to Equipment (DTE), km</emphasis> : 2,4
            (for cable of 0,5 mm), 1,6 (for cable of 0,4 mm).</para>
          </listitem>

          <listitem>
            <para><emphasis>Cyclic structure (framing)</emphasis> :
            G.704.</para>
          </listitem>

          <listitem>
            <para><emphasis>Supercycles (superframe)</emphasis> : CRC4,
            CAS.</para>
          </listitem>

          <listitem>
            <para><emphasis>Cyclic structure shutdown option (unframed
            mode)</emphasis> : yes.</para>
          </listitem>

          <listitem>
            <para><emphasis>Number of interfaces depending on module
            modification</emphasis> : 1, 2, 4, 8.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section>
        <title>Parameters of RS-232 Interface (extension modules)</title>

        <itemizedlist>
          <listitem>
            <para><emphasis>Connector type</emphasis> : DB-9F (DCE), DB-9M
            (DTE).</para>
          </listitem>

          <listitem>
            <para>Interface type: RS-232 (V.28).</para>
          </listitem>

          <listitem>
            <para><emphasis>Data transfer rate, bit/sec</emphasis> : 300 to
            230400.</para>
          </listitem>

          <listitem>
            <para><emphasis>Data capacity</emphasis> : 7 or 8 bit.</para>
          </listitem>

          <listitem>
            <para><emphasis>Number of stop bits</emphasis> : 1 or 2.</para>
          </listitem>

          <listitem>
            <para><emphasis>Evenness</emphasis> : ODD, EVEN, NONE.</para>
          </listitem>

          <listitem>
            <para><emphasis>Commands</emphasis> : DTR/DSR, RTS/CTS, CD,
            RI.</para>
          </listitem>

          <listitem>
            <para><emphasis><emphasis>Number of interfaces depending on module
            modification</emphasis></emphasis> : 2, 4.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="hw.desc.voip">
        <title id="hw.desc.voip.title">Parameters of Carrying Module for VoIP
        Interfaces (extension module)</title>

        <itemizedlist>
          <listitem>
            <para><emphasis>Setup interface for submodules</emphasis> : 2
            slots: 40+10 contacts (system part and linear part).</para>
          </listitem>

          <listitem>
            <para><emphasis>Maximum of submodules</emphasis> to install:
            4.</para>
          </listitem>

          <listitem>
            <para>Supported submodules: FXO, FXS, FV in any
            combination.</para>
          </listitem>

          <listitem>
            <para><emphasis>Number of interfaces VoIP depending on the
            occupancy of the module with the submodules</emphasis> : 2, 4, 6,
            8.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section>
        <title>Parameters of FXO Interfaces (extension submodule)</title>

        <itemizedlist>
          <listitem>
            <para><emphasis>Connector type </emphasis>: RJ-11.</para>
          </listitem>

          <listitem>
            <para><emphasis>Battery voltage, V </emphasis>: 30-72.</para>
          </listitem>

          <listitem>
            <para><emphasis>Ring voltage range, V</emphasis>: 30-120.</para>
          </listitem>

          <listitem>
            <para><emphasis>Ringing signal frequency, Hz</emphasis> :
            15-65.</para>
          </listitem>

          <listitem>
            <para><emphasis>Two wire termination total resistance, Ohm
            </emphasis>: 600.</para>
          </listitem>

          <listitem>
            <para><emphasis>Codecs in use</emphasis></para>

            <itemizedlist>
              <listitem>
                <para><emphasis>High quality</emphasis> : G711 (A-law).</para>
              </listitem>

              <listitem>
                <para><emphasis>High speed</emphasis> : G729.</para>
              </listitem>

              <listitem>
                <para>Full VoIP codec stack support option.</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>

        <itemizedlist>
          <listitem>
            <para><emphasis>Number of interfaces on one submodule</emphasis> :
            2.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section>
        <title>Parameters of FXS Interfaces (extension submodule)</title>

        <itemizedlist>
          <listitem>
            <para><emphasis>Connector type </emphasis>: RJ-11.</para>
          </listitem>

          <listitem>
            <para><emphasis>Battery voltage, V </emphasis>: 48.</para>
          </listitem>

          <listitem>
            <para><emphasis>Ring voltage range, V</emphasis> : 65.</para>
          </listitem>

          <listitem>
            <para><emphasis>Maximum load, REN</emphasis> : 3.</para>
          </listitem>

          <listitem>
            <para><emphasis>Two wire termination total resistance, Ohm
            </emphasis>: 600.</para>
          </listitem>

          <listitem>
            <para><emphasis>Codecs in use</emphasis></para>
          </listitem>
        </itemizedlist>

        <itemizedlist>
          <listitem>
            <itemizedlist>
              <listitem>
                <para><emphasis>High quality</emphasis> : G711 (A-law).</para>
              </listitem>

              <listitem>
                <para><emphasis>High speed</emphasis> : G729.</para>
              </listitem>

              <listitem>
                <para>Full VoIP codec stack support option</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>

        <itemizedlist>
          <listitem>
            <para><emphasis>Number of interfaces on one submodule</emphasis> :
            2.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section>
        <title>Parameters of VF - signaling channels (extension
        submodule)</title>

        <itemizedlist>
          <listitem>
            <para><emphasis>Connector type </emphasis>: RJ-11.</para>
          </listitem>

          <listitem>
            <para><emphasis>Parameters of four wire
            termination</emphasis></para>

            <itemizedlist>
              <listitem>
                <para>Contacts: 3-4 - reception (output), 2-5 - transmission
                (input).</para>
              </listitem>

              <listitem>
                <para><emphasis>Input and output impedance, Ohm</emphasis> :
                600.</para>
              </listitem>

              <listitem>
                <para><emphasis>Channel input relative level, dBr</emphasis> :
                minus 13.</para>
              </listitem>

              <listitem>
                <para><emphasis>Channel output relative level, </emphasis>dBr
                : plus 4.</para>
              </listitem>

              <listitem>
                <para><emphasis>Channel input relative level in transit mode,
                dBr</emphasis> : plus4.</para>
              </listitem>

              <listitem>
                <para><emphasis>Channel output relative level in transit mode,
                </emphasis>dBr: plus 4.</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>

        <itemizedlist>
          <listitem>
            <para><emphasis>Parameters of two wire
            termination</emphasis></para>

            <itemizedlist>
              <listitem>
                <para>Contacts: 3,4 - reception/transmission.</para>
              </listitem>

              <listitem>
                <para><emphasis>Input and output impedance, Ohm</emphasis> :
                600.</para>
              </listitem>

              <listitem>
                <para><emphasis>Channel input relative level, dBr</emphasis> :
                0.</para>
              </listitem>

              <listitem>
                <para><emphasis>Channel output relative level, dBr</emphasis>
                : minus 7.</para>
              </listitem>

              <listitem>
                <para><emphasis>Channel input relative level in transit mode,
                dBr</emphasis> : minus 3,5.</para>
              </listitem>

              <listitem>
                <para><emphasis>Channel output relative level in transit mode,
                dBr</emphasis> : minus 3,5.</para>
              </listitem>
            </itemizedlist>
          </listitem>

          <listitem>
            <para><emphasis>Number of interfaces on one submodule</emphasis> :
            2..</para>
          </listitem>
        </itemizedlist>
      </section>

      <section>
        <title>Operation conditions</title>

        <para>Router is meant for operation in a closed heated space under the
        following environmental conditions:</para>

        <itemizedlist>
          <listitem>
            <para><emphasis>Air temperature, °C</emphasis> : 10 .. 40.</para>
          </listitem>

          <listitem>
            <para><emphasis>Relative air humidity, %</emphasis> : up to
            85.</para>
          </listitem>

          <listitem>
            <para><emphasis>Air pressure, Kpa</emphasis> : 84 .. 107.</para>
          </listitem>
        </itemizedlist>
      </section>
    </section>

    <section id="hw.shdsl.details">
      <title>SHDSL Characteristics</title>

      <section id="hw.shdsl.details.speed">
        <title>Operating Distance and Rate</title>

        <section>
          <title>Test Conditions</title>

          <para>The information about operating distance and rate is given
          below. The results are obtained on lines of such length, where Bit
          Error Rate (BER) is equal to or less than 10
          <superscript>-7</superscript> . The specified distance is estimated
          experimentally on the control communication line of the company`s
          laboratory.</para>

          <para>The results obtained while operating a concrete communication
          line may differ from the indicated values due to differences in
          characteristics of this line and the reference line.</para>

          <para>Different series of routers and different modules show
          different values of distance/rate.</para>
        </section>

        <section>
          <title>Modules MR-17H</title>

          <para>Table of distance/ratefor SHDSL modules MR-17H.</para>

          <table frame="all">
            <title>Table of distance/rate for SHDSL modules MR-17H</title>

            <tgroup align="center" cols="4">
              <thead>
                <row>
                  <entry>Rate, Kbit/s</entry>

                  <entry>0.5 mm cable, km</entry>

                  <entry>0.9 mm cable, km (*)</entry>

                  <entry>1.2 mm cable, km (*)</entry>
                </row>
              </thead>

              <tbody>
                <row>
                  <entry>15296 (**)</entry>

                  <entry>0,6</entry>

                  <entry></entry>

                  <entry></entry>
                </row>

                <row>
                  <entry>14080</entry>

                  <entry>1,2</entry>

                  <entry>3,6</entry>

                  <entry>5,8</entry>
                </row>

                <row>
                  <entry>12800</entry>

                  <entry>1,2</entry>

                  <entry>3,8</entry>

                  <entry>6,4</entry>
                </row>

                <row>
                  <entry>11520</entry>

                  <entry>1,4</entry>

                  <entry>4,2</entry>

                  <entry>6,4</entry>
                </row>

                <row>
                  <entry>10240</entry>

                  <entry>2,0</entry>

                  <entry>4,6</entry>

                  <entry>7,2</entry>
                </row>

                <row>
                  <entry>9216</entry>

                  <entry>2,2</entry>

                  <entry>4,8</entry>

                  <entry>7,4</entry>
                </row>

                <row>
                  <entry>8192</entry>

                  <entry>2,4</entry>

                  <entry>5,0</entry>

                  <entry>8,0</entry>
                </row>

                <row>
                  <entry>7168</entry>

                  <entry>3,0</entry>

                  <entry>5,4</entry>

                  <entry>8,4</entry>
                </row>

                <row>
                  <entry>6144</entry>

                  <entry>3,4</entry>

                  <entry>6,0</entry>

                  <entry>9,0</entry>
                </row>

                <row>
                  <entry>5696</entry>

                  <entry>3,6</entry>

                  <entry>6,8</entry>

                  <entry>10,6</entry>
                </row>

                <row>
                  <entry>5120</entry>

                  <entry>3,8</entry>

                  <entry>7,2</entry>

                  <entry>12,0</entry>
                </row>

                <row>
                  <entry>4608</entry>

                  <entry>4,0</entry>

                  <entry>7,4</entry>

                  <entry>13,0</entry>
                </row>

                <row>
                  <entry>4096</entry>

                  <entry>4,4</entry>

                  <entry>8,0</entry>

                  <entry>14,0</entry>
                </row>

                <row>
                  <entry>3072</entry>

                  <entry>5,0</entry>

                  <entry>9,0</entry>

                  <entry>15,8</entry>
                </row>

                <row>
                  <entry>2304</entry>

                  <entry>5,4</entry>

                  <entry>10,6</entry>

                  <entry>17,0</entry>
                </row>

                <row>
                  <entry>2048</entry>

                  <entry>6,2</entry>

                  <entry>12,6</entry>

                  <entry>19,4</entry>
                </row>

                <row>
                  <entry>1536</entry>

                  <entry>7,0</entry>

                  <entry>14,8</entry>

                  <entry>22,2</entry>
                </row>

                <row>
                  <entry>1024</entry>

                  <entry>7,8</entry>

                  <entry>17,0</entry>

                  <entry>26,0</entry>
                </row>

                <row>
                  <entry>768</entry>

                  <entry>8,4</entry>

                  <entry>18,4</entry>

                  <entry>28,0</entry>
                </row>

                <row>
                  <entry>512</entry>

                  <entry>9,0</entry>

                  <entry>19,8</entry>

                  <entry>30,0</entry>
                </row>

                <row>
                  <entry>384</entry>

                  <entry>9,6</entry>

                  <entry>21,2</entry>

                  <entry>32,0</entry>
                </row>

                <row>
                  <entry>192</entry>

                  <entry>10,4</entry>

                  <entry>23,0</entry>

                  <entry>35,0</entry>
                </row>
              </tbody>
            </tgroup>
          </table>

          <para><note>
              <para>(*) - not all data obtained expermentally</para>

              <para>(**) - rate of 15296 Kbit/s is possible only for
              modulesMS-17H4 for SG-17S base platform.</para>
            </note></para>
        </section>
      </section>

      <section>
        <title>Link connection</title>

        <warning>
          <para>Make sure that the dedicated line does not have any electrical
          sources and is not connected to central office equipment.
          Non-observance of this rule may lead to the failure of the router or
          of the equipment installed on the line!</para>
        </warning>

        <para>For normal performance of routers and maintenance of the set-up
        parameters, the communication line should comply with the following
        requirements:</para>

        <itemizedlist>
          <listitem>
            <para>The use of thermal switches on communication line is not
            recommended. The presence of thermal switches lead to considerable
            decrease in rate. Operation on coil-loaded lines is also
            unpracticable.</para>
          </listitem>

          <listitem>
            <para>The cable should not have any closing wires and leakages to
            ground and to other conductors, including those not connected to
            something. There should not be any branching on line.</para>
          </listitem>

          <listitem>
            <para>In multipair cable, the wires should be taken from one and
            the same pair.</para>
          </listitem>

          <listitem>
            <para>Parallel connection of several pairs (e.g. to reduce the
            active resistance) is not allowed.</para>
          </listitem>
        </itemizedlist>

        <para>Non-compliance with the above-mentioned requirements may lead to
        the reduce of the performance or to the failure of the overall
        communication line.</para>

        <para>In order to connect the line to the router, mount the plug RJ-45
        on the cable. The router uses only one pair of wires, pins 4 and 5,
        other pins are not used.</para>

        <figure>
          <title>Connector RJ-45</title>

          <graphic fileref="img/hw-rj45_en.png" />
        </figure>

        <para>After that plug the cable into SHDSL port of the router.</para>
      </section>
    </section>

    <section id="hw.sg-17r">
      <title id="SlotD.title">Layout, functions of indicators and connectors
      of SG-17R</title>

      <para>The router Sigrand SG-17R is supplied in shape form 19" to install
      into a communication box. The layout of the front panel without the
      attached modules is depicted in the figure below.</para>

      <figure>
        <title>Front panel without plugged-in modules</title>

        <graphic fileref="img/chassis_front_en.png" width="6in" />
      </figure>

      <figure>
        <title>Front panel</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="img/chassis_front_aux_en.png" width="6in" />
          </imageobject>
        </mediaobject>
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>0,1,2,3</emphasis> — slots for installation of
          replaceable modules.</para>

          <important>
            <para>The slot 3 can be used only for installation of SHDSL and E1
            modules in <emphasis>multiplexing mode</emphasis>. The relevant
            network interface will be visible within the system and will be
            adjustementable, however it will not have an option to transmit
            the network traffic (the traffic which is thansmitted via other
            lines, not multiplexing ones). It is due to the absence of DMA
            support for the given slot. The slot 3 does not impose any
            restrictions on the use of the RS-232 and VoIP modules.<emphasis>
            </emphasis></para>
          </important>
        </listitem>

        <listitem>
          <para><emphasis>Console</emphasis> — RS-232C a port for router
          management.</para>
        </listitem>

        <listitem>
          <para><emphasis>Ethernet ports</emphasis> — RJ-45 ports for Ethernet
          interface connection.</para>
        </listitem>

        <listitem>
          <para><emphasis>Ethernet ports indication</emphasis> — each channel
          corresponds with two indicators:</para>

          <itemizedlist>
            <listitem>
              <para>Upper — <emphasis>DPX</emphasis> :</para>

              <itemizedlist>
                <listitem>
                  <para><emphasis>On</emphasis> — full duplex mode.</para>
                </listitem>

                <listitem>
                  <para>Off — half duplex mode.</para>
                </listitem>

                <listitem>
                  <para><emphasis>Flashing</emphasis> — channel
                  collision.</para>
                </listitem>
              </itemizedlist>
            </listitem>

            <listitem>
              <para>Lower — <emphasis>LNK</emphasis> :</para>

              <itemizedlist>
                <listitem>
                  <para><emphasis>On</emphasis> — connected with a remote
                  device.</para>
                </listitem>

                <listitem>
                  <para><emphasis>Off</emphasis> — no connection with a remote
                  device.</para>
                </listitem>

                <listitem>
                  <para><emphasis>Flashing</emphasis> — data exchange is in
                  process.</para>
                </listitem>
              </itemizedlist>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para><emphasis>Power button</emphasis> — router start
          button.</para>
        </listitem>

        <listitem>
          <para><emphasis>Power indicator</emphasis> — on when the router is
          switched on.</para>
        </listitem>
      </itemizedlist>

      <para>The layout of the back panel of the router with 36-72V direct
      current (DC) power supply is depicted below .</para>

      <figure>
        <title>Back panel with 36-72V DC power supply</title>

        <graphic fileref="img/chassis_back_DC_en.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Power socket</emphasis> — for electrical connection
          (36-72V DC).</para>
        </listitem>
      </itemizedlist>

      <para>The layout of the back panel of the router with 220V/50GHz is
      depicted below.</para>

      <figure>
        <title>Back panel with 220V/50Hz power supply</title>

        <graphic fileref="img/chassis_back_AC_en.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis><emphasis><emphasis><emphasis><emphasis>Power
          socket</emphasis></emphasis></emphasis> </emphasis>—</emphasis> for
          electrical connection 220V/50Hz.</para>
        </listitem>
      </itemizedlist>

      <para>The layout of the front panel with the mounted SHDSL and E1
      modules is depicted below.</para>

      <figure>
        <title>Front panel with mounted modules</title>

        <graphic fileref="img/chassis_front_full.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Modules SHDSL</emphasis> — two double-channel
          modules SHDSL with distant feed.</para>
        </listitem>

        <listitem>
          <para><emphasis>Modules E1</emphasis> — two double-channel modules
          E1.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="hw.modules">
      <title>Changeable Interfaces</title>

      <para>While operating a SG-17R router, there is a possibility to extend
      its functionality using changeable modules - at the moment these are
      SHDSL, E1, RS-232 and VoIP (FXO, FXS, VF - tone frequency
      channels).</para>

      <section id="hw.modules.dsl">
        <title>SHDSL Modules</title>

        <para>There are several types of SHDSL modules:</para>

        <itemizedlist>
          <listitem>
            <para>One channel SHDSL no distant feed (MR-17H1).</para>
          </listitem>

          <listitem>
            <para>Two channels SHDSL no distant feed (MR-17H2).</para>
          </listitem>

          <listitem>
            <para>One channel SHDSL with distant feed (MR-17H1P2).</para>
          </listitem>

          <listitem>
            <para>Two channels SHDSL with distant feed (MR-17H2P2).</para>
          </listitem>
        </itemizedlist>

        <figure>
          <title>One SHDSL channel module without distant feed
          (MR-17H1)</title>

          <graphic fileref="img/Module_h1_en.png" width="6in" />
        </figure>

        <figure>
          <title>One SHDSL channel module with distant feed
          (MR-17H1P2)</title>

          <graphic fileref="img/Module_h1p_en.png" width="6in" />
        </figure>

        <figure>
          <title>Two SHDSL channels module without distant feed
          (MR-17H2)</title>

          <graphic fileref="img/Module_h2_en.png" width="6in" />
        </figure>

        <figure>
          <title>Two SHDSL channels module withdistant feed
          (MR-17H2P2)</title>

          <graphic fileref="img/Module_h2p_en.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>SHDSL ports</emphasis> — RJ-45 ports for SHDSL
            interface connection .</para>
          </listitem>

          <listitem>
            <para><emphasis>SHDSL indicators</emphasis></para>

            <itemizedlist>
              <listitem>
                <para><emphasis>ERR</emphasis> :</para>

                <itemizedlist>
                  <listitem>
                    <para>Off — no jabbers.</para>
                  </listitem>

                  <listitem>
                    <para><emphasis>Flashing</emphasis> — a jabber is
                    received.</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para><emphasis>LINK</emphasis> :</para>

                <itemizedlist>
                  <listitem>
                    <para><emphasis>On</emphasis> — connected with a remote
                    device.</para>
                  </listitem>

                  <listitem>
                    <para><emphasis>Off</emphasis> — no connection with a
                    remote device.</para>
                  </listitem>

                  <listitem>
                    <para>Flashing — connection is in process.</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para><emphasis>UNB</emphasis> :</para>

                <itemizedlist>
                  <listitem>
                    <para><emphasis>On</emphasis> — power supply balance is
                    broken to earth. Norm is plus120 V at one wire, and
                    minus120 V at the other. If the shift exceeds 30 V or the
                    grounding is absent - it implies power imbalance.</para>
                  </listitem>

                  <listitem>
                    <para><emphasis>Off</emphasis>— power balance is
                    normal.</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para><emphasis>OVL</emphasis> :</para>

                <itemizedlist>
                  <listitem>
                    <para><emphasis>On</emphasis> — power overload or short
                    circuit on line. It is associated with an excess number
                    (more than 4) of regeneraters on line, adjusted to get
                    feed from this router.</para>
                  </listitem>

                  <listitem>
                    <para><emphasis>Off</emphasis> — no power overload.</para>
                  </listitem>
                </itemizedlist>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>
      </section>

      <section id="hw.modules.e1">
        <title>E1 Modules</title>

        <para>There are several types of E1 modules:</para>

        <itemizedlist>
          <listitem>
            <para>One channel E1 (MR-17G).</para>
          </listitem>

          <listitem>
            <para>Two channels E1 (MR-17G2).</para>
          </listitem>

          <listitem>
            <para>Four channels E1 (MR-17G4).</para>
          </listitem>

          <listitem>
            <para>Eight channels E1 (MR-17G8).</para>
          </listitem>
        </itemizedlist>

        <figure>
          <title>One E1 channel module (MR-17G)</title>

          <graphic fileref="img/Module_g1_en.png" width="6in" />
        </figure>

        <figure>
          <title>Two E1 channels module (MR-17G2)</title>

          <graphic fileref="img/Module_g2_en.png" width="6in" />
        </figure>

        <figure>
          <title>Four E1 channels module (MR-17G4)</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="img/Module_g4_en.png" width="6in" />
            </imageobject>
          </mediaobject>
        </figure>

        <figure>
          <title>Eight E1 channels module (MR-17G8)</title>

          <mediaobject>
            <imageobject>
              <imagedata fileref="img/Module_g8_en.png" width="6in" />
            </imageobject>
          </mediaobject>
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Ports E1</emphasis> — RJ-45 ports for E1 interface
            connection.</para>
          </listitem>

          <listitem>
            <para><emphasis>E1 Indicators</emphasis></para>

            <itemizedlist>
              <listitem>
                <para><emphasis>On</emphasis> — connected with a remote
                device.</para>
              </listitem>

              <listitem>
                <para><emphasis>Off</emphasis> — no connection with a remote
                device.</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>
      </section>

      <section>
        <title>RS-232 Modules</title>

        <para>There are several types of RS-232 modules:</para>

        <itemizedlist>
          <listitem>
            <para>Two channels RS-232 DCE (MR-17S2C).</para>
          </listitem>

          <listitem>
            <para>Two channels RS-232 DTE (MR-17S2T).</para>
          </listitem>

          <listitem>
            <para>Four channels RS-232 DCE (MR-17S4C).</para>
          </listitem>

          <listitem>
            <para>Four channels RS-232 DTE (MR-17S4T).</para>

            <figure>
              <title>Two RS-232 DCE channels module (MR-17S2C)</title>

              <mediaobject>
                <imageobject>
                  <imagedata fileref="img/Module_s2c_en.png" width="6in" />
                </imageobject>
              </mediaobject>
            </figure>

            <figure>
              <title>Two RS-232 DTE channels module (MR-17S2T)</title>

              <mediaobject>
                <imageobject>
                  <imagedata fileref="img/Module_s2t_en.png" width="6in" />
                </imageobject>
              </mediaobject>
            </figure>

            <figure>
              <title>Four RS-232 DCE channels module (MR-17S4C)</title>

              <mediaobject>
                <imageobject>
                  <imagedata fileref="img/Module_s4c_en.png" width="6in" />
                </imageobject>
              </mediaobject>
            </figure>

            <figure>
              <title>Four RS-232 DTE channels module (MR-17S2T)</title>

              <mediaobject>
                <imageobject>
                  <imagedata fileref="img/Module_s4t_en.png" width="6in" />
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
        </itemizedlist>
      </section>

      <section>
        <title>Modules for VoIP Submodules Mounting.</title>

        <para>There are sevelar carrying modules meant for mounting of VoIP
        submodules (FXO, FXS, VF - tone frequency channels):</para>

        <itemizedlist>
          <listitem>
            <para>For two submodules or four VoIP channels (MR-17V4).</para>
          </listitem>

          <listitem>
            <para>For four submodules or eight VoIP channels (MR-17V8).</para>

            <figure>
              <title>Four VoIP channels module (MR-17V4)</title>

              <mediaobject>
                <imageobject>
                  <imagedata fileref="img/Module_v4_en.png" width="6in" />
                </imageobject>
              </mediaobject>
            </figure>

            <figure>
              <title>Eight VoIP channels module (MR-17V8)</title>

              <mediaobject>
                <imageobject>
                  <imagedata fileref="img/Module_v8_en.png" width="6in" />
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
        </itemizedlist>
      </section>

      <section id="hw.modules.install">
        <title>Installation of Changeable Interfaces</title>

        <important>
          <para>For modules mounting slots 0, 1, 2, 3 of the router can be
          used (read "Important" in Section <link endterm="SlotD.title"
          linkend="hw.sg-17r"></link> slot 3 usage restrictions).</para>
        </important>

        <figure>
          <title>Front panel without changeable modules</title>

          <graphic fileref="img/chassis_front_en.png" width="6in" />
        </figure>

        <para>Mounting of a odule is performed as follows:</para>

        <orderedlist>
          <listitem>
            <para>Switch off the router.</para>
          </listitem>

          <listitem>
            <para>Remove the plug sealing the slot.</para>
          </listitem>

          <listitem>
            <para>Place the module into the slot.</para>
          </listitem>

          <listitem>
            <para>Fix it with the help of screw knobs.</para>
          </listitem>

          <listitem>
            <para>Switch on the router and carry out the adjustment of the
            mounted module.</para>
          </listitem>
        </orderedlist>
      </section>
    </section>
  </chapter>

  <chapter>
    <title>Start of Work with Router</title>

    <section id="firstboot">
      <title id="firstboot.title">Getting ready for the first
      switch-on</title>

      <important>
        <para>Make sure that there are no visible damages which could occur
        while transporting the device. If there are any, please, contact the
        LLC Sigrand guarantee service as soon as possible.</para>
      </important>

      <warning>
        <para>In case the device was transported or stored at temperatures
        below zero - the switch-on should be made after the device spend at
        least one hour at room-temperature!</para>
      </warning>

      <para>Remove the packing and place the router on the table or other flat
      level surface. Connect the device to the appropriate power sourse
      (220V/50Hz or DC 36-72V).</para>

      <para>In case the router management using console interface is needed,
      for example, for router weaving renewal (see <link
      endterm="update.title" linkend="update"></link> ), or for diagnostic of
      loading process, connect the console port of the router to the serial
      port of the computer via the terminal cable.</para>

      <para>For router management via console interface any terminal program
      can be used — HyperTerminal or Putty for OS Windows and Minicom for OS
      GNU/Linux. Serial port settings are mentioned above in Section <link
      endterm="hw.desc.rs232.title" linkend="hw.desc.rs232"></link> (traffic
      rate, bit/sec: 115 200; protocol: 8-N-1; flow control: no).</para>

      <para>For router adjustement via web-interface connect its eth0
      interface to the network adapter of the computer or to the port of local
      network switchboard via conventional patch cord.</para>

      <para>Switch-on of the router is carried out with the help of the power
      switch located on the front panel.</para>
    </section>

    <section id="bootloader">
      <title>Loader</title>

      <para>Work with the loader menu is carried out using console interface
      RS-232. After switching on the power, on the screen of the terminal
      emulator program you will see a statement offering to enter the loader
      menu. To do this you should quickly (within 3 seconds) press any button
      except 'q':</para>

      <screen>
ADM5120 Boot:
CPU: Infineon 5120-175MHz
SDRAM: 64MB
Flash: NAND-32MB
Boot System: Linux-5120
Version: 2.3 (Feb  1 2011 - 17:53:29)

Press any key to enter boot menu or 'q' to boot OS immediately...
3
Checking flash......</screen>

      <para>If you pressed any button (except 'q') you will see the settings
      and the menu of the loader:</para>

      <screen>

CPU: Infineon 5120-175MHz
SDRAM: 64MB
Flash: NAND-32MB
Boot System: Linux-5120
Version 2.3 (Feb  1 2011 - 17:53:29)

Press any key to enter boot menu or 'q' to boot OS immediately...
3

ADM5120 based router: Bootloader Menu
=====================================

MAC address: 00-FF-11-22-3F-44
IP address: 192.168.2.100
TFTP Server IP address: 192.168.2.1
TFTP Server Gateway IP address: 192.168.2.1
Remote bootloader file name: sg5120boot_rom.bin
Remote Linux file name: sg.bin

[P] Set Parameters
[S] Update OS
[B] Update bootloader
[F] Flash operations
[R] Reset
Enter your option:</screen>

      <para>In the menu several actions are available:</para>

      <itemizedlist>
        <listitem>
          <para>Set Parameters - enter to the menu of setting of all
          parameters of the loader</para>
        </listitem>

        <listitem>
          <para><emphasis>Update OS</emphasis> — system update via
          TFTP-server.</para>
        </listitem>

        <listitem>
          <para><emphasis>Update Bootloader</emphasis> — loader update via
          TFTP-server (available only in expert mode).</para>
        </listitem>

        <listitem>
          <para><emphasis>Flash</emphasis> operations — Flash-memory
          management (available only in expert mode).</para>
        </listitem>

        <listitem>
          <para>Reset - processor reset and restart.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="update">
      <title id="update.title">Router firmware renewal</title>

      <important>
        <para>Save the configuration (see <link endterm="cfg.title"
        linkend="cfg"></link>) since the firmware renewal will initialize all
        the settings and reset all the MAC-addresses (see Chapter <link
        endterm="mac-address.title" linkend="mac-address"></link>) set by the
        manufacturer.</para>
      </important>

      <para>Firmware renewal is carried out via console interface RS-232. For
      the renewal you will need the following:</para>

      <itemizedlist>
        <listitem>
          <para>A computer with serial interface port RS-232 (or with USB
          cable adapter -&gt; RS232).</para>
        </listitem>

        <listitem>
          <para>TFTP-server, accessible via router.</para>
        </listitem>
      </itemizedlist>

      <para>For firmware renewal it is important to have a TFTP-server
      accessible via router where firmware image file is located.</para>

      <para>If a local TFTP-server is used, it is necessary to copy the
      firmware file, which can be downloaded from <ulink
      url="http://www.sigrand.ru">www.sigrand.ru</ulink>, to its (TFTP-server)
      root directory after adjustment. You can find the recent version of the
      firmware at: <ulink
      url="http://sigrand.ru:8280/downloads/firmware_sg17-r-cp1/">http://sigrand.ru:8280/downloads/firmware_sg17-r-cp1/</ulink>
      .</para>

      <para>The process of preparation of the router to be managed via console
      interface is described in Chapter <link endterm="firstboot.title"
      linkend="firstboot"></link>. Switch the router on after running of the
      terminal emulator program and setting parameters of the port. The
      information about the router and an offer to enter the loader menu will
      be displayed in the program window (see Chapter <link
      endterm="firstboot.title" linkend="bootloader"></link>).</para>

      <para>A configuration example is given below:</para>

      <screen>

Parameters Menu
=====================================
 [P] Pre-defined parameters menu
 [M] Local MAC address: 00-FF-0F-22-32-11
 [I] Local IP  address: 192.168.2.100
 [T] TFTP server IP address: 192.168.2.1
 [G] TFTP server gateway address: 0.0.0.0
 [B] Bootloader file name: sg5120boot_rom.bin
 [S] OS file name: sg.bin
 [E] Expert mode: Off
 [X] Save parameters and exit menu
Enter your option:</screen>

      <para>In the given example only the IP address of the router was
      changed, all other settings are left unchanged.</para>

      <para>After the adjustment of network settings, choose Update OS menu
      item for system update.</para>

      <screen>
Enter your option:s
Starting the TFTP download(ESC to stop) ..........................................................
..................................................................................................
.............................................................. PASS

Eraseing flash ...................................................................................
..................................................................................................
..................................................................................................
.............................................................. PASS
Programming flash ................................................................................
..................................................................................................
.............................................................. PASS


</screen>

      <para>PASS, corresponding with the lines "Eraseing flash" and
      "Programming flash" means that the updating was completed successfully.
      FAIL indicates that there exist some problem, usually they are:incorrect
      IP-address of the TFTP-server (the router and the TFTP-server are
      located in different networks) or incorrect file name on server. To
      start a new firmware updating process, it is necessary to reset the
      router by puching the 'R' key in top-level menu, or by switching the
      power on and off.</para>

      <para>After the router loading is completed (in case of normal loading,
      it is not necessary to enter the loader menu; you should wait until
      timer runs out operating system loading begins), you can move forward to
      the adjustment via web-interface. The access to the console is not
      needed anymore, the cable can be disconnected and relevant
      <acronym>software</acronym> closed.</para>

      <para>In case the following statement is displayed:</para>

      <screen>Starting the TFTP download(ESC to stop) ... FAIL</screen>

      <para>— it means that the loader failed to download the firmware file
      from the indicated TFTP-server. In this case check if the IP address of
      the TFTP-server and firmware file name are correct. If they are correct,
      check the settings in "Set Parameters". Another option is to chenge of
      MAC-address and checking whether the TFTP server is blocking the
      connection to the router.</para>
    </section>

    <section id="update.loader">
      <title id="update.loader.title">Expert mode</title>

      <para>In expert mode you can update the loader of the router and carry
      out some actions with the flash memory of the router.</para>

      <important>
         <para>Use expert mode only if you are aware of your actions! These
         actions may lead to disability of the router!</para>
      </important>

      <para>Actuation of expert mode is carried out in configuration menu of
      the loader. Expert password - adm5120.</para>
    </section>

    <section id="mac-address">
      <title id="mac-address.title">MAC-addresses of network
      interfaces</title>

      <para>MAC-addresses for network interfaces (Ethernet, SHDSL, E1) are
      kept in configuration file with all other settings of the router.</para>

      <para>At the moment there exist two ways of the initial allocation of
      MAC-addresses:</para>

      <itemizedlist>
        <listitem>
          <para>The <emphasis>first</emphasis> is when after the firmware
          update random MAC-addresses generation for eth* and dsl0, dsl1
          interfaces occurs. This way of MAC-addresses generation can not
          guarantee their uniquness for several routers - it means that two
          routers may generate similar MAC-addresses. To minimize the
          probability of MAC-addresses repetition, the initial loading should
          be carried out when the router is connected to the ethernet,
          preferably with intensive traffic - it will increase the randomness
          of address generation.</para>
        </listitem>

        <listitem>
          <para>Then runs the script instantiating the second way of
          MAC-addresses allocation - Затем запускается скрипт, реализующий
          второй способ присвоения MAC-адресов — receiption of MAC-addresses
          list from the special-purpose server. The script checks whether the
          given server is accessible - if yes, than it downloads the list of
          unique MAC-addresses which then allocate to network interfaces.The
          second way of MAC-addresses allocation is available to and used only
          by the manufacturer of the router. In case the MAC-addresses are
          updated successfully, the following statement is displayed:</para>

          <screen>
						Updating MAC addresses
					</screen>

          <para>If the above mentioned server is not available, relevant
          message will be displayed, and the MAC-addresses update will not be
          carried out during the further loadings.</para>

          <screen>
						MAC-address server is unreachable. You can update your MAC-address
						manually by running:
						/etc/init.d/updatekdb force
					</screen>
        </listitem>
      </itemizedlist>

      <para>Thr router is delivered from the manufacturer with allocated
      MAC-addresses, received from a special-purpose server, which guarantees
      their uniqueness for all possible interfaces of the router.</para>

      <para>Since MAC-addresses are kept in the configuration file, they will
      be lost after reflashing. To avoid this, please, save the configuration
      of the router (see Chapter <link endterm="cfg.title"
      linkend="cfg"></link>) before the reflashing, and then make a
      failback.</para>
    </section>

    <section id="device-manage">
      <title>Device Management</title>

      <para>With the manufacturer configuration and after the firmware update
      the router has an active eth0 interface with the IP-address
      192.168.2.100, net mask 255.255.255.0.</para>

      <para>To adjust the router connect the network adapter of the computer
      to the Ethernet-port eth0 via patch-cord. On the computer set an
      IP-address of the network where the router is located (192.168.2.0/24),
      for example, 192.168.2.1, with the net mask 255.255.255.0.</para>

      <section id="web">
        <title>Management via web-interface</title>

        <para>Router adjustment via web-interface is carried out using any
        web-browser supporting HTTPS protocol and JavaScript: Internet
        Explorer begining from Ver. 6, Opera, Mozilla Firefox. To forward to
        the adjustment page, type http://192.168.2.100 or
        https://192.168.2.100 in address line. After that several questions
        concerning encryption certificates, which should be answered
        positively. On default, login/password admin/1234.</para>

        <para>When entering web-interface loading of all necessary files and
        the content of configuration file is done. Rendering of all elements
        of user interface is performed on client-side (in browser) by means of
        JavaScript, which allows to speed the work of the interface as it
        shifts resource-intensive operations from the router.</para>

        <para>When saving changes, the page does not reset - only
        confuguration data is sent to the router (using AJAX technology).
        After saving the configuration parameters the relevant subsystem is
        restarted. All this performs as a background operation while the user
        may forward to the adjustment of other subsystems. In this case the
        number of active or queued tasks will be displayed in the
        web-interface (router can perform only one task at a time).</para>

        <para>When enterring the web-interface, the page with general
        information about the device will be opened first: device name,
        firmware version, device local time, and information about the mounted
        modules. This page is shown below.</para>

        <figure>
          <title>Page with general information</title>

          <graphic fileref="img/wf2-intro.png" width="6in" />
        </figure>

        <para>On the given page the status bar is highlighted which indicates
        the interaction between the web-interface and the device. It indicates
        the following parametres:</para>

        <itemizedlist>
          <listitem>
            <para><emphasis>Hostname</emphasis> — name of current
            device;</para>
          </listitem>

          <listitem>
            <para><emphasis>status</emphasis> — whether the device is online
            or offline. For example, if you switch off the power supply of the
            router , the status will change to "offline" after a while (about
            10-15 seconds). In this case it is impossible to make settings or
            poll the status of the router;</para>
          </listitem>

          <listitem>
            <para><emphasis>tasks</emphasis> — number of active or queued
            tasks;</para>

            <para><warning>
                <para>It is not allowed to switch off the router at a non-zero
                value of "tasks".</para>
              </warning></para>
          </listitem>

          <listitem>
            <para><emphasis>ajax</emphasis> — how many AJAX-requests waiting
            for answer were transmitted to the router (these requests are not
            related to changes in device configuration).</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="console">
        <title>Manageent via console interface</title>

        <para>To perform the adjustement of the router via console interface,
        it is necessary to connect to it on serial interface using a terminal
        program, or using network through Ethernet-port and SSH protocol (port
        22). There are several programs supporting SSH protocol, for example,
        Putty for OS Windows and ssh for OS GNU/Linux. Enter "root" as a
        login,and the password— 1234.</para>

        <note>
          <para>It should be noted that the changes introduced in the router
          configuration via the console interface will be substituted with the
          parameters introduced via web-interface after the restart.</para>
        </note>
      </section>

      <section>
        <title>Summary</title>

        <table frame="all">
          <title>Summary chart</title>

          <tgroup cols="3">
            <colspec colname="c1" />

            <colspec colname="c2" />

            <colspec colname="c3" />

            <thead>
              <row>
                <entry nameend="c2" namest="c1">Parameter</entry>

                <entry>Value</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry nameend="c2" namest="c1">IP-address(eth0)</entry>

                <entry>192.168.2.100</entry>
              </row>

              <row>
                <entry nameend="c2" namest="c1">Net mask</entry>

                <entry>255.255.255.0</entry>
              </row>

              <row>
                <entry nameend="c2" namest="c1">Web interface</entry>
              </row>

              <row>
                <entry></entry>

                <entry>Protocol</entry>

                <entry>HTTPS</entry>
              </row>

              <row>
                <entry></entry>

                <entry>Address</entry>

                <entry>http://192.168.2.100</entry>
              </row>

              <row>
                <entry></entry>

                <entry>Login</entry>

                <entry>admin</entry>
              </row>

              <row>
                <entry></entry>

                <entry>Password</entry>

                <entry>1234</entry>
              </row>

              <row>
                <entry nameend="c2" namest="c1">Console interface</entry>
              </row>

              <row>
                <entry></entry>

                <entry>Protocol</entry>

                <entry>SSH</entry>
              </row>

              <row>
                <entry></entry>

                <entry>Login</entry>

                <entry>root</entry>
              </row>

              <row>
                <entry></entry>

                <entry>Password</entry>

                <entry>1234</entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </section>
    </section>
  </chapter>

  <chapter id="system">
    <title>System settings and information</title>

    <section id="language">
      <title>Language of the web-interface</title>

      <para>Language settings for the web-interface is carried out on page
      System/Webface.</para>

      <figure>
        <title>Language settings for web-interface</title>

        <graphic fileref="img/wf2-language.png" width="6in" />
      </figure>
    </section>

    <section id="hostname">
      <title>Name of router</title>

      <para>Change of the router name (hostname) can be performed on the page
      System/General, which is shown below.</para>

      <figure>
        <title>Change of hostname</title>

        <graphic fileref="img/wf2-general.png" width="6in" />
      </figure>
    </section>

    <section id="passwd">
      <title>Password settings</title>

      <important>
        <para>It is strongly recommended to change the password for the access
        to the router adjustment option, it can be done on page
        System/Security.</para>
      </important>

      <para>At the same page it is recommended to change the password on
      router management via the console interface. Password change page is
      shown below.</para>

      <figure>
        <title>Change of password</title>

        <graphic fileref="img/wf2-security.png" width="6in" />
      </figure>

      <para><emphasis>Webface password</emphasis> — password for web-interface
      access (user "admin"), <emphasis>System console password</emphasis> —
      password for access to device console (user "root").</para>
    </section>

    <section id="dns">
      <title>DNS settings</title>

      <para>Setting of DNS-server address, ton which the device will refer
      with DNS-requests and the name of the domain to which the device belongs
      can be set on page System/DNS.</para>

      <figure>
        <title>DNS settings</title>

        <graphic fileref="img/wf2-dns.png" width="6in" />
      </figure>
    </section>

    <section id="time">
      <title>Time synchronization</title>

      <para>Settings for local time synchronization can be found in the tab
      System/Time. Since the device does not have a battery for the timer, the
      system time drops each time the power is switched off.</para>

      <figure>
        <title>Time synchronization</title>

        <graphic fileref="img/wf2-time.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Time</emphasis> — system time at the device;</para>
        </listitem>

        <listitem>
          <para><emphasis>Use time synchronizing</emphasis> — enable time
          synchronization;</para>
        </listitem>

        <listitem>
          <para><emphasis>Time server</emphasis> — NTP server, used time
          synchronization;</para>
        </listitem>

        <listitem>
          <para><emphasis>Time zone</emphasis> — time zone of the
          device;</para>
        </listitem>

        <listitem>
          <para><emphasis>Auto daylight-saving time</emphasis> — automatic
          adjustment for daylight saving time.</para>

          <para><note>
              <para>Since the year 2011 daylight saving time principle is not
              applied in Russia.</para>
            </note></para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="logging">
      <title>Logging</title>

      <para>Due to peculiarities of the embedded memory (flash-memory), system
      events (logs) cannot be saved locally on the router, they are written to
      a specialized buffer, browseable using special utilities (in console
      using the command "logread", on web-interface on page
      System/tools/syslog). The device has several parameters controlling the
      logging:</para>

      <figure>
        <title>Logging</title>

        <graphic fileref="img/wf2-logging.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Kernel console priority logging</emphasis> —
          priority grading of system messages at which they are displayed on
          the console.</para>
        </listitem>

        <listitem>
          <para><emphasis>Circular buffer</emphasis> — buffer size.</para>
        </listitem>

        <listitem>
          <para><emphasis>Enable remote syslog logging</emphasis> — enable
          logging to the remote syslog-server.</para>
        </listitem>

        <listitem>
          <para><emphasis>Remote syslog server</emphasis> — address of the
          remote syslog-server.</para>
        </listitem>
      </itemizedlist>

      <note>
        <para>When enabling remote server logging, local buffer event
        recording continues.</para>
      </note>

      <note>
        <para>In order the remote syslog-server accept logs from the router it
        should be started with "-r" option. Logging is performed on udp
        protocol, 514 port.</para>
      </note>
    </section>

    <section id="tools">
      <title>Utilities</title>

      <para>On page System/tools ofweb-interface various utilities are
      available which are used for the device performance analysis or
      functional check.</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>syslog</emphasis> — grant access to the logs
          obtained from "logread" utility;</para>
        </listitem>

        <listitem>
          <para><emphasis>dmesg</emphasis> — grant access to the logs obtained
          from "dmesg" utility;</para>
        </listitem>

        <listitem>
          <para><emphasis>ping</emphasis> — allows checking the availability
          of the site using icmp protocol;</para>
        </listitem>

        <listitem>
          <para><emphasis>mtr</emphasis> — allows checking the quality of
          connection between the device and the remote site.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="reboot">
      <title>Reboot</title>

      <para>Reboot can be perfored by puching the "Reboot" button on page
      System/Reboot.</para>
    </section>

    <section id="cfg">
      <title id="cfg.title">Configuration upload and failback</title>

      <para>Web-interface allows saving of the current configuration or to
      back out saved or initial configuration of the router.</para>

      <para>Configuration saving is performed on page
      System/Configuration/Backup:</para>

      <figure id="backup">
        <title>Configuration backup</title>

        <graphic fileref="img/wf2-cfg-backup.png" width="6in" />
      </figure>

      <para>When clicking the "Backup" button there will be offered to save
      the configuration file, which can be loaded in future.</para>

      <important>
        <para>After the failback the device will reboot automatically.</para>
      </important>

      <para>The failback is performed on page
      System/Configuration/Restore:</para>

      <figure id="restore">
        <title>Failback</title>

        <graphic fileref="img/wf2-cfg-restore.png" width="6in" />
      </figure>

      <para>On the tap System/Configuration/default it is possible to back out
      the initial configuration by clicking the Restore default button.</para>

      <figure id="cfg-default">
        <title>Back-out of factory default model</title>

        <graphic fileref="img/wf2-cfg-default.png" width="6in" />
      </figure>
    </section>

    <section id="upload">
      <title>File download</title>

      <para>In some cases it can be necessary to download a file in the
      device. For example, it can be a burst which needs to be installed on
      the device. For this purpose a downloader available in web-interface on
      page System/Upload file can be used.</para>

      <figure>
        <title>File download</title>

        <graphic fileref="img/wf2-upload-file.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Path</emphasis> — a directory in file system to
          which the file will be downloaded;</para>
        </listitem>

        <listitem>
          <para><emphasis>File</emphasis> — a file on a local computer which
          needs to be downloaded.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="web-console">
      <title>Console</title>

      <para>In the absence or inhibited access to the console (SSH or via a
      serial port), it is possible to use the web-interface console which is
      accessible on page System/Console.</para>

      <important>
        <para>This console hav a limited functionality! In particular, it does
        not support text pasting from the exchange buffer and launching of
        interactive programs (i.e. programs which interact with the user, for
        example, "top"). After the launching of an interactive program , for
        example "top", the console will display "executing command..." and
        stop. For the recovery it is necessary to reopen the page of the
        console by clicking on the menu or on the tap name.</para>
      </important>

      <figure>
        <title>Execution of "ip addr" command in console</title>

        <graphic fileref="img/wf2-console.png" width="6in" />
      </figure>
    </section>
  </chapter>

  <chapter id="hardware">
    <title>Equipment adjustment</title>

    <section id="modules.settings">
      <title id="modules.settings.title">Principle of module settings
      holding</title>

      <para>In previous versions of firmware interface settings were attached
      to the interface name, which caused problems when working with modules,
      as with mounting of a new module interfaces names could change and the
      settings were applied to an incorrect module.</para>

      <para>In current versions of firmwares, hardware settings are attached
      to PCI-slot, and network settings are copied in case of changes in the
      interface name. It means that if after mounting a new module the
      interface name changed from "<emphasis>dsl0</emphasis>" to
      "<emphasis>dsl1"</emphasis> , the network settings will be copied from
      the "dsl0" to the "dsl1".</para>

      <para>The main difference in holding hardware settings and network
      settings consists in fact that if you remove a module for a while and
      switch the router on, network settings will be
      <emphasis>deleted</emphasis> , and hardware settings <emphasis>will be
      preserved</emphasis> . Therefore, when you return the module to its
      place and switch the router on, the module will be configured as before,
      but without network settings.</para>

      <para>Besides, the use of settings for compatible modules is supported:
      for example, if a one-channel module was replaced by a two-channel one,
      the settings will be applied to the first channel of the new
      module.</para>

      <para>If, vice versa, a instead of a two-channel module you mount a
      one-channel module, the settings (hardware and network) will be applied
      to the new module in the folllowing way: hardware settings for the
      second channel will be preserved, while its network settings
      <emphasis>deleted</emphasis> . Therefore, if the two-channel module is
      returned to its place, it will get its hardware settings (and network
      settings for the first channel).</para>

      <para>The difference between hardware and network settings is made due
      to technical constraints.</para>
    </section>

    <section id="adm5120sw">
      <title>Built-in Ethernet-commutator settings</title>

      <para>Commutator adjustment can be done on page Hardware/Switch, where
      the binding of commutator physical ports to network interfaces is
      performed. Binding of several ports to one network interface creates a
      single physical environmebt for them, i.e. they begin functioning as
      ports of the same commutator. The adjustment window is shown in the
      picture below:Adjustment of</para>

      <figure>
        <title>Adjustment of built-in commutator</title>

        <graphic fileref="img/wf2-switch.png" width="6in" />
      </figure>

      <para>Under the default settings each physical port corresponds to a
      separate network interface. Binding of Port 0 and Port 1 to the same
      interface, eth1 for example, makes possible a second-level traffic
      exchange between these interfaces, i.e. as in a standard
      commutator.</para>

      <note>
        <para>Restart the router after implementation of alternations.</para>
      </note>
    </section>

    <section id="linkdeps">
      <title>Bonding of interfaces states</title>

      <para>To create complex interconnections between interfaces there was
      added an option of managing the states of the Ethernet or E1 port
      depending on the state of the correspondent SHDSL port.</para>

      <figure>
        <title>Bonding of interfaces states</title>

        <graphic fileref="img/wf2-linkdeps.png" width="6in" />
      </figure>

      <para>It is fixed under the given configuration that in case of link
      drop-out at dsl0 interface, the link at the interfaces eth3 and E1_0
      will be subject to a despotic shutdown.</para>

      <note>
        <para>SHDSL-interfaces may function as link-master, Ethernet and E1 -
        as link-slave.</para>
      </note>
    </section>

    <section id="dsl">
      <title>SHDSL interface modules</title>

      <section>
        <title>Interface settings</title>

        <para>For SHDSL connection one router should operate in "master", the
        other - in "slave" mode. Settings of SHDSL interface can be made on
        page Hardware/SHDSL/dsl*/Settings.</para>

        <section id="dsl.mr17h">
          <title>Settings of SHDSL modules</title>

          <note>
            <para>SHDSL driver for the router SG-17R (and modules MR-17H*) is
            called MR17H, its name is displayed in the headline of the
            configuration window.</para>
          </note>

          <important>
            <para>Read Chapter <link endterm="modules.settings.title"
            linkend="modules.settings"></link>.</para>
          </important>

          <important>
            <para>If the given network interface refers to the module pluged
            into the fourth slot (<emphasis>D slot</emphasis>), it can be used
            only for operation in <emphasis>multiplexing mode</emphasis>. This
            netork interface cannot transfer the network traffic (traffic
            transmitted not via multiplexing lines). It is associated with the
            absence of DMA support for the fourth slot.</para>
          </important>

          <para>Settings of <emphasis>rate</emphasis>, <emphasis>clock
          mode</emphasis>, <emphasis>coding</emphasis>,
          <emphasis>annex</emphasis>es and signal level reduction
          (<emphasis>PBO Forced</emphasis>) are made on the master device,
          "slave" receive these settings during connection initialization.
          Configuration window is shown below:</para>

          <figure>
            <title>SHDSL Settings (MR17H)</title>

            <graphic fileref="img/wf2-shdsl-mr17h-cfg.png" width="6in" />
          </figure>

          <itemizedlist>
            <listitem>
              <para><emphasis>Enable multiplexing</emphasis> — enable the
              multiplexing mode at the given interface. This parameter
              reproduces the relevant parameter on the multiplexing settings
              page.</para>
            </listitem>

            <listitem>
              <para><emphasis>Control type</emphasis> — interface management
              mode:</para>

              <itemizedlist>
                <listitem>
                  <para><emphasis>Manual</emphasis> — making settings on
                  interface configuration page (on the current page).</para>
                </listitem>

                <listitem>
                  <para><emphasis>EOCd</emphasis> — interface is managed by
                  the daemon EOCd. It allows monitoring of different
                  parameters of the interface and of the communication line in
                  general. Further information on settings and operation of
                  this mode is given in Chapter <link endterm="dsl-eoc.title"
                  linkend="dsl-eoc"></link>.</para>
                </listitem>
              </itemizedlist>
            </listitem>

            <listitem>
              <para><emphasis>Mode</emphasis> — mode: master, slave.</para>
            </listitem>

            <listitem>
              <para><emphasis>Coding</emphasis> — coding method. For
              information see Chapter<link
              endterm="hw.shdsl.details.tcpam.title"
              linkend="hw.shdsl.details.tcpam"></link>.</para>
            </listitem>

            <listitem>
              <para><emphasis>Rate</emphasis> — traffic rate, kbit/sec. The
              dropdown list does not include all the available bit rates - to
              set a voluntary bit rate, choose the value
              <emphasis>other</emphasis>, which will open an input box. After
              saving the input value will be rounded to the nearest correct
              value of the bit rate.</para>
            </listitem>

            <listitem>
              <para><emphasis>Annex</emphasis> — amendments selection.</para>
            </listitem>

            <listitem>
              <para><emphasis>Power</emphasis> — switch on the power supply
              for the regenerators on line.</para>
            </listitem>

            <listitem>
              <para><emphasis>Clock mode</emphasis> — synchronization mode, on
              default <emphasis>sync</emphasis> (synchronic) mode is used.
              <emphasis> </emphasis>Make sure that all the equipment of the
              communication line (regenerators, routers) are operated in this
              mode.</para>
            </listitem>

            <listitem>
              <para><emphasis>PBO Forced</emphasis> — reduction of the output
              signal to the set value (in dB). Used to reduce the impact on
              the ewuipment operating on the same cable.The given parameter
              influence on distance/rate of the connection.</para>

              <para>Signal level reduction can be carried out on all segments
              of the communication line - for this purpose the values of
              signal level reduction are input with colons. For example,
              "3:0:12" reduces the signal level in segmant STU-C — SRU1 by 3
              dB, in segment SRU1 — SRU2 the signal level remains the same, in
              segment SRU2 — STU-R — by 12 dB. If the value of reduction is
              set not for all segments, there will be no signal level
              reduction in those segments.</para>
            </listitem>

            <listitem>
              <para><emphasis>AdvLink</emphasis> — expanded mode of link
              statusing. In normal mode the link at the interface is
              considered advanced when there is a connection between the
              interface of the given device and the nearest device connected
              to it, whether it is a regenerator or the terminal device. It is
              not always correct when regenerators are operated on line,
              because the advanced state of the link at the interface should
              indicate the connection between the terminal devices, not
              between the device and a regenerator. For this purpose the
              parameter <emphasis>AdvLink</emphasis> is used — when it is
              active, a link at the interface is considered advanced only when
              there is a connection between the master device and the
              slave.</para>
            </listitem>

            <listitem>
              <para><emphasis>CRC</emphasis> — batch total computation
              algorithm.</para>
            </listitem>

            <listitem>
              <para><emphasis>Fill</emphasis> — byte selection for channel
              filling in the absence of batches to transmit.</para>
            </listitem>
          </itemizedlist>
        </section>

        <section id="dsl.status">
          <title>Connection and status of the connection</title>

          <para>When settings are saved, after a while the connection will be
          established, which will be indicated by light-emitting diodes on the
          front panel of the router. Connection status information can also be
          found in the status tab.</para>

          <para>In case the connection is not made, the following information
          will be displayed:</para>

          <figure>
            <title>Information about not-established SHDSL connection
            (MR17H)</title>

            <graphic fileref="img/wf2-shdsl-mr17h-status-offline.png"
                     width="6in" />
          </figure>

          <itemizedlist>
            <listitem>
              <para><emphasis>Link state</emphasis> — connection status:
              <emphasis>offline</emphasis> — connection is not established,
              <emphasis>online</emphasis> — connection is established.</para>
            </listitem>

            <listitem>
              <para><emphasis>Power balance</emphasis> — power supply balance
              to earth. Norm is plus120 V in one wire, and minus 120 V in the
              other. If the shift exceeds 30 V or earth is absent - it
              indicates power supply unbalance; in this case the "unbalanced"
              LED flashes on the SHDSL module. The value "<emphasis>balanced"
              </emphasis>of the parameter corresponds to normal operation,
              ,<emphasis>"unbalanced</emphasis>" — to unbalanced power
              supply.</para>
            </listitem>

            <listitem>
              <para><emphasis>Power overload</emphasis> — excess power load.
              An excess number of regenerators operating on line which are set
              for power supply from the given router lead to power overload.
              In this case "overload" LED flashes on the SHDSL module. The
              value "<emphasis>no overload</emphasis>" of the parameter
              corresponds to normal operation, "<emphasis>overload"</emphasis>
              — to power overload.</para>
            </listitem>

            <listitem>
              <para><emphasis>PBO</emphasis> — active settings for output
              signal level reduction.</para>
            </listitem>
          </itemizedlist>

          <para>When the connection is established the following information
          is added:</para>

          <figure>
            <title>Information about the established SHDSL connection
            (MR17H)</title>

            <graphic fileref="img/wf2-shdsl-mr17h-status-online.png"
                     width="6in" />
          </figure>

          <itemizedlist>
            <listitem>
              <para><emphasis>Actual rate</emphasis> — data transfer rate in
              the established connection, kbit/sec.</para>
            </listitem>

            <listitem>
              <para><emphasis>Actual line code</emphasis> — coding
              method.</para>
            </listitem>

            <listitem>
              <para><emphasis>Actual clock mode</emphasis> — synchronizing
              mode.</para>
            </listitem>

            <listitem>
              <para><emphasis>SNR margin</emphasis> — signal to noise ratio
              margin in the communication line (the more the better).</para>
            </listitem>

            <listitem>
              <para><emphasis>Loop attenuation</emphasis> — signal attenuation
              in the communication line (the less the better).</para>
            </listitem>
          </itemizedlist>
        </section>
      </section>

      <section id="dsl-eoc">
        <title id="dsl-eoc.title">Interface management via EOCd</title>

        <para>Interface adjustment for operating via EOCd means passing the
        control over the interface to a customized application which works
        with the devices on line via the service channel EOC. It allows to
        obtain information about the communication line from all segments,
        obtaining it from the regenerators and the terminal device -
        slave.</para>

        <section>
          <title>Interface adjustment for operating via EOCd</title>

          <para>To manage the interface via EOCd it is necessary to set a
          relevant value of the parameter in interface settings (parameter
          <emphasis>Control type</emphasis>).</para>

          <figure>
            <title>Interface adjustment for operating via EOCd</title>

            <graphic fileref="img/wf2-eocd-interface.png" width="6in" />
          </figure>

          <para>After selecting of EOCd mode in <emphasis>Control
          type</emphasis>, additional parameters will be displayed:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>Config profile</emphasis> — profile used for the
              given interface. Only those profiles are available for
              selection, compatibility level of which corresponds with the
              given interface.</para>
            </listitem>

            <listitem>
              <para><emphasis>Regenerators</emphasis> — the number of
              regenerators installed. This value is informative and is meant
              for help to the network administrator. Actual number of
              regenerators on line may not coincide with the indicated
              value.</para>
            </listitem>
          </itemizedlist>
        </section>

        <section>
          <title>Profile creation and editing</title>

          <para>The creation and editing of link profile is made in EOC
          Profiles tab which is shown below.</para>

          <figure>
            <title>Creation and editing of link profiles</title>

            <graphic fileref="img/wf2-eocd-profiles.png" width="6in" />
          </figure>

          <para>In EOCd the profile "default", the parameters of which cannot
          be changed, is available. The process of creation of a new profile
          or editing of the existing profile is shown below.</para>

          <figure>
            <title>Creation of a new profile or editing of the existing
            one</title>

            <graphic fileref="img/wf2-eocd-profile-add.png" width="6in" />
          </figure>

          <itemizedlist>
            <listitem>
              <para><emphasis>Name</emphasis> — profile name;</para>
            </listitem>

            <listitem>
              <para><emphasis>Compatibility</emphasis> — compatibility level
              of the profile:</para>

              <itemizedlist>
                <listitem>
                  <para><emphasis>base</emphasis> — base combatibility, for
                  modules operating at the rate of 5,7 Mbit/sec and 14
                  Mbit/sec.</para>
                </listitem>

                <listitem>
                  <para><emphasis>extended</emphasis> — extended
                  compatibility, can be used only for modules operating at the
                  rate of 14 Mbit/sec.</para>
                </listitem>
              </itemizedlist>
            </listitem>

            <listitem>
              <para><emphasis>Encoding, Rate, Annex, Power</emphasis> — the
              given parameters correspond to the parameters on the interface
              configuration page (<link linkend="dsl.mr17h">SHDSL
              settings</link>).</para>
            </listitem>
          </itemizedlist>
        </section>
      </section>

      <section id="eoc">
        <title id="eoc.title">SHDSL-channels monitoring</title>

        <note>
          <para>Monitoring option is supported only by MR-17H* modules.
          Interfaces should be managed via EOCd. Browsing of the statistics of
          the communication line is available only on master device.</para>
        </note>

        <section>
          <title>Monitoring via web-interface</title>

          <para>SHDSL-channels monitoring allows to obtain information about
          different parameters and errors of the communication lines. If
          <emphasis>SG-17E</emphasis> regenerators are used in the
          communication line, it is possible to obtain information about their
          status and number.</para>

          <para>Browsing of statistics of the channel parameters is available
          in "Statistics" tab. On page information about the connection in
          general and about the devices operating on line is available. The
          name of the parameter - <emphasis>Channel unit</emphasis>:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>General</emphasis> — general information about
              the communication line;</para>
            </listitem>

            <listitem>
              <para><emphasis>STU-C</emphasis> — master statistics;</para>
            </listitem>

            <listitem>
              <para><emphasis>STU-R</emphasis> — slave statistics;</para>
            </listitem>

            <listitem>
              <para><emphasis>SRU1 - SRU8</emphasis> — regenerator
              statistics.</para>
            </listitem>
          </itemizedlist>

          <para>When opening the page, general statistics of the connection is
          displayed:</para>

          <figure>
            <title>General statistics of the connection</title>

            <graphic fileref="img/wf2-eocd-stat-general.png" width="6in" />
          </figure>

          <itemizedlist>
            <listitem>
              <para><emphasis>Channel link</emphasis> — status of the
              connection between master device and slave, determined by the
              status of the connection between EOCd processes on the devices.
              If the connection is established but the parameter value is
              <emphasis>"offline</emphasis>", the EOCd processes failed to
              establish the connection between them. It can be associated with
              several reasons: one of the EOCd processes may not be launched,
              or a relative interface may not be managed via EOCd.</para>
            </listitem>

            <listitem>
              <para><emphasis>Regenerators</emphasis> — actual number of
              regenerators on line.</para>
            </listitem>

            <listitem>
              <para><emphasis>Wire pairs</emphasis> — number of pair in the
              channel.</para>
            </listitem>

            <listitem>
              <para><emphasis>Rate, Annex, Encoding</emphasis> — transfer
              rate, amendments, coding mode.</para>
            </listitem>
          </itemizedlist>

          <para>When statistics for a concrete device is displayed, the
          following parameters of the performance characterizing the SHDSL
          channel are available:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>Errored Second (ES)</emphasis> — number of
              second intervals when one or more CRC anomalies were detected or
              more than one LOSW bug. When working with this parameter it is
              necessary to consider the rules of parameters priority (see
              <link linkend="shdsl.rules">parameters priority</link>).</para>

              <note>
                <para><emphasis>Loss of Sync Defect (LOSW defect)</emphasis> –
                loss of synchronization. In plesiochronous mode loss of
                synchronization bug should be identified when not less than
                three successively received slides contain synchronization
                errors. These errors are indicated by a group of bits in a
                slide: Frame Sync Word, Stuff Bits and Stuff Bit Ids. LOSW
                indication clears after receiving at least two successive
                slides not containing any synchronization errors.</para>
              </note>
            </listitem>

            <listitem>
              <para><emphasis>Severely Errored Second (SES)</emphasis> —
              number of one-second intervals, in which not less than 50 CRC
              anomalies occured or more than one LOSW bug was found. (50 CRC
              anomalier per second corresponds to 30% of incorrect slides for
              standard frame length). When working with this parameter it is
              necessary to consider the rules of parameters priority.</para>
            </listitem>

            <listitem>
              <para><emphasis>Code Violation (CV)</emphasis> — number of CRC
              anomalies, found withing the monitoring period. When working
              with this parameter it is necessary to consider the rules of
              parameters priority which will be described below.</para>
            </listitem>

            <listitem>
              <para><emphasis>LOSW Second (LOSWS)</emphasis> — number of
              one-second intervals in which more than one LOSW bug was
              found.</para>
            </listitem>

            <listitem>
              <para><emphasis>Unavailable Second (UAS)</emphasis> — number of
              one-second intervals in which SHDSL-channel was not available.
              The channel after failure is considered available in 10 seconds
              without SES. These 10 seconds should be extracted from the
              number of seconds when the channel was unavailable.</para>
            </listitem>
          </itemizedlist>

          <para>Many parameters are set for different pairs and sides:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>Side</emphasis> — there are two sides, to which
              the communication settings may belong:</para>

              <itemizedlist>
                <listitem>
                  <para><emphasis>NetSide</emphasis> — master side
                  (communication line to the master).</para>
                </listitem>

                <listitem>
                  <para><emphasis>CustSide</emphasis> — customer side
                  (communication line to the slave).</para>
                </listitem>
              </itemizedlist>
            </listitem>

            <listitem>
              <para><emphasis>Pair</emphasis> — number of wire pair.</para>
            </listitem>
          </itemizedlist>

          <para>The table "<emphasis>state"</emphasis> shows the current
          parameters of the line (SNR margin and LoopAttn) and errors found
          from the begining of channel monitoring.</para>

          <figure>
            <title>Table "state"</title>

            <graphic fileref="img/wf2-eocd-stat-unit-state.png" width="6in" />
          </figure>

          <para>The table "<emphasis>relative counters"</emphasis> contains
          the same parameters that the table "<emphasis>state"</emphasis>,
          allowing to reset them in order to take samples in certain time
          intervals.</para>

          <figure>
            <title>Table "relative counters"</title>

            <graphic fileref="img/wf2-eocd-stat-unit-relative.png" width="6in" />
          </figure>

          <para>The table "<emphasis>current intervals</emphasis>" contains
          errors occured during the last 15 minutes and the previous day. The
          values, thus, are updated every 15 minutes and every day.</para>

          <figure>
            <title>Table "current intervals"</title>

            <graphic fileref="img/wf2-eocd-stat-unit-curr.png" width="6in" />
          </figure>

          <para>Besides, tables are maintained for each wire pair and for each
          side (NetSide and CustSide), where 15-minutes and day-intervals when
          errors occured are kept. Tables keep the information about the last
          96 15-minutes intervals and the last 30 day intervals.</para>

          <figure>
            <title>Table of 15-minutes intervals for CustSide</title>

            <graphic fileref="img/wf2-eocd-stat-unit-15min.png" width="6in" />
          </figure>

          <figure>
            <title>Table of day intervals for CustSide</title>

            <graphic fileref="img/wf2-eocd-stat-unit-1day.png" width="6in" />
          </figure>

          <itemizedlist>
            <listitem>
              <para><emphasis>Monitoring</emphasis> — ratio of time when the
              channel was being monitored.</para>
            </listitem>
          </itemizedlist>
        </section>

        <section>
          <title>Monitoring via console</title>

          <para>For SHDSL-channel monitoring <command>eoc-info</command>
          utility is used; for further information about the utility functions
          use the key <option>--help</option>.</para>

          <para>To get a aummary of channel status use the command
          <command>eoc-info</command> <option>-s</option>. It reflects the
          status of each channel: how many regenerators is found, is there a
          connection to slave (the router operating in <emphasis>slave
          mode</emphasis>). The "<emphasis>offline</emphasis>" status
          indicates that the connection with the second router is not
          established. In this case the number of regenerators shows the
          regenerator to which the connection is established.</para>

          <para>For the detailed information type the name of the interface:
          <command>eoc-info</command> <option>-i</option>
          <replaceable>dsl0</replaceable>. The program output will contain
          full information about all units of the track - master, slave and
          all the regenerators. To get information about a specific unit use
          an option " <option>-u"</option>and unit`s name: STU-C, STU-R,
          SRU1..SRU8.</para>
        </section>

        <section id="shdsl.rules">
          <title>Rules of SHDSL -channel performance parameters
          priority</title>

          <itemizedlist>
            <listitem>
              <para>No restrictions for <emphasis>UAS</emphasis>
              parameter.</para>
            </listitem>

            <listitem>
              <para>Parameters <emphasis>ES</emphasis> and
              <emphasis>SES</emphasis> are disabled if
              <emphasis>UAS</emphasis> indication is enabled.</para>
            </listitem>

            <listitem>
              <para><emphasis>CV</emphasis> parameter is disabled if
              <emphasis>SES</emphasis> indication is enabled.</para>
            </listitem>
          </itemizedlist>
        </section>
      </section>

      <section id="hw.shdsl.details.tcpam">
        <title id="hw.shdsl.details.tcpam.title">Specific features of TCPAM
        coding use</title>

        <para>TCPAM Coding (Trellis-Coded Pulse Amplitude Modulation) used to
        data transfer under G.SHDSL Standard (G.991.2) has several versions
        with different degrees of complexity of coding algorithm. High rate
        data transfer corresponds to the mode with high number of modulation
        positions (TCPAM32), at lower transfer rates the mode with lower
        number of modulation positions is used (TCPAM16). Consequently, with
        the increase of coding algorithm complexity the noiseproof feature of
        the channel decreases ans vice versa.</para>

        <para>Therefore it is necessary to pay special attention to the TCPAM
        coding algorithm when selecting a transfer rate, and change the linear
        code, if necessary, for the best result.</para>

        <para>For SHDSL modules of MR-17H* series there exist own acceptable
        and recommended TCPAM coding values.</para>

        <section>
            <table align="center" frame="all">
              <title>Recommended values</title>
              <tgroup cols="2">
                <thead>
                  <row>
                    <entry>Linear code</entry>
                    <entry>Bitrate range, kbit/sec</entry>
                  </row>
                </thead>
                <tbody>
                  <row>
                    <entry>TCPAM128</entry>
                    <entry>8192..14080</entry>
                  </row>
                  <row>
                    <entry>TCPAM64</entry>
                    <entry>5760..8128</entry>
                  </row>
                  <row>
                    <entry>TCPAM32</entry>
                    <entry>2560..5696</entry>
                  </row>
                  <row>
                    <entry>TCPAM16</entry>
                    <entry>192..2496</entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
        </section>
      </section>
    </section>

    <section id="e1">
      <title>Modules of E1 interface</title>

      <para>The interface adjustment is made on page Hardware/E1/E1_*.</para>

      <important>
        <para>Read Chapter <link endterm="modules.settings.title"
        linkend="modules.settings"></link>.</para>
      </important>

      <important>
        <para>If the given network interface refers to the module pluged into
        the fourth slot (<emphasis>D slot</emphasis>), it can be used only for
        operation in <emphasis>multiplexing mode</emphasis>. This netork
        interface cannot transfer the network traffic (traffic transmitted not
        via multiplexing lines). It is associated with the absence of DMA
        support for the fourth slot.</para>
      </important>

      <important>
        <para>On some versions of 8-channel modules four higher ports may also
        be used only in <emphasis>multiplexing mode</emphasis>. In this case
        in the page headline near the name of the module it will be indicated:
        <emphasis>MR17G8, multiplexing only, ...</emphasis>. It is associated
        with technical constrains of the module. Parameters related to
        transfer of IP-traffic are not available for configuration.</para>
      </important>

      <section>
        <title>Setting of interface parameters</title>

        <figure>
          <title>Setting of E1 interface parameters</title>

          <graphic fileref="img/wf2-e1-cfg.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Enable multiplexing</emphasis> — enable the
            multiplexing mode at the interface. This parameter reproduces the
            correspondent parameter on the multiplexing adjustment
            page.</para>
          </listitem>

          <listitem>
            <para><emphasis>E1 framed mode</emphasis> — enable the frame mode,
            when the channel is divided in time-slots. In this mode a map of
            time-slots is set which should coincide with the map on the other
            end of the connection. The time-slots which are set here are used
            for IP-traffic transfer and should not coincide with the
            time-slots used for multiplexing.</para>

            <note>
              <para>The capacity of one time-slot is 64 Kbit/sec.</para>
            </note>

            <para>In this mode there are additional parameters:</para>

            <itemizedlist>
              <listitem>
                <para><emphasis>Use time slot 16</emphasis> — at E1 interface
                slots 0 and 16 are reserved on default, they can be used for
                control footing. Activation of this parameter allows to use
                the time-slot number 16 for data transfer (in multiplexing or
                IP mode).</para>
              </listitem>

              <listitem>
                <para><emphasis>E1 CRC4 multiframe</emphasis> — enable the
                CRC4 mode.</para>
              </listitem>

              <listitem>
                <para><emphasis>Slotmap</emphasis> — time-slots map.
                Time-slots can be separated by commas or in ranges using a
                hyphen. The map should be updated by a driver after saving, in
                this case the background will change and near to the word
                "Slotamp" a word "<emphasis>updated</emphasis>" will be
                displayed.</para>

                <figure>
                  <title>Slotmap update</title>

                  <graphic fileref="img/wf2-e1-slotmap-updated.png"
                           width="6in" />
                </figure>
              </listitem>
            </itemizedlist>
          </listitem>

          <listitem>
            <para><emphasis>E1 CAS multiframe</emphasis> (not available when
            <emphasis>Use time slot 16</emphasis> is on) — enable CAS mode,
            usually used with PBX equipment. In this mode slot number 16 is
            reserved for service use.</para>
          </listitem>

          <listitem>
            <para><emphasis>E1 long haul mode</emphasis> — when activating
            long haul mode, the distance from the router to the DTE equipment
            connected to it can reach 1 600 meters with 0,4mm cable and 2 400
            meters with 0,5 mm cable. When the mode is not active, the
            distance is limited by 400 meters.</para>
          </listitem>

          <listitem>
            <para><emphasis>E1 HDB3/AMI line code</emphasis> — communication
            line signal coding mode.</para>

            <important>
              <para>Recommendation ITU-T G.703 requires the use of HDB3 linear
              code!</para>
            </important>
          </listitem>

          <listitem>
            <para><emphasis>Local Loopback, Remote Loopback</emphasis> — used
            for connection diagnostics, see the next Chapter.</para>
          </listitem>

          <listitem>
            <para><emphasis>HDLC protocol</emphasis> — protocol used for
            IP-traffec transfer. There can be additional parameters for some
            protocols:</para>

            <itemizedlist>
              <listitem>
                <para><emphasis>HDLC, ETHER-HDLC</emphasis>:</para>

                <itemizedlist>
                  <listitem>
                    <para><emphasis>Parity</emphasis> — алгоритм контроля
                    паритета.</para>
                  </listitem>

                  <listitem>
                    <para><emphasis>Encoding</emphasis> — coding
                    algorithm.</para>
                  </listitem>
                </itemizedlist>
              </listitem>

              <listitem>
                <para><emphasis>CISCO-HDLC</emphasis>:</para>

                <itemizedlist>
                  <listitem>
                    <para><emphasis>Timeout</emphasis> — time in seconds after
                    the last received connection maintenance packets upon the
                    expiry of which the connection is cinsidered
                    brocken.</para>
                  </listitem>

                  <listitem>
                    <para><emphasis>Interval</emphasis> — time in seconds
                    between keepalive packets.</para>
                  </listitem>
                </itemizedlist>
              </listitem>
            </itemizedlist>
          </listitem>

          <listitem>
            <para><emphasis>E1 external transmit clock</emphasis> — use the
            outer source of triggering. On default the internal source is
            used.</para>

            <note>
              <para>If for the given interface multiplexing is on (MXEN=1),
              parameters from the table of multiplexing should be used (CLKM,
              CLKR). If multiplexing mode is off, the given parameter is
              used.</para>
            </note>
          </listitem>

          <listitem>
            <para><emphasis>CRC</emphasis> — значение контрольной суммы
            пакета.</para>
          </listitem>

          <listitem>
            <para><emphasis>Fill</emphasis> — selection of a byte for channel
            filling at the absence of packets for transfer.</para>
          </listitem>

          <listitem>
            <para><emphasis>Inversion</emphasis> — batch total value.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="e1-loopback">
        <title>E1 connection diagnosting</title>

        <para>For connection diagnosting "loop" can be used, i.e. to return
        the traffic instead of transferring it, simulating the traffic
        addressee response.</para>

        <para>It is possible to create two types of loops - local and remote.
        In case of local loop, E1 module transfer data to physical line and
        immediately returns it to the sender, as shown in the figure
        below.</para>

        <figure>
          <title>E1: local loop</title>

          <graphic fileref="img/E1-local_loopback.png" width="6in" />
        </figure>

        <para>To activate this type of loop select the parameter "Local
        Loopback" on the E1 nterface adjustment page of the router, on which
        you want to create the loop (in our figure - on router R1).</para>

        <para>In case the second type of loop is used - remote loop - data is
        transferred to a physical line, it reaches the remote router which
        transfers it further and returns it to the sender.</para>

        <figure>
          <title>E1: remote loop</title>

          <graphic fileref="img/E1-remote_loopback.png" width="6in" />
        </figure>

        <para>To activate this type of loop select the parameter
        "RemoteLoopback" on the E1 nterface adjustment page of the router, on
        which you want to create the loop (in our figure - on router
        R2).</para>

        <para>Thus, when two loop types are used, the data is still be
        transferred to the physical line and, at the same time, returns back,
        which allows configuration correctness control independent from the
        status of the communication line.</para>
      </section>
    </section>

    <section id="rs232">
      <title>RS232 interface modules</title>

      <section id="rs232-config">
        <title>Setting of interface parameters</title>

        <para>Setting of RS232 interface parameters is made on page
        Hardware/RS232/ttyRS*.</para>

        <figure>
          <title>Settings o RS232 interface parameters</title>

          <graphic fileref="img/wf2-rs232.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Enable multiplexing</emphasis> — enable the
            multiplexing mode at the interface. This parameter reproduces the
            correspondent parameter on the multiplexing adjustment
            page.</para>
          </listitem>

          <listitem>
            <para><emphasis>Baud rate</emphasis> — bit rate of the
            port.</para>
          </listitem>

          <listitem>
            <para><emphasis>Character size</emphasis> — number of bits to
            transfer.</para>
          </listitem>

          <listitem>
            <para><emphasis>Stop bits</emphasis> — number of stop bits.</para>
          </listitem>

          <listitem>
            <para><emphasis>Parity</emphasis> — parity control.</para>
          </listitem>

          <listitem>
            <para><emphasis>Hardware Flow control</emphasis> — hardware
            control of the data flow.</para>
          </listitem>

          <listitem>
            <para><emphasis>Forward modem signals</emphasis> — transfer of
            control signals of the serial port, usually used when operating a
            modem.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="rs232ip">
        <title>RS-232 over TCP/IP</title>

        <para>Description</para>

        <para>This option allows to connect two routers with RS-232 ports (DTE
        andDCE) through IP networks, transferring data and control/modem lines
        statuses in both directions.</para>

        <para><figure>
            <title>Scheme of the RS-232 extention cord via IP networks</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="img/rs232_ip.png" />
              </imageobject>
            </mediaobject>
          </figure></para>

        <para>Transmitting direction of control/modem lines:</para>

        <screen>
Direct connecting cable:

    DTE    DCE
    ---    ---
    DTR -&gt; DTR
    DSR &lt;- DSR
    RTS -&gt; RTS
    CTS &lt;- CTS
    CD  &lt;- CD
    RI  &lt;- RI

null-modem:

    DTE    DTE
    ---    ---
    DTR -&gt; DSR,CD
 CD,DSR &lt;- DTR
    RTS -&gt; CTS
    CTS &lt;- RTS</screen>

        <para>Design and principles of operation</para>

        <para>For each configured RS-232 port on both routers a separate
        version of rs232-tcpext daemon is launched - at the side of the router
        waiting for connection in passive mode, and at the side of the router
        initiating the connection, in active mode.</para>

        <para>TwoTCP/IP connections are established: one for data transfer,
        the other - for control/modem lines statuses transfer. Control/modem
        lines status is requested in set periods, usually 1000 msec.</para>

        <para>Architecture with separate daemons for each port provides the
        non-involvement of other ports in data flows while one port is being
        configured/restarted.</para>

        <para>Setting instructions</para>

        <itemizedlist>
          <listitem>
            <para>Browse two tabs to management pages of both routers</para>
          </listitem>

          <listitem>
            <para>In tabs Hardware/ttyRS* set the parameters of the chosen
            ports and click "save".</para>
          </listitem>

          <figure>
            <title>Settings of RS232 port parameters</title>

            <graphic fileref="img/wf2-rs232.png" width="6in" />
          </figure>

          <listitem>
            <para>For each port deside which of the routers will be passive
            and which active side. Passive side waits for connection at a
            chosen network address from the active side.</para>
          </listitem>

          <listitem>
            <para>In tabs Services / RS-232 over TCP/IP / ttyRS* of both
            routers adjust the connecting sides.</para>

            <figure>
              <title>Setting of RS-232 over TCP/IP</title>

              <graphic fileref="img/rs232ip_options.png" width="6in" />
            </figure>

            <para>Selector "mode" defines the mode:</para>

            <itemizedlist>
              <listitem>
                <para>"Disable" - service is disabled,</para>
              </listitem>

              <listitem>
                <para>"Listen On" - wait for connection at the set "host",
                "port" (passive mode)</para>
              </listitem>

              <listitem>
                <para>"Connect To" - connect to the set "host", "port" (active
                mode)</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>

        <para>Boxes "host" and "port" define the network address and the port
        on which the passive side in waiting for the connection from the
        active side (see bind(2)) or to which the active side connects. Value
        on default - 0.0.0.0 - accept connections from all of the network
        interfaces.localhost (127.0.0.1) cannot accept connections from other
        nodes of the network.</para>

        <para>Box "ToS" defines bits ToS for IP packets which will be
        transferred by the daemon rs232-tcpext.</para>

        <para>Box "Modem lines polling interval (msec)" defines the time
        intervals between the requests for modem lines status, on default 1000
        msec.</para>

        <para>Box "Restart delay (msec)" defines the delay before the restart
        in case of any error, on default 1000 msec.</para>

        <para>Click "save".</para>

        <para>Make sure that the process is active on both routers: in tab
        System/Console enter the command "ps ax" and check that the
        rs232-tcpext process is launched:</para>

        <screen>
ps ax
...
 728 ? S 0:00 rs232-tcpext /dev/ttyRS0 0.0.0.0 3000 listen /var/run/rs232-tcpext.ttyRS0.pid 100 1000

3571 ? S 0:00 rs232-tcpext /dev/ttyRS0 192.168.2.101 3000 connect /var/run/rs232-tcpext.ttyRS0.pid 100 1000</screen>

        <para><note>
            <para>Take into account that the launching process over web system
            is rather slow.</para>
          </note></para>

        <para>In tabs System/Tools/Syslog you may see the daemon
        messages:</para>

        <para>Passive side:</para>

        <screen>
daemon.warn rs232-tcpext ttyRS0  listen : started up
daemon.info rs232-tcpext ttyRS0  listen : pid file '/var/run/rs232-tcpext.ttyRS0.pid' created
daemon.info rs232-tcpext ttyRS0  listen : Waiting data connection...</screen>

        <para>After connection to the active side:</para>

        <screen>
daemon.info rs232-tcpext ttyRS0  listen : Data connection from 192.168.3.102:2937
daemon.info rs232-tcpext ttyRS0  listen : Waiting state connection...
daemon.info rs232-tcpext ttyRS0  listen : State connection from 192.168.3.102:2938
daemon.info rs232-tcpext ttyRS0  listen : Recv modem state: 0x03, DTR:1 DSR:1 RTS:0 CTS:0 CD:0 RI:0
daemon.info rs232-tcpext ttyRS0  listen : Send modem state: 0x03, DTR:1 DSR:1 RTS:0 CTS:0 CD:0 RI:0
daemon.info rs232-tcpext ttyRS0  listen : Recv modem state: 0x03, DTR:1 DSR:1 RTS:0 CTS:0 CD:0 RI:0</screen>

        <para>Active side:</para>

        <screen>
daemon.warn rs232-tcpext ttyRS0  connect: started up
daemon.info rs232-tcpext ttyRS0  connect: pid file '/var/run/rs232-tcpext.ttyRS0.pid' created
daemon.info rs232-tcpext ttyRS0  connect: Connecting (data) to 192.168.2.101:3000 ...
daemon.err rs232-tcpext ttyRS0  connect: socket_connect(): Could not connect to 192.168.2.101:3000
daemon.warn rs232-tcpext ttyRS0  connect: restart
daemon.info rs232-tcpext ttyRS0  connect: Connecting (data) to 192.168.2.101:3000 ...
daemon.info rs232-tcpext ttyRS0  connect: Connecting (state) to 192.168.2.101:3000 ...
daemon.info rs232-tcpext ttyRS0  connect: Send modem state: 0x03, DTR:1 DSR:1 RTS:0 CTS:0 CD:0 RI:0
daemon.info rs232-tcpext ttyRS0  connect: Recv modem state: 0x03, DTR:1 DSR:1 RTS:0 CTS:0 CD:0 RI:0
daemon.info rs232-tcpext ttyRS0  connect: Send modem state: 0x03, DTR:1 DSR:1 RTS:0 CTS:0 CD:0 RI:0</screen>

        <para>Simple check of the RS-232 extention cord performance.</para>

        <para>Connect the chosen RS-232 interfaces of the routers to the PC
        ports as shown below:</para>

        <para><figure>
            <title>Scheme for RS-232 extention cord check over IP</title>

            <mediaobject>
              <imageobject>
                <imagedata fileref="img/rs232_ip_test.png" />
              </imageobject>
            </mediaobject>
          </figure><note>
            <para>The given scheme can be configured on one PC if there are
            COM1, COM2 and two Ethernet ports.</para>
          </note>Adjust the RS-232 Interfaces PC (rate, 8n1, ...) in the same
        way as the router interfaces connected to them.</para>

        <para>Launch terminal programs at the corresponding interfaces on both
        PCs and type something.</para>

        <para>This scheme cannot be used to check the transfer of control
        signals/modem lines.</para>
      </section>

      <section id="rs232-terminal">
        <title>Terminal server</title>

        <para>There exist many devices which can be adjusted and managed via
        the serial interface RS232. For remote management of such devices the
        terminal server of the router can be used.</para>

        <figure>
          <title>Terminal server adjustement</title>

          <graphic fileref="img/rs232-terminal-options.png" width="6in" />
        </figure>

        <para>In the tab "Options" you can activate/diasctivate this function
        for a specific port.</para>

        <important>
          <para>Before activating this function for a port, make sure that
          other options (multiplexing, RS232-over-IP, Dial-in) are not
          active.</para>
        </important>

        <para>For the convenience each port can be given a name which will be
        indicated in the tab of the port.</para>

        <para>"Buffer size" defines the size of the buffer for keeping the
        data from the port.</para>

        <figure>
          <title>Terminal server console</title>

          <graphic fileref="img/rs232-terminal-console.png" width="6in" />
        </figure>

        <para>Management of the remote device is carries out via
        web-interface.</para>
      </section>

      <section id="dial-in">
        <title>Dial-in server</title>

        <para>Dial-in server allows to organize a spare or controlling data
        channel via wireless or switched connections. For this purpose
        different GSM and wired modems with RS232 interface can be used.</para>

        <figure>
          <title>Tab General</title>

          <graphic fileref="img/dial-in-general.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Enable terminal access</emphasis> — enable access
            to the router console.</para>
          </listitem>

          <listitem>
            <para><emphasis>Authentification type</emphasis> — PAP or
            CHAP.</para>
          </listitem>
        </itemizedlist>

        <figure>
          <title>Tab Users</title>

          <graphic fileref="img/dial-in-users.png" width="6in" />
        </figure>

        <para>In the tab "users" user and users password management is
        performed.</para>

        <figure>
          <title>Tab Ports</title>

          <graphic fileref="img/dial-in-ports.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Enable</emphasis> — accept connections to the
            port.</para>
          </listitem>

          <listitem>
            <para><emphasis>Speed</emphasis> — speed of connection.</para>
          </listitem>

          <listitem>
            <para><emphasis>Rings</emphasis> — number of rings after which the
            connection will be accepted.</para>
          </listitem>

          <listitem>
            <para><emphasis>Init-chat</emphasis> — modem initialization
            chart.</para>
          </listitem>

          <listitem>
            <para><emphasis>Server IP</emphasis> — IP address of the PPP
            connection, router side.</para>
          </listitem>

          <listitem>
            <para><emphasis>Client IP</emphasis> — IP address of the PPP
            connection, remote device side.</para>
          </listitem>
        </itemizedlist>
      </section>
    </section>

    <section id="multiplexing">
      <title>Multiplexing</title>

      <para>Multiplexing is used for traffic transfer from one interface to
      another, by-passing the central processor. <emphasis>SG-17R</emphasis>
      allows simultaneous multiplexing and IP-traffic transferring.</para>

      <para>Generally in can be represented as follows:</para>

      <figure>
        <title>Network scheme</title>

        <graphic fileref="img/multiplexing1.png" width="6in" />
      </figure>

      <para>In the given example two E1 channels are connected to the SG-17R
      routers and there is also a TCP/IP network via Ethernet. The routers are
      interconnected over SHDSL. Maximum rate of SHDSL - 14080 kbit/sec, i.e.
      two E1 channels (2048 kbit/sec each) can be transferred via one SHDSL
      channel, 9984 kbit/sec remaining not used.</para>

      <para>To transfer E1 flows, multiplexing is used: both E1 input flows
      are multiplexed into the SHDSL channel, by which they are transferred to
      the second router, where athey are de-multiplexed and the flows split to
      clients. The remaining SHDSL lane is used for the transfer of the
      IP-traffic between the two Ethernet networks.</para>

      <para>For purposes of multiplexing, the router has a strip which
      consists of 16 lines, each of which contains 256 time-slots. Each
      time-slot of the line corresponds to a time-slot in E1 or SHDSL, i.e.
      has a rate of 64 kbit/sec. E1 contains32 time-slots, SHDSL — depending
      on the interface speed. Interfaces E1 (E1) and SHDSL (dsl) may place data
      received from the physical line to the strip, and accept the data placed
      by another interface.</para>

      <para><note>
          <para>Some modules may use only 8 lines.</para>
        </note></para>

      <figure>
        <title>Architecture of multiplexing</title>

        <graphic fileref="img/multiplexing-line.png" width="6in" />
      </figure>

      <para>All the devices participating in traffic multiplexing should be
      triggered by one signal. For this purpose it is necessary to define
      which interface will determine the clock signal while multiplexing
      adjustment.</para>

      <para>Router may have two sources defining the synchro-signal for
      multiplexing each of which defines a <emphasis>domain</emphasis>. Each
      line refers either to the domain A or to the domain B, and all the
      interfaces associated with this line also refer to one of the domains
      accordingly. Defining synchro-signal can be local or remote.</para>

      <important>
        <para>One domain can have one and only one device (interface)
        controlling the clock signal! All other devices of the domain should
        be set in <emphasis>clock slave</emphasis> mode. Thus one device
        trigger all the devices of the given domain.</para>
      </important>

      <para>Below is a multiplexing confuguration page which is located at
      address Hardware/Multiplexing.</para>

      <figure>
        <title>Multiplexing adjustment</title>

        <graphic fileref="img/wf2-mux-cfg.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>MXEN</emphasis> — interface participates in
          multiplexing.</para>
        </listitem>

        <listitem>
          <para><emphasis>CLKM</emphasis> — synchronization of the
          interface:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>clock-master</emphasis> — interface is the
              source of synchronization for the given domain.</para>
            </listitem>

            <listitem>
              <para><emphasis>clock-slave</emphasis> — interface functions as
              a receiver of synchronization.</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para><emphasis>CLKAB</emphasis> — defines to which synchronizing
          domain the interface is related.</para>
        </listitem>

        <listitem>
          <para><emphasis>CLKR</emphasis> — source of synchronization:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>local</emphasis> — use local clock for
              timing.</para>
            </listitem>

            <listitem>
              <para><emphasis>remote</emphasis> — use external clock for
              timing.</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para><emphasis>RLINE</emphasis> — number of line to which the
          interface will place the data received from the physical
          line.</para>
        </listitem>

        <listitem>
          <para><emphasis>TLINE</emphasis> — number of line, from which the
          givn interface will take the data (placed by another interface
          participating in multiplexing) to transfer it to the physical
          line.</para>
        </listitem>

        <listitem>
          <para><emphasis>RFS</emphasis> — number of the line time-slot
          starting from which the interface place the data on the line.</para>
        </listitem>

        <listitem>
          <para><emphasis>TFS</emphasis> — number of the line time-slot
          starting from which the data can be taken from the line.</para>
        </listitem>

        <listitem>
          <para><emphasis>MXRATE</emphasis>  — number of time-slots for
          multiplexing (for SHDSL interfaces).</para>
        </listitem>

        <listitem>
          <para><emphasis>MXSMAP</emphasis> — map of time-slots used for
          multiplexing (for E1 interfaces). This map should not be mixed with
          the map which is set while adjusting the E1 interface for IP-traffic
          transfer. The map should be set as "1-16", "16-31", ... type</para>
        </listitem>
      </itemizedlist>

      <important>
        <para>Time-slot in E1 can be used <emphasis>only</emphasis> for
        multiplexing or only for IP-traffic transfer. For this reason the
        time-slots map set for multiplexing using the parameter
        <parameter>mxsmap</parameter> should not coinside with the time-slots
        map set while E1 adjustment for use in IP-traffic transfer.</para>
      </important>

      <para>If while adjustment any mistakes were made, test information will
      be displayed:</para>

      <screen>
                Checking status:
                Errors detected:

                WARNING: Line2: timeslots 45 written but not read
                WARNING: Line3: timeslots 55 read but not written
            </screen>
    </section>
  </chapter>

  <chapter id="iface">
    <title>Network interfaces adjustment</title>

    <section>
      <para>Network interfaces of web-interface are devided into two types:
      static and dynamic. To the group of static interfaces belong those which
      cannot be created or deleted, i.e. these are physical interfaces
      referred to certain hardware. To the dynamic interfaces belong those of
      bonding, bridging, VLAN, as these interfaces can be created and deleted,
      they are not physical, but use other interfaces for functioning.</para>

      <title>Common parameters</title>

      <para>This chapter considers common settings for all types of network
      interfaces.</para>

      <tip>
        <para>At some interfaces there can be displayed the following
        statement on the top of the page: <emphasis>This network interface is
        used for accessing the web interface</emphasis>. This statement means
        that the access to the web-interface is performed via network
        interface, a page of which is open, and that the user should be
        careful while configuring in order not to lose control over the
        device.</para>

        <figure>
          <title>Information message</title>

          <graphic fileref="img/wf2-iface-info-message.png" width="6in" />
        </figure>
      </tip>

      <section id="status">
        <title>Status tab</title>

        <para>In the tab <emphasis>Status</emphasis> the basic information
        about the selected interface is given, and there is the option of
        shutdown/launching/restart of the interface.</para>

        <para>Interface management:</para>

        <figure>
          <title>Interface management</title>

          <graphic fileref="img/wf2-iface-stat-buttons.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para>The button <emphasis>Start</emphasis> allows to launch
            ("advance") the interface, if the tab General is marked with
            "<emphasis>enabled" flag</emphasis>.</para>
          </listitem>

          <listitem>
            <para>The button <emphasis>Stop</emphasis> stops ("leave out") the
            work of the interface.</para>
          </listitem>

          <listitem>
            <para>The button <emphasis>Restart</emphasis> stops and then
            launch the interface.</para>
          </listitem>
        </itemizedlist>

        <para>Interface network settings information:</para>

        <figure>
          <title>Network settings</title>

          <graphic fileref="img/wf2-iface-stat.png" width="6in" />
        </figure>

        <para>Interface status (on/off) can be defined with the help of the
        flag row. If it contains the word <emphasis>UP</emphasis>, the
        interface is on (for example, <emphasis>UP BROADCAST
        MULTICAST</emphasis>).</para>

        <para>Paths allocated to the interface:</para>

        <figure>
          <title>Network paths</title>

          <graphic fileref="img/wf2-iface-stat-routes.png" width="6in" />
        </figure>

        <para>Data in ARP Table:</para>

        <figure>
          <title>ARP Table</title>

          <graphic fileref="img/wf2-iface-stat-arp.png" width="6in" />
        </figure>

        <para>For Ethernet interfaces information about theinner switch
        performance:</para>

        <figure>
          <title>Inner switch</title>

          <graphic fileref="img/wf2-iface-stat-switch.png" width="6in" />
        </figure>
      </section>

      <section id="general">
        <title>General tab</title>

        <para>In the tab <emphasis>General</emphasis> you can activate a
        network interface, choose the way of IP-address setting, and, if
        necessary, set the IP-address.</para>

        <figure>
          <title>Tab General</title>

          <graphic fileref="img/wf2-iface-general.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Description</emphasis> — the description of the
            interface; used as a commentary to the interface..</para>
          </listitem>

          <listitem>
            <para><emphasis>Enabled</emphasis> — the interface is active. It
            enables launching of the interface via another interface (bonding
            or bridging interface), but the interface will not be loaded while
            launching (for automatic launching of the interface select Auto).
            Particularly, the interface can be launched by clicking on
            <emphasis>Start interface</emphasis> in the tab
            <emphasis>Status</emphasis>.</para>
          </listitem>

          <listitem>
            <para><emphasis>Auto</emphasis> — automatic launching of the
            interface. The interface will be launched while device loading or
            while saving the interface settings.</para>
          </listitem>

          <listitem>
            <para><emphasis>Depends on</emphasis> — interface on which the
            given interface depends. When launching, the independable
            interface will be launched first.</para>

            <note>
              <para>For VLAN interface this parameter is unavailable - for
              this interface its physical interface is always used.</para>
            </note>
          </listitem>

          <listitem>
            <para><emphasis>Method</emphasis> — IP-address allocation
            method.</para>

            <note>
              <para>For <emphasis>E1</emphasis> interface, when protocols
              other than <emphasis>ETHER-HDLC</emphasis> are used, there are
              only two available methods: none and Static address.</para>
            </note>

            <itemizedlist>
              <listitem>
                <para><emphasis>None</emphasis> — IP-address is not
                allocated.</para>
              </listitem>

              <listitem>
                <para><emphasis>Static address</emphasis> — static, manual
                input.</para>

                <figure>
                  <title>Static method of IP-address allocation</title>

                  <graphic fileref="img/wf2-iface-general-method-static.png"
                           width="6in" />
                </figure>

                <itemizedlist>
                  <listitem>
                    <para><emphasis>Static address</emphasis> — the required
                    IP-address in the following format xxx.xxx.xxx.xxx (for
                    example, 192.168.2.100);</para>
                  </listitem>

                  <listitem>
                    <para><emphasis>Netmask</emphasis> — network mask in the
                    following format xxx.xxx.xxx.xxx (for example
                    255.255.255.0);</para>
                  </listitem>

                  <listitem>
                    <para><emphasis>Broadcast</emphasis> — optional broadcast
                    address of xxx.xxx.xxx.xxx format (192.168.2.255). If not
                    specified, settled automatically while interface launching
                    (browseable in the tab Status in the output of interface
                    status);</para>
                  </listitem>

                  <listitem>
                    <para><emphasis>Gateway</emphasis> — path on
                    default;</para>
                  </listitem>
                </itemizedlist>

                <note>
                  <para>For <emphasis>E1</emphasis> interface using protocols
                  other than <emphasis>ETHER-HDLC</emphasis>, address is
                  allocated in Point-to-Point format, i.e. IP-addresses of the
                  local and the remote side are set.</para>

                  <figure>
                    <title>Point-to-Point IP-address</title>

                    <graphic fileref="img/wf2-iface-general-method-static-ptp.png"
                             width="6in" />
                  </figure>

                  <itemizedlist>
                    <listitem>
                      <para><emphasis>Point to Point local</emphasis> —local
                      IP-address (for the current device);</para>
                    </listitem>

                    <listitem>
                      <para><emphasis>Point to Point remote</emphasis> —
                      remote IP-address (address of the device at the other
                      end of E1 connection).</para>
                    </listitem>
                  </itemizedlist>
                </note>
              </listitem>

              <listitem>
                <para><emphasis>Zero configuration</emphasis> — automatic way
                of ip-address allocation allowing configure a working network
                without manual allocation of IP-addresses and without DHCP
                servers. In this case the IP-address of the server will be
                chosen from the following diapason range: 169.254.*.</para>
              </listitem>

              <listitem>
                <para><emphasis>Dynamic address</emphasis> — dynamic
                IP-address — allocated by DHCP server.</para>
              </listitem>
            </itemizedlist>
          </listitem>
        </itemizedlist>
      </section>

      <section id="specific">
        <title>Tab Specific</title>

        <para>This tab contains parameters specific for the given interface.
        For example, for the Ethernet-compatible interfaces (Ethernet, SHDSL,
        E1 in ETHER-HDLC mode etc.) here you can allocate a MAC-address. For
        bridging here there are settings specific for it.</para>

        <figure>
          <title>Tab Specific</title>

          <graphic fileref="img/wf2-iface-specific.png" width="6in" />
        </figure>
      </section>
    </section>

    <section id="ifaces">
      <title>Dynamic interfaces</title>

      <section>
        <title>Work with dynamic interfaces</title>

        <para>Dynamic interfaces managenets is carried out on page
        Network/Dynamic interfaces/Manage.</para>

        <figure>
          <title>Dynamic interfaces</title>

          <graphic fileref="img/wf2-iface-dynamic.png" width="6in" />
        </figure>

        <para>there exist the following types of the dynamic
        interfaces:</para>

        <itemizedlist>
          <listitem>
            <para><emphasis>Bridge</emphasis> — traffic transfer between
            interfaces at the second level;</para>
          </listitem>

          <listitem>
            <para><emphasis>Bonding</emphasis> — increase of the connection
            capacity and reliability by means of using several
            interfaces;</para>
          </listitem>

          <listitem>
            <para><emphasis>VLAN</emphasis> — interface of virtual networks:
            traffic isolation within the communication environment.</para>
          </listitem>
        </itemizedlist>

        <para>To create a new dynamic interface select its type and click
        <emphasis>Add</emphasis>. The added dynamic interface will be
        displayed in the list of network interfaces:</para>

        <figure>
          <title>Dynamic interface in the list of the network
          interfaces</title>

          <graphic fileref="img/wf2-ifaces-dynamic-added.png" width="2in" />
        </figure>

        <para id="ifaces.del">To delete the dynamic interface select its name
        in the list of interfaces and click
        <emphasis>Delete</emphasis>.</para>
      </section>

      <section id="bonding">
        <title>Settings of bonding</title>

        <para>Bonding allows to band several physical connections into the
        logical one (by creating a dynamic interface -
        <emphasis>bond</emphasis>). For example, two SHDSL-channels can be
        banded into one, expanding the capacity and reliability of the
        connection.</para>

        <important>
          <para>In Bonding mode only ethernet-compatible interfaces can be
          banded. The Ethernet-compatible interfaces in the device are:
          Ethernet,SHDSL, E1 in ETHER-HDLC mode, and the interfaces of
          bonding, bridging, VLAN.</para>
        </important>

        <para>The dynamic interface of the bonding is created on page
        Network/Dynamic interfaces/Manage, where <emphasis>the section Add
        dynamic network interface</emphasis> the user should select "Bonding"
        and click <emphasis>Add</emphasis>.</para>

        <para>After the interface is added, its name will be displayed in the
        menu Network/Dynamic interfaces/bond* (see the figure in the previous
        chapter). Besides, a window of the interface quick settings will be
        opened, where the user should set all the parameters necessary for
        interface launching:</para>

        <figure>
          <title>Bonding quick settings window</title>

          <graphic fileref="img/wf2-iface-bonding-wizard.png" width="6in" />
        </figure>

        <para>In this window all the parameters, except one, were described in
        the previous chapter. The new parameter - <emphasis>Bonding
        interfaces</emphasis> - contains the interfaces enumerated with
        spacing which form the bonding.</para>

        <important>
          <para>Physical interface can be added only to
          <emphasis>one</emphasis> interface of the bonding! For example, the
          interfaces bond0 (eth0, dsl0) and bond1 (eth1, dsl0) cannot be
          created because the dsl0 can be added only to one interface of the
          bonding. To break this limit use VLAN technology (see the relevant
          chapter with examples of use).</para>
        </important>

        <para>After the settings are saved, the interfaces, forming a bonding,
        will be adjusted automatically: for them <emphasis>enabled=1
        auto=0</emphasis> is set. The IP-addresses of the existing interfaces,
        if they were set, will be reseted. One MAC-address corresponding to
        the MAC-address of one of the physical interfaces will be allocated to
        all the interfaces (dynamic and physical within it).</para>

        <para>The settings can be altered on the interface adjustment page, in
        the tab General.</para>

        <note>
          <para>The same settings should be made on the second router.</para>
        </note>

        <note>
          <para>When one of the physical connections is broken, traffic will
          be transferred via the remained connection.</para>
        </note>

        <note>
          <para>If you adjust several bondings, restart the device after
          setting. It is related to the fact that after the launching of the
          first bonding-interface, launching of new bonding-interfaces will be
          possible only after the restart.</para>
        </note>
      </section>

      <section id="bridge">
        <title>Bridging settings</title>

        <para>The operation of the device in bridging mode allows to transfer
        traffic between the interfaces transparently, simulating the function
        of a switch. For this purpose a special network dynamic interface with
        the name "<emphasis>br"</emphasis> is created, with which the network
        interfaces meant for traffic exchange are associated.</para>

        <important>
          <para>In Bridge mode only ethernet-compatible interfaces are
          supported. The Ethernet-compatible interfaces in the device are:
          Ethernet,SHDSL, E1 in ETHER-HDLC mode, and the interfaces of
          bonding, bridging, VLAN.</para>
        </important>

        <figure>
          <title>Example of bridging</title>

          <graphic fileref="img/bridge.png" width="6in" />
        </figure>

        <para>In the figure above the bridge is formed by two interfaces —
        Ethernet-interface eth0 and SHDSL-interface dsl0 — and joins PC1 and
        PC2 into a single network.</para>

        <note>
          <para>It should be noted that the router operating in bridge mode
          and networks between which it transfers traffic do not need to be
          located in the same address space as it is required when traffic
          routing is being set.</para>

          <para>Moreover, such router cannot have an IP-address. However, if
          the router management is needed, it is necessary to set an
          IP-address from the same network with the computer on which the
          management of the router will be performed. In our example the
          routers can have the following IP-addresses: 192.168.90.10 and
          192.168.90.11.</para>
        </note>

        <para>The following figure shows a network analogous to the previous
        one, but with bonding that allows to expand the network capacity. In
        this case bridge is formed by the Ethernet-interface eth0 and bonded
        SHDSL-interfaces dsl0 and dsl1 into a single interface bond0:</para>

        <figure>
          <title>Example of a bridge with bonding</title>

          <graphic fileref="img/bridge+bonding.png" width="6in" />
        </figure>

        <para>Creation of a dynamic interface of a bridge is performed on page
        Network/Dynamic interfaces/Manage, where "Bridge" should be selected
        as a protocol.</para>

        <para>After the interface is added, its name will be displayed in the
        menu Network/Dynamic interfaces/br*. Besides, a window of the
        interface quick settings will be opened, where the user can set all
        the parameters necessary for interface launching:</para>

        <figure>
          <title>Bridge quick settings window</title>

          <graphic fileref="img/wf2-iface-bridge-wizard.png" width="6in" />
        </figure>

        <para>In this window all the parameters, except one, were described in
        the previous chapter. The new parameter - <emphasis>Bridge
        interfaces</emphasis> - contains the interfaces enumerated with
        spacing which form the bridge.</para>

        <important>
          <para>Physical interface can be added only to
          <emphasis>one</emphasis> interface of the bridge! For example, the
          interfaces br0 (eth0, dsl0) and br1 (eth1, dsl0) cannot be created
          because the dsl0 can be added only to one interface of the bridge.
          To break this limit use VLAN technology (see the relevant chapter
          with examples of use)</para>
        </important>

        <para>After the settings are saved, the interfaces, forming a bonding,
        will be adjusted automatically: for them <emphasis>enabled=1
        auto=0</emphasis> is set. The IP-addresses of the existing interfaces,
        if they were set, will be reseted.</para>

        <para>The settings can be altered on the interface adjustment page, in
        the tab General.</para>

        <important>
          <para>Launching of <emphasis>br*</emphasis> interface leads to reset
          of the IP-addresses of the physical interfaces which form the
          bridge. Therefore, if the setting is made via a physical interface
          which is a part of the bridge, the management of routers can be
          lost. To avoid this set an IP-address to the dynamic interface
          <emphasis>br*</emphasis>.</para>
        </important>

        <para>The same procedure should be executed on the second device, and
        in a couple of minutes, during which the bridge recognizes the network
        topology and conduct a short procedure of self-learning, the
        packet-mode communication between the interfaces will begin.</para>

        <para>Additional settings can be made for the bridge, which are
        available on page Network/Dynamic interfaces/br*, tab Specific:</para>

        <figure>
          <title>Additional parameters of bridge</title>

          <graphic fileref="img/wf2-iface-bridge-specific.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>STP enabled</emphasis> — enable Spanning Tree
            Protocol. The main target of the STP is to bring the Ethernet
            topology with its numerous interrelations to a state of a
            tree-type typology, eliminating the packet cycles. Is is performed
            by means of automatic blocking of redundant ports.</para>
          </listitem>

          <listitem>
            <para><emphasis>Interfaces</emphasis> — interfaces forming the
            bridge.</para>
          </listitem>

          <listitem>
            <para><emphasis>Priority</emphasis> — priority of the bridge, the
            less is the value, the higher is the priority. Used in STP.</para>
          </listitem>

          <listitem>
            <para><emphasis>Forward delay</emphasis> — time which the bridge
            spends inListening and Learning modes before switching to
            Forwarding mode (working mode). In seconds. Used in STP.</para>
          </listitem>

          <listitem>
            <para><emphasis>Hello time</emphasis> — time intervals between the
            sending of packets about the network topology. In seconds. Used in
            STP.</para>
          </listitem>

          <listitem>
            <para><emphasis>Max age</emphasis> — if the hello packet does not
            come from the bridge after a <emphasis>max age</emphasis>, bridge
            is considered broken. In this case routes reconfiguration is
            possible. In seconds. Used in STP.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="vlan">
        <title>VLAN interfaces settings</title>

        <para>The use of VLAN allows to divide traffic within a single
        communication environment. For this purpose in each Ethernet-slide a
        headline allocating the slide to this or that VLAN is added. Each VLAN
        is identified with its own number — <emphasis>VLAN ID</emphasis>,
        within the range from 0 to 4094. For work with VLAN networks a virtual
        interface VLAN is created on the base of a physical interface, having
        a certain VLAN ID.</para>

        <para>In order to create a VLAN interface, it is necessary to create a
        dynamic interface VLAN at page Network/Dynamic interfaces/Manage. For
        this purpose select the VLAN protocol, after which two parameters will
        be available:</para>

        <figure>
          <title>Adding a VLAN interface</title>

          <graphic fileref="img/wf2-iface-vlan.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Physical interface</emphasis> — physical interface
            on which basis the VLAN interface is created.</para>
          </listitem>

          <listitem>
            <para><emphasis>VLAN ID</emphasis> — VLAN number.</para>
          </listitem>
        </itemizedlist>

        <tip>
          <para>VLAN interface may operate on physical interfaces (SHDSL,
          Ethernet), and on dynamic ones (Bonding, Bridge).</para>
        </tip>

        <para>After the VLAN interface is added, it will be displayed in the
        list of interfaces as "InterfaceXvN", where InrefaceX — the name of
        the interface, N — VLAN number. For example, if the VLAN interface is
        created for the interface bond0 and VLAN ID 4, the name of the VLAN
        interface will be <emphasis>bond0v4</emphasis>. In the system the
        interface is desplayed as <emphasis>bond0.4</emphasis>.</para>

        <para>Now standard actions can be applied to the interface: set an
        IP-address, add it to bonding, bridge etc.</para>
      </section>
    </section>
  </chapter>

  <chapter id="traffic">
    <title>Traffic control</title>

    <section id="routes">
      <title id="routes.title">Addition of network routes</title>

      <para>Network routs define which routers give access to which network.
      Addition of network routes is made on adjustment page of the network
      interface through which it goes. For example, a network has the
      following structure:</para>

      <figure>
        <title>Example: network structure</title>

        <graphic fileref="img/routes-network.png" width="6in" />
      </figure>

      <para>Our router has an identification name SG-17R, and is connected to
      two routers — GW1 and GW2 - over eth0 (Ethernet) and dsl0 (SHDSL)
      interfaces accordingly. It is obvious that the addition of the network
      routes will be the following:</para>

      <itemizedlist>
        <listitem>
          <para>Network1: network 192.168.100/24 via the router 192.168.1.2
          (interface eth0)</para>
        </listitem>

        <listitem>
          <para>Network2: network 192.168.3.0/24 via the router 192.168.2.1
          (interface dsl0)</para>
        </listitem>

        <listitem>
          <para>Network3: network 192.168.20.0/24 via the router 192.168.2.1
          (interface dsl0)</para>
        </listitem>
      </itemizedlist>

      <para>Analysing the routes we come to the conclusion that the route of
      the first network is referred to the interface eth0, of the second and
      the third — to dsl0. For this reason the addition of routes via
      web-interface will be made on the pages of the relevant
      interfaces.</para>

      <note>
        <para>The route to the Network3 and Network 2 is added via the router
        GW2 as the router SG-17R does not have a direct connection to the
        router GW3 and is forced to address it via GW2.</para>
      </note>

      <para>To add a route forward to the adjustment page of the interface
      corellating with the route (for example, Network/Static
      interfaces/eth0), where select the tab Routes:</para>

      <figure>
        <title>Empty route list</title>

        <graphic fileref="img/wf2-routes-list-empty.png" width="6in" />
      </figure>

      <para>Initially the list is empty. To add a new route, click on "+" and
      fill the boxes in the new window:</para>

      <figure>
        <title>Addition of a route</title>

        <graphic fileref="img/wf2-routes-add.png" width="6in" />
      </figure>

      <para>After the route is added, the information about it will be
      displayed in the table of routes:</para>

      <figure>
        <title>List of routes for eth0 interface</title>

        <graphic fileref="img/wf2-routes-list-eth0.png" width="6in" />
      </figure>

      <para>After the routes necessary for dsl0 interface will be added, its
      routes table will change to the following:</para>

      <figure>
        <title>List of routes for dsl0 interface</title>

        <graphic fileref="img/wf2-routes-list-dsl0.png" width="6in" />
      </figure>

      <para>The route registers in the system immediately after it is added.
      The user can check that the added routes are accepted correctly by the
      system on the tab Status, in the output Routes:</para>

      <figure>
        <title>Check of the list of routes for dsl0 interface</title>

        <graphic fileref="img/wf2-iface-status-routes.png" width="6in" />
      </figure>
    </section>

    <section id="fw">
      <title>Firewall management</title>

      <para>The firewall is used to limit the access to these or that network
      resources, basing on IP-addresses, ports of the sender and the
      addressee, or on the used protocol.</para>

      <para>Firewall activation is made on the page Network/Firewall:</para>

      <figure>
        <title>Firewall activation</title>

        <graphic fileref="img/wf2-fw-activate.png" width="6in" />
      </figure>

      <para>Firewall functioning is based on the packet passing chains of
      rules, where each rule defines one of the action: packet accepting or
      dropping, basing on one or several criteria. Addition of the rules is
      carried out on the tab Filter. For each chain a default action is set -
      policy, i.e. in case if the packet does not complies with the
      criteria:</para>

      <figure id="filter_policy">
        <title>Policy of chains</title>

        <graphic fileref="img/wf2-fw-policy.png" width="6in" />
      </figure>

      <note>
        <para>When implementing a policy in DROP value for the chain INPUT or
        OUTPUT, make sure that there are exist permitting rules, otherwise the
        router management can be lost.</para>
      </note>

      <para>The following actions are determined for a rule:</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>ACCEPT</emphasis> — acception of a packet;</para>
        </listitem>

        <listitem>
          <para><emphasis>DROP</emphasis> — dropping of a packet without
          notifying the source of the packet;</para>
        </listitem>

        <listitem>
          <para><emphasis>REJECT</emphasis> — rejection of a packet with
          notification to the source;</para>
        </listitem>
      </itemizedlist>

      <para>The chain FORWARD is passed by transit packets, i.e. which are
      transferred from one interface of the router to another:</para>

      <figure id="filter_forward">
        <title>FORWARD chain</title>

        <graphic fileref="img/wf2-fw-forward.png" width="6in" />
      </figure>

      <para>The chain INPUT is passed by packets addressed to the router
      :</para>

      <figure id="filter_input">
        <title>INPUT chain</title>

        <graphic fileref="img/wf2-fw-input.png" width="6in" />
      </figure>

      <para>The chainOUTPUT is passed by packets which source is the
      router:</para>

      <figure id="filter_output">
        <title>OUTPUT chain</title>

        <graphic fileref="img/wf2-fw-output.png" width="6in" />
      </figure>

      <para>Addition of rules is made by clicking on the"+" button, and
      filling the form opened in a new window:</para>

      <figure id="filter_add">
        <title>Addition of a rule</title>

        <graphic fileref="img/wf2-fw-add.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Enabled</emphasis> — the rule is active or
          not.</para>
        </listitem>

        <listitem>
          <para><emphasis>Short name</emphasis> — the rule name. Should
          include only latin letters and cyphers.</para>
        </listitem>

        <listitem>
          <para><emphasis>Protocol</emphasis> — For protocols <emphasis>tcp,
          udp</emphasis> additional settings are available:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>Destination port</emphasis> — port of the packet
              addressee.</para>
            </listitem>

            <listitem>
              <para><emphasis>Source port</emphasis> — port of the packet
              sender.</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para><emphasis>Source IP</emphasis> — IP-address or the network of
          the sender.</para>
        </listitem>

        <listitem>
          <para><emphasis>Destination IP</emphasis> — IP-address or the
          network of the addressee.</para>
        </listitem>

        <listitem>
          <para><emphasis>Action</emphasis> — action with the packet.</para>
        </listitem>
      </itemizedlist>

      <note>
        <para>If the changes were not implemented, check whether you have
        activated the firewall on page Network/Firewall.</para>
      </note>
    </section>

    <section id="nat">
      <title>NAT</title>

      <para>NAT — network address translation — allows to change the source
      address or the destination address.</para>

      <para>NAT is a part of the firewall, and the scheme of management is the
      same, only action is changed. For chains in NAT policies are set, i.e.
      actions for the packets satisfying none of the criteria:</para>

      <figure>
        <title>Policy of chains</title>

        <graphic fileref="img/wf2-nat-policy.png" width="6in" />
      </figure>

      <note>
        <para>As far as in the PREROUTING chain go the packets intended for
        the router itself, before setting the DROP policy make sure that the
        chain contains a rule permitting the passage of packets for router
        management.</para>
      </note>

      <para>All the network packets, transit or intended for the router, go
      first to the PREROUTING chain, where several actions can be done to
      them. It is recommended to carry out a packet filtration procedure in
      this chain using the FORWARD chain for this purpose. The PREROUTING
      chain is intended for DNAT - destination NAT - performance, i.e.
      changing of the destination address .</para>

      <figure id="nat_prerouting">
        <title>PREROUTING chain</title>

        <graphic fileref="img/wf2-nat-prerouting-list.png" width="6in" />
      </figure>

      <para>The window od addition is shown below.</para>

      <figure id="nat_add">
        <title>Addition of a rule to PREROUTING chain</title>

        <graphic fileref="img/wf2-nat-prerouting-add.png" width="6in" />
      </figure>

      <para>When choosing the <emphasis>DNAT</emphasis> action, there appears
      a new option <emphasis>Nat to address</emphasis> — address to which the
      destination address of the packet should be changed. The user can either
      input the address only, or to indicate the address with the number of
      port separated with a colon (example 192.168.2.1:25).</para>

      <para>The chain POSTROUTING is passed by the packets sourcing from the
      router, transit or generated on the router. In this chain a SNAT action
      can be performed - source NAT — change of the source address, or
      MASQUERADE — in which case the substitutional address will be generated
      automatically (useful for work with dynamic interfaces and
      IP-addresses).</para>

      <figure id="nat_postrouting">
        <title>POSTROUTING chain</title>

        <graphic fileref="img/wf2-nat-postrouting.png" width="6in" />
      </figure>

      <para>Addition of a rule to the chain is similar to addition of a rule
      to the <emphasis>PREROUTING chain</emphasis>.</para>

      <note>
        <para>For NAT operation the firewall should be activated on page
        Network/Firewall.</para>
      </note>
    </section>

    <section id="qos">
      <title>Quality of service</title>

      <para>Quality of service (QoS) allows to change the sequence of traffic
      pass at the interface. Different disciplines of service provide
      different opportunities of traffic classification and control.</para>

      <para>QoS adjustment is done on the interface configuration page, QoS
      tab.</para>

      <figure>
        <title>QoS setting</title>

        <graphic fileref="img/wf2-qos.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>TX queue length</emphasis> — outgoing queue of the
          interface, measured in packets. If no settings are made, the value
          on default is set for the interface automatically.</para>
        </listitem>

        <listitem>
          <para><emphasis>Scheduler</emphasis> — discipline of traffic
          service.</para>
        </listitem>
      </itemizedlist>

      <section id="pfifo_fast">
        <title>Classless discipline pfifo_fast</title>

        <para>Standard discipline of traffic servicing, realizing a simple
        mechanism First In First Out. Consists of three lines — 0, 1 and 2. The
        line 0 is served until it contains packets, queued for tranfer. Then
        lines 1 and two are serviced in the same way.</para>

        <para>Traffic distribution along the lines can be performed by means
        of bit installation ToS — Type of Service, which is produced by the
        software generating the traffic or by means of the firewall. There
        exist fourToS bits:</para>

        <itemizedlist>
          <listitem>
            <para><emphasis>Minimum Delay</emphasis>;</para>
          </listitem>

          <listitem>
            <para><emphasis>Maximum Throughput</emphasis>;</para>
          </listitem>

          <listitem>
            <para><emphasis>Maximum Reliability</emphasis>;</para>
          </listitem>

          <listitem>
            <para><emphasis>Minimum Cost</emphasis> — minimum channel
            cost;</para>
          </listitem>
        </itemizedlist>

        <important>
          <para>In currebt version of web-interface of the router installation
          of ToS bits by means of the firewall is not available. For this
          purpose the console interface of the router can be used.</para>
        </important>
      </section>

      <section id="bfifo-pfifo">
        <title>Classless disciplines FIFO with bytes buffer (bfifo) and FIFO
        with packets buffer (pfifo)</title>

        <para>The simpliest service disciplines. Do not have internal lines,
        all traffic is equal. Allow to obtain some statistics of their
        performance.</para>

        <itemizedlist>
          <listitem>
            <para><emphasis>limit</emphasis> — queue length, for bfifo — in
            bites, for pfifo — in packets.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="sfq">
        <title>Classless discipline SFQ</title>

        <para>SFQ — Stochastic Fairness Queueing — fair planning discipline.
        It operates with such notions as "flow" — TCP session or UDP data
        flow, for each of which a separate pseudo-queue is created as a part
        of the discipline. The discipline switches successively between the
        pseudo-queues (round robin), not allowing any of the flows to
        monopolize the channel.</para>

        <para>For session distribution along the pseudo-queues hashes are used
        which need reconfiguration for the improvement of the discipline
        performance. The discipline is configured according to several
        parameters.</para>

        <itemizedlist>
          <listitem>
            <para><emphasis>perturb</emphasis> — time interval in seconds, in
            which hash reconfiguration is performed. Recommended value —
            10.</para>
          </listitem>

          <listitem>
            <para><emphasis>quantum</emphasis> — number of bytes, which are
            extracted from the queue during one "step" (before switching to
            another queue). On default equal to maximum transmission unit
            (MTU), and must not exceed it!</para>
          </listitem>

          <listitem>
            <para><emphasis>limit</emphasis> — number of packets which can be
            queued. In case the number is exceeded, packets will be
            dropped.</para>
          </listitem>
        </itemizedlist>

        <para>When installing the SFQ discipline to web-interface, the above
        mentioned settings are made automatically taking into account the
        recommended values.</para>
      </section>

      <section>
        <title>Classless discipline ESFQ</title>

        <para>ESFQ — Enhanced Stochastic Fairness Queueing — improved SFQ
        discipline. It provides more opportunities for setting, which allows
        more equal distribution of the bandwidth. For example, if the user
        launches programs operating in several flows, the usual SFQ becomes
        ineffective, as it cannot divide the channel between the users. ESFQ
        discipline allows to choose another algorithm of hashing, for example,
        using the source IP-address or the destination IP-address, which
        allows to distribute different users to different pseudo-queues
        indepandable of the number of sessions for each user.</para>

        <figure>
          <title>ESFQ configuration</title>

          <graphic fileref="img/wf2-qos-esfq.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Limit</emphasis> — number of packets that can be
            queued. In case the number is exceeded, packets will be
            dropped.</para>
          </listitem>

          <listitem>
            <para><emphasis>Depth</emphasis> — maximum number of pseudo-queues
            (in SFQ this number is strictly limited to 1024).</para>
          </listitem>

          <listitem>
            <para><emphasis>Hash</emphasis> — hash type.</para>

            <itemizedlist>
              <listitem>
                <para><emphasis>Classic</emphasis> — analogous of that used in
                SFQ.</para>
              </listitem>

              <listitem>
                <para><emphasis>Source address</emphasis> — address of the
                sender.</para>
              </listitem>

              <listitem>
                <para><emphasis>Destination address</emphasis> — address of
                the recepient.</para>
              </listitem>
            </itemizedlist>
          </listitem>

          <listitem>
            <para><emphasis>perturb</emphasis> — time interval in seconds in
            which the hash reconfiguration is performed. Recommended value -
            10 (when installing the discipline via web-interface the
            recommended value is set automatically).</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="tbf">
        <title>Classless discipline TBF</title>

        <para>Token Bucket Filter (TBF) — a simple classless discipline, which
        transmits the coming packets at a bitrate not exceeding the set value.
        This discipline is very economical in terms of system resources,
        therefore it is a best choice when it is needed just to limit the
        speed of the outcoming traffic.</para>

        <para>The essense of the discipline is the following. Packets coming
        for tranferring are capture in discipline buffer, from which they are
        transferred to the outgoing interface at a pre-set speed. The three
        situations are possible:</para>

        <itemizedlist>
          <listitem>
            <para>Packets come at the speed equal to the speed of their
            transferring to the outgoing interface. In this case the packets
            go through the interface without any delays.</para>
          </listitem>

          <listitem>
            <para>Packets come at the speed less than the speed of their
            transferring to the outgoing interface. In this case during short
            periods of increase in the incoming traffic speed it will be
            accumulated in the incoming queue and then transmitted at the
            pre-set speed.</para>
          </listitem>

          <listitem>
            <para>Packets come at the speed exceeding the speed of their
            transferring to the outgoing interface. In this case the packets
            will begin to drop after a while.</para>
          </listitem>
        </itemizedlist>

        <para>Discipline has several parameters allowing to manage its
        performance:</para>

        <figure>
          <title>TBF configuration</title>

          <graphic fileref="img/wf2-qos-tbf.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Rate</emphasis> — speed at which the incoming
            traffic is transmitted to the outgoing interface.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="htb">
        <title>Class-specific discipline HTB</title>

        <para>The HTB discipline allows to separate different throughput of
        the channel for different types of traffic. It is done by means of
        traffic distribution along different classes, each of which has a
        pre-set throughput value. The traffic classification can be done on
        the basis of IP-addresses or source/destionation ports. This type of
        traffic processing (limitation of its speed) is called
        <emphasis>shaping</emphasis>.</para>

        <para>First of all it should be noted that the user can control the
        speed only of the outgoing traffic (which is reasonable), therefore it
        is important to define the interface at which the traffic will be
        outgoing correctly, when adding the rules of shaping.</para>

        <para>Realization of QoS on the basis of the class-specific discipline
        HTB consists of two steps — class definition and traffic distribution
        in classes according to certain criteria using filters. Classes
        defining the traffic speed can be added either to the root, or to
        other sublasses, forming a hierarchy of classes. Filters are added
        into the root of the hierarchy.</para>

        <tip>
          <para>The peculiarity of classes consists in fact that the speed of
          one subclass can be increased (withing the value of the parent class
          speed) due to <emphasis>unused</emphasis> speed of another
          subclass.</para>
        </tip>

        <para>For the discipline a class can be created to which all the
        traffic not complying with any filter will be transmitted.</para>

        <figure>
          <title>Class on default</title>

          <graphic fileref="img/wf2-qos-htb-default-class.png" width="6in" />
        </figure>

        <para>The table below contains information about classes. Optionally,
        for each class can be added own classless discipline of service
        described above.</para>

        <figure id="qos_class">
          <title>Traffic classes</title>

          <graphic fileref="img/wf2-qos-class.png" width="6in" />
        </figure>

        <para>Class addition window is shown below.</para>

        <figure id="htb_class_add">
          <title>Addition of a class</title>

          <graphic fileref="img/wf2-qos-class-add.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Enabled</emphasis> — the class is active or
            not.</para>
          </listitem>

          <listitem>
            <para><emphasis>Name</emphasis> — name of the class being added.
            Used for traffic classification in filter.</para>
          </listitem>

          <listitem>
            <para><emphasis>Parent class</emphasis> - root class. When a class
            is added into a non-root class - it is called
            <emphasis>subclass</emphasis>.</para>
          </listitem>

          <listitem>
            <para><emphasis>Rate</emphasis> — throughput of a class. Should
            not exceed the speed of the parent class!</para>
          </listitem>

          <listitem>
            <para><emphasis>Ceil</emphasis> — maximum throughput of a subclass
            (in case when another subclass of the same class does not use the
            full volume of the throughput given to it). Should not exceed the
            speed of the parent class!</para>
          </listitem>

          <listitem>
            <para><emphasis>Qdisc</emphasis> — an optional classless
            discipline of class service. Here the name of the serviced
            discipline and its parameters can be indicated, for example:
            <command>esfq#limit#128#depth#128#divisor#10#hash#classic#perturb#15</command>
            or <command>sfq#perturb#10</command>, etc. Spacing should be
            substituted with <emphasis>#</emphasis> symbol. The detailed
            information about the classless disciplines and their parameters
            is given above.</para>
          </listitem>
        </itemizedlist>

        <para>To avoid the confusion, let`s pay attention to the abbreviations
        conventional for QoS which describes the rate:</para>

        <itemizedlist>
          <listitem>
            <para>mbps = 1024 kbps = 1024 * 1024 bps =&gt; byte/s =&gt; 1024
            kbytes/sec.</para>
          </listitem>

          <listitem>
            <para>mbit = 1024 kbit =&gt; kilo bit/s =&gt; 1024
            kbit/sec.</para>
          </listitem>
        </itemizedlist>

        <para>Table of filters dividing traffic into classes on the basis of
        certain criteria.</para>

        <figure id="qos_filter">
          <title>Filters dividing traffic into classes</title>

          <graphic fileref="img/wf2-qos-filter.png" width="6in" />
        </figure>

        <para>A filter creation window is shown below.</para>

        <figure id="htb_filter_add">
          <title>Addition of a filter</title>

          <graphic fileref="img/wf2-qos-filter-add.png" width="6in" />
        </figure>

        <itemizedlist>
          <listitem>
            <para><emphasis>Enabled</emphasis> — the filter is active or
            not.</para>
          </listitem>

          <listitem>
            <para><emphasis>Name</emphasis> — name of the filter.</para>
          </listitem>

          <listitem>
            <para><emphasis>Prio</emphasis> — priority of the filter. The less
            is the value — the higher is the priority.</para>
          </listitem>

          <listitem>
            <para><emphasis>Protocol</emphasis> — traffic classification
            according to protocol.</para>
          </listitem>

          <listitem>
            <para><emphasis>Source IP</emphasis> — traffic classification
            according to source address.</para>
          </listitem>

          <listitem>
            <para><emphasis>Destination IP</emphasis> — traffic classification
            according to destination address.</para>
          </listitem>

          <listitem>
            <para><emphasis>Source port</emphasis> — traffic classification
            according to sourse port number.</para>
          </listitem>

          <listitem>
            <para><emphasis>Destination port</emphasis> — traffic
            classification according to destination port number.</para>
          </listitem>

          <listitem>
            <para><emphasis>Class</emphasis> — to which class the packet
            should be referred.</para>
          </listitem>
        </itemizedlist>

        <para>The configuration describes in the figures has one class -
        <emphasis>main</emphasis> - and two subclasses:
        <emphasis>voip</emphasis> and <emphasis>data</emphasis>. The subclass
        <emphasis>voip</emphasis> is used for high priority traffic, at the
        rate of 1500 to 1900 kbit/sec. The subclass <emphasis>data</emphasis>
        is used as a default class for all other traffic. Its rate value - 400
        to 1900 kbit/sec.</para>

        <para>All the traffic coming from the node 192.168.2.10 is transmitted
        to the <emphasis>voip</emphasis> subclass.</para>
      </section>
    </section>
  </chapter>

  <chapter id="dhcp_server">
    <title>Network services settings</title>

    <section id="dhcp">
      <title>DHCP server</title>

      <para>Adjustment of DHCP server is performed for each network interface
      independently, and is made at network interface adjustment page, DHCP
      tab, or Services/DHCP Server.</para>

      <important>
        <para>Before DHCP server activation, it is necessary to launch the
        interface (select the flags <emphasis>Enabled</emphasis> and
        <emphasis>Auto</emphasis>) at which it will work, and set an
        IP-address for the interface.</para>
      </important>

      <para>DHCP server adjustment page is shown below.</para>

      <figure>
        <title>DHCP-server adjustment</title>

        <graphic fileref="img/wf2-dhcp.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Enable DHCP Server</emphasis> — activate a
          DHCP-server for the given interface.</para>
        </listitem>

        <listitem>
          <para><emphasis>Start IP</emphasis>, <emphasis>End IP</emphasis> —
          the extremes of the diapason for allocation of IP-addresses for DHCP
          clients.</para>
        </listitem>

        <listitem>
          <para><emphasis>Netmask</emphasis> — network mask, to which
          IP-addresses are allocated.</para>
        </listitem>

        <listitem>
          <para><emphasis>Default router</emphasis> — route on default.</para>
        </listitem>

        <listitem>
          <para><emphasis>Default lease time</emphasis> — time for which an
          IP-address is allocated. Upon the expiry of the time, the client
          should refer to the DHCP-server again to approve the previously
          given address or to get a new one.</para>
        </listitem>

        <listitem>
          <para><emphasis>DNS server</emphasis> — IP-ddress of the DNS-server,
          to which the client will refer to get domain names
          permission.</para>
        </listitem>

        <listitem>
          <para><emphasis>Domain</emphasis> — domain to which the DHCP-server
          client will enter.</para>
        </listitem>

        <listitem>
          <para><emphasis>NTP server</emphasis> — IP-address of the exact time
          server.</para>
        </listitem>

        <listitem>
          <para><emphasis>WINS server</emphasis> — IP-address of the
          WINS-server.</para>
        </listitem>
      </itemizedlist>

      <note>
        <para>After the settings are saved, the DHCP-server will be started or
        restarted automatically.</para>
      </note>

      <para>There is a possibility of allocation of static IP-addresses to
      certain devices. The identification of the devices is done according to
      the MAC-address of the network adapter. The form of allocation of an
      IP-address to a MAC-address is located in the bottom of the adjustment
      page and is shown in the figure:</para>

      <figure id="dhcp_server.static_add">
        <title>IP to MAC allocation form</title>

        <graphic fileref="img/wf2-dhcp-static-add.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Host name</emphasis> — defines the name of the
          device to which the address in allocated. This value is of
          informational character and is used only in the rule, may not
          coinside with the actual name of the device.</para>
        </listitem>

        <listitem>
          <para><emphasis>IP Address</emphasis> — IP-address which will be
          allocated to the device</para>
        </listitem>

        <listitem>
          <para><emphasis>MAC Address</emphasis> — MAC-address of the network
          adapter of the device, to which an IP-address will be
          allocated.</para>
        </listitem>
      </itemizedlist>

      <para>After the changes are saved, in the table of static addresses a
      new entry will appear.</para>

      <figure>
        <title>Updated list of IP-addresses</title>

        <graphic fileref="img/wf2-dhcp-static-list.png" width="6in" />
      </figure>
    </section>

    <section id="dns_server">
      <title>DNS server</title>

      <para>DNS server is responsible for the transformation of a domain name
      to an IP-address. Its setting is made at the page Services/DNS
      server.</para>

      <figure>
        <title>DNS server settings</title>

        <graphic fileref="img/wf2-dns_server.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Enable DNS server</emphasis> — activate the DNS
          server.</para>
        </listitem>

        <listitem>
          <para><emphasis>Forwarder DNS 1</emphasis> — server DNS 1, to which
          the queries should be redirected in case the local DNS server does
          not respond.</para>
        </listitem>

        <listitem>
          <para><emphasis>Forwarder DNS 2</emphasis> — server DNS 2, to which
          the queries should be redirected in case the local DNS server or DNS
          server 1 do not respond.</para>
        </listitem>
      </itemizedlist>

      <para>This DNS server can be used as an authoritative server of the
      domain, i.e. keep information about the domain records (NS, A, CNAME,
      ...). For this purpose there should be created a zone file, in which the
      information about the domain and its records would be kept.</para>

      <figure id="dns_server.dns_zones">
        <title>DNS server zones</title>

        <graphic fileref="img/wf2-dns_server-zones.png" width="6in" />
      </figure>

      <para>Creation and editing of the zone file is performed on the tab
      Zones with the help of relevant buttons.</para>

      <figure id="dns_server.zone_add">
        <title>Addition of a zone</title>

        <graphic fileref="img/wf2-dns_server-add-zone.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Zone id</emphasis> — zone indentifier (the
          identifier names the file in which the zone is held). This parameter
          is set while zone creation, it cannot be edited after that.</para>
        </listitem>

        <listitem>
          <para><emphasis>Enable</emphasis> — the zone is active or
          not.</para>
        </listitem>

        <listitem>
          <para><emphasis>Serial</emphasis> — zone serial number. After evry
          edition of the zone file the serial number should be enlarged in
          order that DNS servers could see that the alternations were made in
          the zone. It is convenient to use a date of editing - year, month,
          day - plus a two-digit number denoting the number of the edition for
          this day.</para>
        </listitem>

        <listitem>
          <para><emphasis>Zone</emphasis> — zone name (the domain name for
          which a zone is created).</para>
        </listitem>

        <listitem>
          <para><emphasis>Name server</emphasis> — authoritative DNS server
          for the domain. If in this box the full domain name of the server is
          indicated, it should end with a dot:
          <emphasis>ns.testdomain.org.</emphasis>, otherwise a name of the
          current zone.</para>
        </listitem>

        <listitem>
          <para><emphasis>Admin</emphasis> — zone administratoe e-mail
          address.</para>
        </listitem>

        <listitem>
          <para><emphasis>Refresh</emphasis> — intervals in which DNS slave
          servers will update the zone.</para>
        </listitem>

        <listitem>
          <para><emphasis>TTL</emphasis> — cach atorage period of a zone
          record.</para>
        </listitem>

        <listitem>
          <para><emphasis>Retry</emphasis> — intervals in which the slave
          server will retry the zone update in case of failure.</para>
        </listitem>

        <listitem>
          <para><emphasis>Expire</emphasis> — period after which the zone data
          is not considered actual any more.</para>
        </listitem>
      </itemizedlist>

      <para>After an addition of a zone, the relevant entry will appear in the
      table of zones.</para>

      <para>Forwarding to the zone records creation page is made by clicking
      on the zone identifier whicn is underlined. As a result, a page with a
      table containing the records for the zone will be opened. The form of
      creation of a new record is given below.</para>

      <figure id="dns_server.zone_record_add">
        <title>Addition of a record to the zone</title>

        <graphic fileref="img/wf2-dns_server-record-add.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Type of record</emphasis> — The following values are
          available:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>A</emphasis> — shows the IP-address
              corresponding to the name.</para>
            </listitem>

            <listitem>
              <para><emphasis>CNAME</emphasis> — a synonym of another name. In
              this case the corresponding name is indicated as the
              DATA.</para>
            </listitem>

            <listitem>
              <para><emphasis>MX</emphasis> — nae of mail server for the
              domain. If this record type is chosen an additional parameter is
              available.</para>

              <itemizedlist>
                <listitem>
                  <para><emphasis>Priority</emphasis> — priority of the MX
                  record.</para>
                </listitem>
              </itemizedlist>
            </listitem>

            <listitem>
              <para><emphasis>NS</emphasis> — indicates the authoritative DNS
              server of the domain (in point of fact - domain
              delegation).</para>
            </listitem>

            <listitem>
              <para><emphasis>PTR</emphasis> — indicates a name for the given
              IP-address. Used in the inverse zone.</para>
            </listitem>

            <listitem>
              <para><emphasis>TXT</emphasis> — additional textual
              information.</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para><emphasis>Domain or host</emphasis> — domain name (or the
          IP-address, for inverse zones).</para>
        </listitem>

        <listitem>
          <para><emphasis>Data</emphasis> — record data— domain name or
          IP-address, or some textual information.</para>
        </listitem>
      </itemizedlist>

      <para>After saving, a new record for the zone will be displayed in the
      table.</para>

      <figure>
        <title>Table of zone records</title>

        <graphic fileref="img/wf2-dns_server-records.png" width="6in" />
      </figure>

      <para>In order to return to the list of zones click on <emphasis>Back to
      list of zones</emphasis>.</para>
    </section>
  </chapter>

  <chapter id="voip">
    <title>VoIP</title>

    <section id="voip.intro">
      <title>General information</title>

      <para>The device allows to arrange the IP-telephony using modules MR-17V
      which can be complete with submodules having FXO (SMR-17Vo), FXS
      (SMR-17Vs) or Voice Frequency (SMR-17Vf) ports.</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>FXO</emphasis> — connection to the public telephone
          network (PSTN) or to office PBX.</para>
        </listitem>

        <listitem>
          <para><emphasis>FXS</emphasis> — commutation of telephone
          apparatuses.</para>
        </listitem>

        <listitem>
          <para><emphasis>VF</emphasis> — commutation of voice frequency
          equipment.</para>
        </listitem>
      </itemizedlist>

      <para>When working with VoIP, the router must have a unique three-digit
      number which is used for addressing it from the side of other routers.
      For each router, the interfaces of the VoIP module (FXO/FXS/VF) have
      unique two-digit channel numbers which allow to identify it for call
      receiption and initiation.</para>

      <para>Numbers used for calls via the router look as follows:</para>

      <para>xxxyy[zzz...], where:</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>xxx</emphasis> — the number of router.</para>
        </listitem>

        <listitem>
          <para><emphasis>yy</emphasis> — the number of channel.</para>
        </listitem>

        <listitem>
          <para><emphasis>[zzz...]</emphasis> — an additional number, for
          example, when calling via PBX.</para>
        </listitem>
      </itemizedlist>

      <para>For example, if the number of the router is 100, and we want to
      call to its second port, then dialling number from phone connected to
      this router or to another one looks as follws: 10002.</para>

      <para>Also, when dialling number from phone connected to the router, the
      following codes are available:</para>

      <itemizedlist>
        <listitem>
          <para>Instead of the router number you can dial:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>*</emphasis> — calling to the own router;</para>
            </listitem>

            <listitem>
              <para><emphasis>#</emphasis> — calling to a number from the
              address book.</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>Instead of the channel number you can dial:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>*</emphasis> — calling to the first unoccupied
              FXO port;</para>
            </listitem>

            <listitem>
              <para><emphasis>#</emphasis> — calling via SIP-server (only for
              the abonents registered at SIP-server, indicated in settings. In
              order to call to an abonent of another SIP-server - it is
              necessary to add them to the address book and make calls through
              it).</para>
            </listitem>
          </itemizedlist>
        </listitem>
      </itemizedlist>

      <para>For calls to other routers an IP-address of the router should be
      received according to its number. For this purpose the routing table is
      used, where the correlations between the router number and its
      IP-address are stored. The content of the table is usually similar for
      all the routers of the network.</para>

      <para>In order to speed up the dialling of frequently used or long
      numbers, the address book is used. A short number for speed-dial (with
      «#» before the number) and the corresponding full number should be added
      to the address book.</para>

      <para>In the IP-telephony software the Hotline mode support is realized.
      The essence is the following: when answering the phone connected to a
      FXS port, a special background process (daemon) may start automatic
      dialling of the recorded number. When a call is incoming to a FXO port
      (connected to PSTN or PBX), daemon can redirect the call from one port
      to another or to a specified port of another router.</para>

      <para>When adding full numbers to the address book table and Hotline
      table, the use of a special symbol «,» is accepted - it denotes a second
      delay when dialling the number.</para>
    </section>

    <section id="voip.settings">
      <title>Setting of basic parameters</title>

      <para>Basic settings of VoIP are made at the page
      Hardware/VoIP/Settings. There are several groups of settings at the
      page. We will describe them one by one.</para>

      <figure>
        <title>Basic settings of VoIP</title>

        <graphic fileref="img/wf2-voip-settings-general.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>RTP port start</emphasis> — begining of the range of
          numbers of portes used by the device when sending RTP traffic (UDP
          protocol is used).</para>
        </listitem>

        <listitem>
          <para><emphasis>RTP port end</emphasis> — end of the range of
          numbers of portes used by the device when sending RTP traffic (UDP
          protocol is used).</para>
        </listitem>

        <listitem>
          <para><emphasis>Logging level</emphasis> — level of detailization of
          diagnostic messages.</para>
        </listitem>
      </itemizedlist>

      <para>As far as the VoIP traffic is sensitive to delays, there is a
      possibility of setting of the needed bit valuesType of Service. On
      default the value 0x10 is used meaning the minimal delay of traffic
      transfer.</para>

      <figure>
        <title>ToS settings</title>

        <graphic fileref="img/wf2-voip-settings-tos.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>RTP ToS</emphasis> — value for 8 byte ToS field,
          allocated to RTP packets (actual voice traffic).</para>
        </listitem>

        <listitem>
          <para><emphasis>SIP ToS</emphasis> — value for 8 byte ToS field,
          allocated to SIP packets(announcement).</para>
        </listitem>
      </itemizedlist>

      <para>The device allows making calls via SIP-proxy, providing the
      following settings.</para>

      <figure>
        <title>SIP settings</title>

        <graphic fileref="img/wf2-voip-settings-sip.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Registrar</emphasis> — IP-telephony server in the
          format <emphasis>sip:server.domain</emphasis>;</para>
        </listitem>

        <listitem>
          <para><emphasis>Username</emphasis> — usenameon the server;</para>
        </listitem>

        <listitem>
          <para><emphasis>Password</emphasis> — user password;</para>
        </listitem>

        <listitem>
          <para><emphasis>User SIP URI</emphasis> — URI of the user in the
          format <emphasis>sip:user@server.domain</emphasis>;</para>
        </listitem>

        <listitem>
          <para><emphasis>FXS channel</emphasis> — number of FXS channel, to
          which the incoming calls received from SIP-proxy are
          redirected.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="voip.hotline">
      <title>Hotline mode</title>

      <para>Hotline is adjusted at page Hardware/VoIP/Hotline. As far as
      theHotline settings are allocated to specific channels of a module and
      the performance depends on the channel type (FXO/FXS), the table
      contains the available channels and their types.</para>

      <para>Hotline mode works with channels of FXO and FXS types, and has a
      separate working algorithm for each type.</para>

      <itemizedlist>
        <listitem>
          <para><emphasis>FXO</emphasis> — call redirection to another channel
          during the incoming call to a FXO channel (connected to PSTN or
          PBX).</para>
        </listitem>

        <listitem>
          <para><emphasis>FXS</emphasis> — number dialling by the router when
          answerring a call, on the telephone apparatus connected to a FXS
          channel.</para>
        </listitem>
      </itemizedlist>

      <para>Let`s consider the parameters responsible for Hotline
      adjustment:</para>

      <figure>
        <title>Hotline adjustment table</title>

        <graphic fileref="img/wf2-voip-hotline.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Channel</emphasis> — channel number;</para>
        </listitem>

        <listitem>
          <para><emphasis>Type</emphasis> — channel type;</para>
        </listitem>

        <listitem>
          <para><emphasis>Hotline</emphasis> — Hotline mode in the channel
          when selected;</para>
        </listitem>

        <listitem>
          <para><emphasis>Complete number</emphasis> — full number dialling by
          a router when finding a traceable event (answering an incoming
          call);</para>
        </listitem>

        <listitem>
          <para><emphasis>Comment</emphasis> — comment (without
          spacing).</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="voip.vf">
      <title>VF channels</title>

      <para>VF channels allow to digitize the signal incoming from analogous
      equipment for the further transmission by means of IP-technology. VF
      channels adjustment is performed at the page Hardware/VoIP/VF, and
      consists in the adjustment of the connection between the two devices
      with VF modules which transmit signals from the analogous devices
      connected to them.</para>

      <para>To establish a connection, the correspondence between the chosen
      local number of the channel and the identifier of the remote device and
      the number of its channel should be indicated. After that the codec
      parameters are indicated used for signal digitizing and other settings.
      Both, two-wire and four-wire, VF modes are supported.</para>

      <figure>
        <title>VF channels setting</title>

        <graphic fileref="img/wf2-voip-vf.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>#</emphasis> — the number of the active VF
          channel;</para>
        </listitem>

        <listitem>
          <para><emphasis>EN</emphasis> — ativete the VF connection;</para>
        </listitem>

        <listitem>
          <para><emphasis>R.ID</emphasis> — identifier of the remote device,
          should be displayed in VoIP routing table (see below);</para>
        </listitem>

        <listitem>
          <para><emphasis>Chan</emphasis> — the number of VF channel at the
          remote device;</para>
        </listitem>

        <listitem>
          <para><emphasis>Codec</emphasis> — VoIP codec in use;</para>
        </listitem>

        <listitem>
          <para><emphasis>P.time</emphasis> — packetization time;</para>
        </listitem>

        <listitem>
          <para><emphasis>Pay-d</emphasis> — Payload — identifier of the
          content of RTP packet;</para>
        </listitem>

        <listitem>
          <para><emphasis>Bitpack</emphasis> —</para>
        </listitem>

        <listitem>
          <para><emphasis>JB type</emphasis> — jitter buffer type;</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>Fixed</emphasis> ;</para>
            </listitem>

            <listitem>
              <para><emphasis>Adapt.</emphasis> — adaptable;</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para><emphasis>LAT</emphasis> — Local Adaptation Type —</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>off</emphasis> ;</para>
            </listitem>

            <listitem>
              <para><emphasis>on</emphasis>;</para>
            </listitem>

            <listitem>
              <para><emphasis>SI</emphasis> — with sample interpolaton</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para><emphasis>nScal</emphasis> — average play out delay is equal
          to the estimated jitter times the scaling factor. Values:
          [1;16]</para>
        </listitem>

        <listitem>
          <para><emphasis>nInit</emphasis> — initial size of the jitter buffer
          in ms. Values: JB Adaptive [nMin;nMax], JB Fixed: for aLaw [10;
          150], for others [10; nMax]</para>
        </listitem>

        <listitem>
          <para><emphasis>nMin</emphasis> — minimum size of the jitter buffer
          in ms. Values: [10; nMax]</para>
        </listitem>

        <listitem>
          <para><emphasis>nMax</emphasis> — maximum size of the jitter buffer
          in ms. Values are depended on Codec and Pkt.time</para>
        </listitem>
      </itemizedlist>

      <important>
        <para>The same settings should be made on the second device.</para>
      </important>

      <note>
        <para>After the adjustment of the VF channel, the connection will be
        establiched and maintained automatically.</para>
      </note>

      <para>Adjustment of physical parameters of VF ports is performed in the
      tab Settings.</para>

      <figure id="voip.vf.settings">
        <title>Adjustment of physical parameters of VF ports</title>

        <graphic fileref="img/wf2-voip-vf-settings.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Wires</emphasis> — connection type: two-wire or
          four-wire;</para>
        </listitem>

        <listitem>
          <para><emphasis>Transmit type</emphasis> — signal level at
          transmission:</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>4-Wire Normal</emphasis>:</para>

              <itemizedlist>
                <listitem>
                  <para><emphasis>Tx (In)</emphasis>: -13 dBr</para>
                </listitem>

                <listitem>
                  <para><emphasis>Rx (Out)</emphasis>: +4 dBr</para>
                </listitem>
              </itemizedlist>
            </listitem>

            <listitem>
              <para><emphasis>4-Wire Transit</emphasis>:</para>

              <itemizedlist>
                <listitem>
                  <para><emphasis>Tx (In)</emphasis>: +4 dBr</para>
                </listitem>

                <listitem>
                  <para><emphasis>Rx (Out)</emphasis>: +4 dBr</para>
                </listitem>
              </itemizedlist>
            </listitem>

            <listitem>
              <para><emphasis>2-Wire Normal</emphasis>:</para>

              <itemizedlist>
                <listitem>
                  <para><emphasis>Tx (In)</emphasis>: 0 dBr</para>
                </listitem>

                <listitem>
                  <para><emphasis>Rx (Out)</emphasis>: -7 dBr</para>
                </listitem>
              </itemizedlist>
            </listitem>

            <listitem>
              <para><emphasis>2-Wire Transit</emphasis>:</para>

              <itemizedlist>
                <listitem>
                  <para><emphasis>Tx (In)</emphasis>: -3,5 dBr</para>
                </listitem>

                <listitem>
                  <para><emphasis>Rx (Out)</emphasis>: -3,5 dBr</para>
                </listitem>
              </itemizedlist>
            </listitem>
          </itemizedlist>
        </listitem>
      </itemizedlist>
    </section>

    <section id="voip.route">
      <title>Calls routing</title>

      <para>Cals routing adjustment is performed at the page
      Hardware/VoIP/Routes. It includes the table reflecting the
      correspondence of the routers identifiers to their IP-addresses. The
      content of the tab is shown below.</para>

      <figure>
        <title>Calls routing</title>

        <graphic fileref="img/wf2-voip-routes.png" width="6in" />
      </figure>

      <para>The table should include records with the identifier and the
      IP-address of the adjusted device. В таблице должна присутствовать
      запись с идентификатором и IP-адресом настраиваемого устройства. In this
      way the allocation of an identifier to the device and defining of the
      IP-address for work over VoIP is performed. As a comment to the record
      usually the word <emphasis>"self"</emphasis> is used.</para>

      <para>Addition of a new record to the table is shown in the figure
      below.</para>

      <figure id="voip.route.add">
        <title>Calls routing: addition of a new record</title>

        <graphic fileref="img/wf2-voip-routes-add.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Enabled</emphasis> — the record is active or not. If
          the recors is not active, it will not be added to the table of calls
          routing;</para>
        </listitem>

        <listitem>
          <para><emphasis>Router ID</emphasis> — three-digit number of the
          router for which the record is added;</para>
        </listitem>

        <listitem>
          <para><emphasis>Address</emphasis> — IP-address of the
          router;</para>
        </listitem>

        <listitem>
          <para><emphasis>Comment</emphasis> — comment to the record.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="voip.address">
      <title>Phone book</title>

      <para>The phonebook is located at the page Hardware/VoIP/Phone book. It
      is used for speed-dial of telephone numbers. For example, for the number
      100 02 833 the short number 10 can be set, and #10 can be used for
      dialling.</para>

      <figure>
        <title>Phone book</title>

        <graphic fileref="img/wf2-voip-phonebook.png" width="6in" />
      </figure>

      <para>Addition of a new record to the table is shown in the figure
      below.</para>

      <figure id="voip.address.add">
        <title>Phone book: addition of a new record</title>

        <graphic fileref="img/wf2-voip-phonebook-add.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Enabled</emphasis> — the record is active or not. If
          the record is not active, it will not be added to the configuration
          file.</para>
        </listitem>

        <listitem>
          <para><emphasis>Short number</emphasis> — two-digit short
          number.</para>
        </listitem>

        <listitem>
          <para><emphasis>Complete number</emphasis> — full number addressed
          when dialling "#short_number". When indicating the full number, the
          "_" symbol can be used to divide groupd of digits. Here a SIP-number
          can be indicated in the fromat:
          <emphasis>#sip:user1@domain#</emphasis>.</para>
        </listitem>

        <listitem>
          <para><emphasis>Comment</emphasis> — comment to the record.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="voip.audio">
      <title>Audio settings</title>

      <para>At the page Hardware/VoIP/Audio audio settings for FXO/FXS/VF
      channels can be made.</para>

      <figure>
        <title>Audio settings</title>

        <graphic fileref="img/wf2-voip-audio.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Tx.C</emphasis> — outgoing signal volume
          level;</para>
        </listitem>

        <listitem>
          <para><emphasis>Rx.C</emphasis> — incoming signal volume
          level;</para>
        </listitem>

        <listitem>
          <para><emphasis>VAD</emphasis> — voice activity detector;</para>
        </listitem>

        <listitem>
          <para><emphasis>HPF</emphasis> — income high-pass filter.</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="voip.codecs">
      <title>Codecs</title>

      <para>The adjustment of the codecs in use can be performed at the page
      Hardware/VoIP/Codecs. Codec settings are available for two directions of
      calls: <emphasis>Internal</emphasis> ­— calls between the devices, and
      <emphasis>External</emphasis> — calls via SIP-proxy.</para>

      <para>In the <emphasis>Priority settings</emphasis> tab the codec
      priority can be set. One codec can have only one priority level.</para>

      <figure>
        <title>Codec priority</title>

        <graphic fileref="img/wf2-voip-codecs-priority.png" width="6in" />
      </figure>

      <para>In the tabs <emphasis>Internal</emphasis> and
      <emphasis>External</emphasis> codec settings for the relevant call
      directions are made. Values on default are usually enough for most of
      the configurations.</para>

      <figure id="voip.codecs.settings">
        <title>Codec settings</title>

        <graphic fileref="img/wf2-voip-codecs-settings.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>Codec</emphasis> — codec name;</para>
        </listitem>

        <listitem>
          <para><emphasis>Pkt.time</emphasis> — packeting time;</para>
        </listitem>

        <listitem>
          <para><emphasis>Payload</emphasis> — identifier of the content of an
          RTP packet;</para>
        </listitem>

        <listitem>
          <para><emphasis>Bitpack</emphasis> —</para>
        </listitem>

        <listitem>
          <para><emphasis>JB type</emphasis> — jitter buffer type;</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>Fixed</emphasis> ;</para>
            </listitem>

            <listitem>
              <para><emphasis>Adaptive</emphasis> — adaptable;</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para><emphasis>LAT</emphasis> — Local Adaptation Type —</para>

          <itemizedlist>
            <listitem>
              <para><emphasis>off</emphasis> ;</para>
            </listitem>

            <listitem>
              <para><emphasis>on</emphasis>;</para>
            </listitem>

            <listitem>
              <para><emphasis>SI</emphasis> — with sample interpolaton
              —</para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para><emphasis>nScaling</emphasis> —</para>
        </listitem>

        <listitem>
          <para><emphasis>nInit</emphasis> —</para>
        </listitem>

        <listitem>
          <para><emphasis>nMin</emphasis> —</para>
        </listitem>

        <listitem>
          <para><emphasis>nMax</emphasis> —</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="voip.echo">
      <title>Echo cancellation settings</title>

      <para>Echo cancellation settings are made at the page
      Hardware/VoIP/Echo.</para>

      <figure>
        <title>Echo cancellation settings</title>

        <graphic fileref="img/wf2-voip-echo.png" width="6in" />
      </figure>

      <itemizedlist>
        <listitem>
          <para><emphasis>WLEC type</emphasis> — echo cancellation
          type;</para>
        </listitem>

        <listitem>
          <para><emphasis>NLP</emphasis> —</para>
        </listitem>

        <listitem>
          <para><emphasis>Near-end window</emphasis> —</para>
        </listitem>

        <listitem>
          <para><emphasis>Far-end window</emphasis> —</para>
        </listitem>
      </itemizedlist>
    </section>

    <section id="voip.dialmode">
      <title>Dialing mode settings</title>

      <para>Dialing mode settings are made at the page Hardware/VoIP/Dial
      mode. There is one setting — <emphasis>PSTN type</emphasis>. This
      parameter indicates which dialing mode is supported by the telephone
      station.</para>

      <figure>
        <title>Dialing mode settings</title>

        <graphic fileref="img/wf2-voip-dial-mode.png" width="6in" />
      </figure>
    </section>
  </chapter>

  <chapter id="snmp">
    <title>SNMP</title>

    <section id="intro">
      <title>Introduction to SNMP</title>

      <para><emphasis>SNMP</emphasis> — Simple Network Management Protocol.
      The protocol allows monitoring of network devices (routers,
      multiplexers, bridges etc.) and services (web-servers, mail servers,
      DNS-servers) and manage their configuration.</para>

      <para>Management and monitoring is performed according to agent-manager
      scheme. Agent is the software operating at the network device which is a
      subject for monitoring or management; manager - is the software
      collecting the dats from agents for monitoring or management. The
      cooperation is usually performed over the UDP transport protocol, port
      161. There is also a possibility of use the TCP protocol.</para>

      <para>The objects to which the operations (reading or recording) can be
      applied have unique numbers. For example, 1.3.6.1.2.1.1.1 corresponds to
      the object SysDescr — system description, which may have the following
      value: <emphasis>STRING Linux sigrand 2.6.16 #1 Tue Nov 7 21:37:48 NOVT
      2007 mips</emphasis> .</para>

      <para><abbrev>MIB</abbrev> — Management Information Base. MIB describes
      the objects and operations which can be applied to them. If the object
      is included in the MIB, it can be addressed by name and not by the
      digital index.</para>

      <para>Authentification is performed on the basis of the "community" -
      each agent is referred to this or that community. At the command
      reception the checking whether the agent refers to the community
      indicated in the command is carried out. If yes - the command will be
      accepted and processed, if no - ignored. Community is a simple line; on
      default two communities are used - public, for object browsing, and
      private - for object editing.</para>
    </section>

    <section id="support">
      <title>SNMP support level of the router</title>

      <para>For SNMP support the router uses an unbound software package
      <emphasis>net-snmp</emphasis> , supporting all the actual versions of
      SNMP, which includes the <emphasis>snmpd</emphasis> daemon functioning
      as an agent.</para>

      <para>The router supports <emphasis>MIB-2</emphasis> which provides
      general information about the system (network interfaces, routing
      tables, system data), and <emphasis>HDSL2-SHDSL-LINE-MIB</emphasis>
      which includes the objects used for SHDSL channels monitoring and
      management.</para>

      <para>MIB-2 is a standard MIB and is included in the majority of
      managers, while HDSL2-SHDSL-LINE-MIB is type-specific. This file can be
      downloaded from the Internet sources or by <ulink
      url="http://sigrand.ru:8280/temp/HDSL2-SHDSL-LINE-MIB-rfc4319.txt">reference</ulink>
      .</para>

      <para>At the moment only monitoring of the router SNMP and SHDSL
      channels and regenerators is available, the management option will be
      added soon.</para>
    </section>

    <section id="snmpd">
      <title>SNMPD settings</title>

      <para>The settings of the <emphasis>snmpd</emphasis> daemon are stored
      in the file <emphasis>/etc/snmp/snmpd.conf</emphasis> and consists in
      setting of tokens for receiving and editing of objects.</para>

      <para>The content of the configuration file looks as follows:</para>

      <programlisting>
				com2sec ro default public
				com2sec rw localhost private

				group public v1 ro
				group public v2c ro
				group public usm ro
				group
				private v1 rw
				group private v2c rw
				group private usm rw

				view all included .1

				access public "" any noauth exact all none none
				access private "" any
				noauth exact all all all
			</programlisting>

      <para>The <emphasis>com2sec</emphasis> command establiches a
      correspondence between a community and a token, and defines the
      addresses which can be referred to these communities. In the
      configuration file above the first command defines that thecommunity
      "public" complies with the RO security, and that it is corresponds to
      all IP-addresses. The second command defines the compliance of the
      "private" community with the RW security, and limit the access to the
      router itself.</para>

      <para>The <emphasis>group</emphasis> command defines which security
      corresponds to which group. In our example, RO security corresponds to
      the group "public", RW security - to the group "prvate". v1, v2c, usm
      define the security model. v1 refers to SNMP ver.1, v2c — to ver.2, usm
      — SNMPv3.</para>

      <para>The <emphasis>view</emphasis> command defines the name of scope
      and what it includes. In our case, the scope name — all, and it includes
      the overall MIB tree.</para>

      <para>The last command - <emphasis>access</emphasis> - defines the
      access rights for different groups. In our example for both groups
      access without authentification is allowed, but in case of "public"
      group - only for reading, "private" group - for reading and
      editing.</para>

      <para>For further information visit the web site net-snmp, in particular
      the folowing <ulink
      url="http://net-snmp.sourceforge.net/wiki/index.php/Vacm">reference</ulink>
      .</para>
    </section>

    <section>
      <title>Interaction of SNMPD with EOCD</title>

      <para><emphasis>SNMPD</emphasis> receives the SHDSL-channel status data
      from the daemon <emphasis>EOCD</emphasis> . Therefore, in order to
      receive data conserning the state of the SHDSL-channel via SNMP, the
      EOCD daemon should be adjusted. After the data is available via the
      <command>eoc-info</command> utility — the data can be received via SNMP.
      The detailed information about the functionality and adjustment of the
      EOCD daemon is given in chapter <link endterm="eoc.title"
      linkend="eoc"></link> .</para>
    </section>

    <section>
      <title>Usage example</title>

      <para>As an example lets look at the router SHDSL-channel monitoring
      function. For this obtain data about the number of regenerators, signal
      attenuation and signal/noise ratio.</para>

      <para>Digital name of the object corresponds to the number of
      regenerators installed on line (Hdsl2ShdslStatusNumAvailRepeaters),
      equal to1.1.3.6.1.2.1.10.48.1.2.1.1. For signal attenuation
      (Hdsl2ShdslEndpointCurrAtn) the name is equal to
      1.1.3.6.1.2.1.10.48.1.5.1.1.11.1.2.1 for the client-side (slave) and
      1.3.6.1.2.1.10.48.1.5.1.1.11.2.1.1 for master, and for signal/noise
      ratio(Hdsl2ShdslEndpointCurrSnrMgn) — 1.3.6.1.2.1.10.48.1.5.1.2.11.1.2.1
      and 1.3.6.1.2.1.10.48.1.5.1.2.11.2.1.1 accordingly. Values of these
      parameters are given below:</para>

      <programlisting>
				1.3.6.1.2.1.10.48.1.2.1.1.11 = Gauge32 0
				1.3.6.1.2.1.10.48.1.5.1.1.11.1.2.1 = INTEGER 0
				1.3.6.1.2.1.10.48.1.5.1.1.11.2.1.1 = INTEGER 0
				1.3.6.1.2.1.10.48.1.5.1.2.11.1.2.1 = INTEGER 19
				1.3.6.1.2.1.10.48.1.5.1.2.11.2.1.1 = INTEGER 17
			</programlisting>

      <para>I.e. the number of regenerators is 0, signal attenuation on both
      end of the connection — 0 dB, signal/noise ratio on client-side -19 dB,
      on master-side - 17 dB.</para>

      <para>When using specialized software supporting MIB loading it is
      possible to obtain information in a more convenient form.</para>
    </section>

    <section>
      <title>Supported software for management via SNMP</title>

      <para>For the purpose of SNMP support an unbound software package
      <emphasis>net-snmp</emphasis> is used, which allows to work with all
      software solutions compatible with net-snmp.</para>

      <para>In addition a brief review of the available software was made. The
      results are given below.</para>

      <section>
        <title>The Dude</title>

        <para><emphasis>The Dude</emphasis> — is a free software product for
        work at SNMP protocol, works in MS Windows OS.</para>

        <figure>
          <title>The Dude</title>

          <graphic fileref="img/thedude.png" width="6in" />
        </figure>

        <para>Advantages:</para>

        <itemizedlist>
          <listitem>
            <para>Identifies the network devices automatically.</para>
          </listitem>

          <listitem>
            <para>Build network map, allows addition of new devices to the
            map, output the values of SNMP-variables.</para>
          </listitem>

          <listitem>
            <para>Performs the device monitoring, graphing in real-time
            mode.</para>
          </listitem>

          <listitem>
            <para>Has several friendly integrated utilities for network
            administration and monitoring (terminals, snmpwalk).</para>
          </listitem>

          <listitem>
            <para>Friendly modes of SNMP data browsing (list, tree,
            table).</para>
          </listitem>
        </itemizedlist>

        <para>Disadvantages:</para>

        <itemizedlist>
          <listitem>
            <para>Interface indexes are displayed incorrectly in table
            view.</para>
          </listitem>

          <listitem>
            <para>Incorrect displaying of SnmpAdminString for SHDSL profiles
            names is possible.</para>
          </listitem>
        </itemizedlist>

        <figure>
          <title>The Dude: Sigrand routers</title>

          <graphic fileref="img/thedude2.png" width="6in" />
        </figure>

        <para>Homepage of the project: <ulink
        url="http://www.mikrotik.com/thedude.php">The Dude</ulink>.</para>
      </section>

      <section>
        <title>MIB Browser</title>

        <para><emphasis>MIB Browser</emphasis> , a product of the company
        iReasoning, available in pay and free versions which differ in license
        agreements and functionality. The support of Windows, Mac OS X and
        Linux OS is declared.</para>

        <figure>
          <title>MIB Browser</title>

          <graphic fileref="img/mibbrowser.png" width="6in" />
        </figure>

        <para>Advantages:</para>

        <itemizedlist>
          <listitem>
            <para>Friendly interface.</para>
          </listitem>

          <listitem>
            <para>Table view of SNMP tables.</para>
          </listitem>
        </itemizedlist>

        <para>Disdvantages:</para>

        <itemizedlist>
          <listitem>
            <para>The free version does nor support SNMPv3, allows downloading
            no more than 5 MIBs to the existing.</para>
          </listitem>

          <listitem>
            <para>Incorrect displaying of SnmpAdminString is possible for
            SHDSL profiles names.</para>
          </listitem>
        </itemizedlist>

        <para>Homepage of the project: <ulink
        url="http://www.ireasoning.com/mibbrowser.shtml">MIB
        Browser</ulink>.</para>
      </section>

      <section>
        <title>OpenNMS</title>

        <para><emphasis>OpenNMS</emphasis> — a web application written in
        Java, uses DBMS PostreSQL and Apache Tomcat for operation, allows
        monitoring of industrial networks. It is a free software, available
        for the pletforms on which Apache Tomcat works (usually these are
        Linux servers).</para>

        <figure>
          <title>OpenNMS</title>

          <graphic fileref="img/opennms.png" width="6in" />
        </figure>

        <para>Advantages:</para>

        <itemizedlist>
          <listitem>
            <para>OpenNMS, apparently, uses <emphasis>net-snmp</emphasis> for
            work under SNMP, which provides full compatibility with
            <emphasis>Sigrand</emphasis> devices.</para>
          </listitem>
        </itemizedlist>

        <para>Homepage of the project: <ulink
        url="http://www.opennms.org/index.php/Main_Page">OpenNMS</ulink>.</para>
      </section>
    </section>
  </chapter>

  <chapter id="examples">
    <title>Configuration examples</title>

    <section id="examples.vlan">
      <title>VLAN</title>

      <section id="examples.vlan.scheme1">
        <title>Setting of independent channels between
        Ethernet-interfaces</title>

        <para>The given example considers the setting of independent channels
        between the Ethernet-ports of the devices connected via SHDSL.</para>

        <para>Let`s consider the arrangement of data communication fronm the
        port eth3 of one device to the port eth3 of another device via SHDSL
        connection. If necessary, all ports of the devices can be used (eth0,
        eth1, eth2). The pattern of interaction between the devices can be
        represented as follows:</para>

        <figure>
          <title>Interaction pattern</title>

          <graphic fileref="img/scheme1-struct.png" width="6in" />
        </figure>

        <para>The devices are connected via two SHDSL channels which are
        bonded. On the bonding there created a VLAN with VLAN ID 4. The bridge
        actualize packet-mode communication between the interfaces bond0v4
        (VLAN interface) and eth3.</para>

        <para>The adjustment begins from the adjustment od the physical
        connection between the routers (see <link linkend="dsl">SHDSL
        settings</link>).</para>

        <para>Then we create a bonding of the interfaces dsl0 and dsl1 (see
        <link linkend="bonding">Bonding settings</link>). In the result we get
        the interface <emphasis>bond0</emphasis>.</para>

        <para>After that we need to create a VLAN on the bonding. The number
        of VLAN interfaces depends on the number of ethernet-ports between
        which we are going to establish an independent data transfer - one
        VLAN for each port. The VLAN interface setting procedure is described
        in details in the relevant <link linkend="vlan">chapter</link>. I.e.
        we need to create a VLAN interface with VLAN ID 4 on the bond0
        interface. As a result, we have the interface
        <emphasis>bond0v4</emphasis>.</para>

        <para>The final step is bridging (see <link linkend="bridge">bridge
        settings</link>). Bridge consists of the interfaces
        <emphasis>bond0v4</emphasis> and <emphasis>eth3</emphasis>, between
        which the traffic transfer is performed. The number of bridges depends
        on the number of ports used for data exchange - one bridge for each
        port.</para>

        <para>Thus, if we want to arrange the exchange between the ports eth2,
        we should create one more VLAN on the interface
        <emphasis>bond0</emphasis>, for example, with VLAN ID 3, create one
        more bridge interface and add the interfaces
        <emphasis>bond0v3</emphasis> and <emphasis>eth2</emphasis> to
        it.</para>

        <note>
          <para>If it is necessary to arrange a device management via the port
          which participates in data transfer (included in the bridge), its
          IP-address (at which the settings are made) should be allocated to
          the interface of the bridge. The detailed information is given in
          the relevant <link linkend="manage">chapter</link>.</para>
        </note>
      </section>

      <section id="examples.vlan.scheme3">
        <title>Traffic distribution along Ethernet-ports according to VLAN
        ID</title>

        <para>Suppose that we want to arrange a transfer of VLAN-traffic
        incoming to the trunk-port of one device via SHDSL-channel, and
        transfer traffic (without VLAN tag) to the relevant ethernet-port
        depending on the VLAN ID on the other device.</para>

        <figure>
          <title>Structure chart</title>

          <graphic fileref="img/scheme3-struct.png" width="6in" />
        </figure>

        <para>The idea of the given arrangement consists in that at the
        SG-17R-2 device, one of the ports of which functions as a trunk-port,
        we create VLAN interfaces which traffic should be transmitted to the
        relevant ports of the other device.</para>

        <para>For example, to the SG-17R-2 device (let`s say to the 4th
        ethernet-port) there connected a network, in which there are
        functioning several VLAN networks with numbers 3 and 4. We need to
        connect the VLAN ID 3 network to the network connected to the 3rd
        ethernet-port of the SG-17R-1 device. We also need to connect the VLAN
        ID 4 network to the network connected to the 4th ethernet port of the
        SG-17R-1 device. It should be noted that the networks connected to
        SG-17R-2 are simple LAN networks, and therefore the traffic
        transmitted to them should not contain "VLAN" tags.</para>

        <para>The adjustment of the given arrangement is divided onto two
        steps: adjustment of SG-17R-1 and adjustment of SG-17R-2. It is
        understood that the physical connection between the devices (for
        example, via SHDSL)is already adjusted. In our example we use bonding
        over SHDSL channels.</para>

        <section>
          <title>Adjustment of SG-17R-1</title>

          <para>In general the adjustments consists in creation of VLAN
          interfaces over the bonding interface, and bridging of the relevant
          ethernet-interface and VLAN interface. Let`s consider it in more
          detail.</para>

          <para>Create the VLAN interface with VLAN ID 4 on the interface
          <emphasis>bond0</emphasis> (see <link linkend="vlan">VLAN
          settings</link>). The name of the new interface is
          <emphasis>bond0v4</emphasis>. Here we also create a bridge interface
          named, for example, <emphasis>br0</emphasis>. Integrate in it the
          interfaces between which the traffic will bw transferred:
          <emphasis>bond0v4</emphasis> and <emphasis>eth3</emphasis>.</para>

          <para>If it is necessary to arrange the transmission of several VLAN
          to the ports of SG-17R-1, the gives procedure should be repeated for
          each VLAN. In the given configuration the maximum number of VLAN is
          4,cas it is limited by the number of ethernet-ports of the
          device.</para>
        </section>

        <section>
          <title>Adjustnment of SG-17R-2</title>

          <para>Before starting we should deside which of the ethernet-ports
          of the device will function as a trunk-port, i.e. to which port the
          VLAN networks will be connected.</para>

          <para>For the chosen trunk-port we create a VLAN interface and the
          corresponding VLAN interface on the basis of the interface of the
          bonding. Than we arrange a bridge between the existing interface of
          the trunk-port and the VLAN interface of the bonding. The thing is
          that each VLAN interface created on the trunk-port receives its own
          traffic and transmit it to its "own" bonding interface. On the
          second device (SG-17R-1) the bonding trasnfer it to the relevant
          ethernet-port. Let`s consider these actions in more detail.</para>

          <para>The adjustment begins from the creation of VLAN interfaces
          with similar VLAN ID on the interfaces of the bonding (for example,
          <emphasis>bond0</emphasis>) and of the ethernet-port functioning as
          a trunk-port (<emphasis>eth3</emphasis>). Suppose the created
          interfaces have the names <emphasis>bond0v4</emphasis> and
          <emphasis>eth3v4</emphasis>. Here we also create the interfaces of
          the bridge, one for each pair of VLAN interfaces. For example, we
          add the interfaces <emphasis>bond0v4</emphasis> and
          <emphasis>eth3v4</emphasis> to the first interface.</para>

          <para>Thus we have one or several bridge interfaces, trasmitting
          traffic between VLAN interfaces which were created on the trunk-port
          and on the bonding.</para>
        </section>
      </section>

      <section id="examples.vlan.manage_vlan">
        <title>Device management access control via VLAN</title>

        <para>For controlling the access to the device management VLAN
        technology can be used. For this purpose, on the basis of the
        interface trough which the management is conducted we create a VLAN
        interface to which we allocate an IP-address, deleting the IP-address
        of the underlying interface.</para>
      </section>
    </section>

    <section id="manage">
      <title>Management of device control via the interface integrated in a
      bridge or bonding</title>

      <para>В случае, если порт, через который осуществляется управление
      устройством, необходимо добавить в состав бриджа или бондинга, IP-адрес,
      используемый для управления, следует назначить интерфейсу, в состав
      которого включается порт. For example, the port eth0 is used for device
      control and the allocated IP-address is 192.168.2.100. Than while
      intergating the port in the bridge (interface br0), the interface br0
      gets the allocated IP-address 192.168.2.100.</para>

      <tip>
        <para>In case when the bridge interface gets the same IP-address which
        was allocated to the port interface, temporery loss of connection with
        the device is possible. It happens because the MSC-address of the
        bridge is related to one of the interfaces it incorporates, and if the
        chosen MAC-address differs from that of the interface of the port to
        which the IP-address belonged, the correlation between the MAC-address
        and IP-address in the local APR-cach of the computer should be
        changed. It can be done manually by means of deleting the
        correspondent record from the APR-cach, of automatically after a
        while.</para>
      </tip>
    </section>

    <section id="examples.multiplexing">
      <title>Multiplexing</title>

      <para>Let`s consider multiplexing on the following example:</para>

      <figure>
        <title>Network example</title>

        <graphic fileref="img/multiplexing-ex1.png" width="6in" />
      </figure>

      <para>Two E1 channels (unframed mode) should be transmitted from PBX to
      Client 1 and Client 2 via SHDSL channel.</para>

      <para>As far as the signal source is similar for both channelsE1 — АPBX,
      it does not matter which of the E1 interfaces will synchronize the
      multiplexing lines. We have 16 lines, 256 time-slots each. For
      convenience we will use two of them - one for traffic reception, the
      other - for traffic transmission.</para>

      <para>The scheme of multiplexing will be the following:</para>

      <itemizedlist>
        <listitem>
          <para>InterfaceE1 <parameter>E1_0</parameter> receives data from the
          physical line and transfer it to the line 0 (from 0 time-slot). The
          data for transmission to the physical line are taken from the line
          1, from o time-slot. This interface also functions as a source of
          synchronization for the domain.</para>
        </listitem>

        <listitem>
          <para>Interface E1 <parameter>E1_1</parameter> functions as
          <parameter>E1_0</parameter>, but places and tekes data begining from
          the 32 time-slot (and does not transmit the synchro-signal, i.e.
          functions in <emphasis>clock slave</emphasis> mode).</para>
        </listitem>

        <listitem>
          <para>InterfaceSHDSL <parameter>dsl0</parameter> places the data
          obtained from the physical line to the line1 (from which they are
          taken by E1 interfaces), and the data for transmission to the
          physical line are taken from the line 0 (where E1 interfaces place
          it). The number of time-slots used by the interface for multiplexing
          - 64 (32 from each E1 interface).</para>
        </listitem>
      </itemizedlist>

      <para>The described arrangement id represented below:</para>

      <figure>
        <title>Interface interaction, line 0</title>

        <graphic fileref="img/multiplexing-ex1-1-line0.png" width="6in" />
      </figure>

      <figure>
        <title>Interface interaction, line 1</title>

        <graphic fileref="img/multiplexing-ex1-1-line1.png" width="6in" />
      </figure>

      <para>For the realization of the scheme the following parameters should
      be set:</para>

      <itemizedlist>
        <listitem>
          <para>Interface E1 <emphasis>E1_0</emphasis></para>

          <itemizedlist>
            <listitem>
              <para><parameter>rline = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>rfs = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>tline = 1</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>tfs = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>mxsmap = "0-31"</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>clkm = 1</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>clkr = 1</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>clkab = 0</parameter></para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>Interface E1 <emphasis>E1_1</emphasis></para>

          <itemizedlist>
            <listitem>
              <para><parameter>rline = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>rfs = 32</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>tline = 1</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>tfs = 32</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>mxsmap = "0-31"</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>clkm = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>clkr = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>clkab = 0</parameter></para>
            </listitem>
          </itemizedlist>
        </listitem>

        <listitem>
          <para>Interface SHDSL <emphasis>dsl0</emphasis></para>

          <itemizedlist>
            <listitem>
              <para><parameter>rline = 1</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>rfs = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>tline = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>tfs = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>mxrate = 64</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>clkm = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>clkr = 0</parameter></para>
            </listitem>

            <listitem>
              <para><parameter>clkab = 0</parameter></para>
            </listitem>
          </itemizedlist>
        </listitem>
      </itemizedlist>

      <note>
        <para>For these interfaces the multiplexing mode should be activated -
        set the parameter <parameter>mxen</parameter>.</para>
      </note>

      <para>The configuration on the second router can be set in the same way.
      The only difference in this case consists in change of the interface
      functioning as a source of synchronization. This function will be
      performed by the interface SHDSL <parameter>dsl0</parameter>, as far as
      it is the interface which receive the multiplexed flow from the first
      router connected to the PBX.</para>

      <tip>
        <para>For traffic reception and transmission separate lines should not
        necessarily be used. For these purposes we can use one line under the
        condition that we correctly indicate the time-slots starting from
        which each interface places or takes data from the line. An example of
        such configuration is given below:</para>
      </tip>

      <figure>
        <title>Usage of a single line for data transfer in both
        directions</title>

        <graphic fileref="img/multiplexing-ex1-2-line.png" width="6in" />
      </figure>
    </section>

    <section id="examples.voip">
      <title>VoIP</title>

      <section id="examples.voip.ex1">
        <title>Common telephones function as a pair of IP-telephones</title>

        <para>Install on the router VoIP modules with FXS channels to which
        connect common POTS telephones. Using these telephones it is possible
        to make calls to the telephones connected to the given router or to
        other Singand routers. An example of connection pattern is given
        below.</para>

        <figure>
          <title>Common telephone function as a pair of IP-telephones</title>

          <graphic fileref="img/voip-ex1.png" width="6in" />
        </figure>

        <para>In the given example in the network there are operating two
        routers with numbers 032 and 033 and addresses 10.0.0.2 and 10.0.0.1
        accordingly. Each router is connected to a POTS telephone; the routers
        are interconnected via any technology — Ethernet, SHDSL or E1.</para>

        <para>For IP-telephony adjustment it is necessary to put the data into
        the routing tables, address book and Hotline tables. For convenience
        the examples of settings are given in form of textual tables given
        below. .</para>

        <para>The routing table has the same content at all the routers of the
        network, as you can see below.</para>

        <table align="center" frame="all">
          <title>Routing table</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Router #</entry>

                <entry>Router address</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>032</entry>

                <entry>10.0.0.2</entry>

                <entry>Router 032</entry>
              </row>

              <row>
                <entry>033</entry>

                <entry>10.0.0.1</entry>

                <entry>Router 033</entry>
              </row>
            </tbody>
          </tgroup>
        </table>

        <para>Address book should be filled for each router seperately, as far
        as different short number can be used. Address books of the routers is
        given below.</para>

        <table align="center" frame="all">
          <title>Address book of the router 032</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Short number</entry>

                <entry>Full number</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>00</entry>

                <entry>* 01</entry>

                <entry>Telephone 1 (первый вариант набора номера)</entry>
              </row>

              <row>
                <entry>01</entry>

                <entry>032 02</entry>

                <entry>Telephone 2 (второй вариант набора номера)</entry>
              </row>

              <row>
                <entry>02</entry>

                <entry>033 01</entry>

                <entry>Telephone 3</entry>
              </row>

              <row>
                <entry>03</entry>

                <entry>033 02</entry>

                <entry>Telephone 4</entry>
              </row>
            </tbody>
          </tgroup>
        </table>

        <table align="center" frame="all">
          <title>Address book of the router 033</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Short number</entry>

                <entry>Full number</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>00</entry>

                <entry>032 01</entry>

                <entry>Telephone 1</entry>
              </row>

              <row>
                <entry>01</entry>

                <entry>032 02</entry>

                <entry>Telephone 2</entry>
              </row>

              <row>
                <entry>02</entry>

                <entry>* 01</entry>

                <entry>Telephone 3</entry>
              </row>

              <row>
                <entry>03</entry>

                <entry>* 02</entry>

                <entry>Telephone 4</entry>
              </row>
            </tbody>
          </tgroup>
        </table>

        <para>In this configuration the following dialing modes are
        available:</para>

        <itemizedlist>
          <listitem>
            <para>From telephone 1 to telephone 2:</para>

            <orderedlist>
              <listitem>
                <para>directly:</para>

                <orderedlist>
                  <listitem>
                    <para>* 02</para>
                  </listitem>

                  <listitem>
                    <para>032 02 (with indication of the own router
                    number)</para>
                  </listitem>
                </orderedlist>
              </listitem>

              <listitem>
                <para>via the address book: #01</para>
              </listitem>
            </orderedlist>
          </listitem>

          <listitem>
            <para>From telephone 1 to telephone 4:</para>

            <orderedlist>
              <listitem>
                <para>directly: 033 02</para>
              </listitem>

              <listitem>
                <para>via the address book: #03</para>
              </listitem>
            </orderedlist>
          </listitem>
        </itemizedlist>

        <para>In Hotline mode the configuration can be arranged in which there
        will be initiated an automatic dialling of the number pre-set for the
        FSX channel (to which the telephone is connected) by lifting of a
        hand-set. Hotline settings for the router 032 are given in the table
        below.</para>

        <table align="center" frame="all">
          <title>Hotline table for the router 032</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Channel #</entry>

                <entry>Full number</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>01 (FXS)</entry>

                <entry>033 01</entry>

                <entry>Automatic call to telephone 3</entry>
              </row>

              <row>
                <entry>02 (FXS)</entry>

                <entry>032 01</entry>

                <entry>Automatic call to telephone 1</entry>
              </row>
            </tbody>
          </tgroup>
        </table>

        <para>This configuration sets the following behavior:</para>

        <itemizedlist>
          <listitem>
            <para>when lifting the hand-set of telephone 1 an automatic call
            to telephone 3 is made.</para>
          </listitem>

          <listitem>
            <para>when lifting the hand-set of telephone 2 an automatic call
            to telephone 1 is made.</para>
          </listitem>
        </itemizedlist>
      </section>

      <section id="examples.voip.ex3">
        <title>Communication arrangement via PBX</title>

        <para>Install on the router VoIP modules with FXS channels for
        connection to POTS telephones, and FXO for connection to PBX - for
        example, to a city network (PSTN). The port 322 120 of the PBX is
        reserved for the router. The scheme is given below.</para>

        <figure>
          <title>Communication arrangement via PBX</title>

          <graphic fileref="img/voip-ex3.png" width="6in" />
        </figure>

        <para>In this case the routing table is not used; the address book can
        be adjusted for speed-dial. The settings for the address book are
        given in the table below.</para>

        <table align="center" frame="all">
          <title>Address book</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Short number</entry>

                <entry>Full number</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>00</entry>

                <entry>* 01</entry>

                <entry>Telephone 1</entry>
              </row>

              <row>
                <entry>01</entry>

                <entry>032 02</entry>

                <entry>Telephone 2</entry>
              </row>

              <row>
                <entry>02</entry>

                <entry>* * , 322 123</entry>

                <entry>Telephone 3</entry>
              </row>

              <row>
                <entry>03</entry>

                <entry>032 * , 322 124</entry>

                <entry>Telephone 4</entry>
              </row>
            </tbody>
          </tgroup>
        </table>

        <note>
          <para>The «*» symbol instead of the channel number denotes the call
          via the first unoccupied channel FXO. In our case there is only one
          FXO, and we can always ude this symbol for the faster
          dialling.</para>
        </note>

        <para>In this configuration the following dialing modes are
        available:</para>

        <itemizedlist>
          <listitem>
            <para>From telephone 1 to telephone 2:</para>

            <orderedlist>
              <listitem>
                <para>directly: * 02</para>
              </listitem>

              <listitem>
                <para>via the address book: #01</para>
              </listitem>
            </orderedlist>
          </listitem>

          <listitem>
            <para>From telephone 2 to telephone 4:</para>

            <orderedlist>
              <listitem>
                <para>directly: * *, wait for a signal from PBX, 322
                124</para>
              </listitem>

              <listitem>
                <para>via the address book: #03</para>
              </listitem>
            </orderedlist>
          </listitem>

          <listitem>
            <para>From telephone 3 to telephone 1:</para>

            <orderedlist>
              <listitem>
                <para>directly:</para>

                <orderedlist>
                  <listitem>
                    <para>322 120, wait for a signal from the router, *
                    01</para>
                  </listitem>

                  <listitem>
                    <para>322 120, wait for a signal from the router, 032
                    01</para>
                  </listitem>
                </orderedlist>
              </listitem>
            </orderedlist>
          </listitem>
        </itemizedlist>

        <para>The Hotline mode allows realization of the behaviours given in
        the table below.</para>

        <table align="center" frame="all">
          <title>Hotline table for the router</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Channel #</entry>

                <entry>Full number</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>01 (FXS)</entry>

                <entry>* * , 322 124</entry>

                <entry>Automatic call when the hand-set is lifted at the
                telephone 1 to telephone 4</entry>
              </row>

              <row>
                <entry>03 (FXO)</entry>

                <entry>* 01</entry>

                <entry>Redirection of the incoming calls from PSTN to
                telephone 1</entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </section>

      <section id="examples.voip.ex4">
        <title>Arrangement of communication via PBX using two routers</title>

        <para>Let`s consider a more complicated version of the network
        described in thr previous example. there are two routers operating on
        line to which POTS telephones are connected. The routers are
        interconnected by means of Ethernet/SHDSL/E1, and one of the routers
        is connected to the PBX. We need to realize the possibility of calls
        between the telephones, connected to the routers and between the
        routers and the PBX. The scheme is given below.</para>

        <figure>
          <title>Arrangement of communication via PBX using two
          routers</title>

          <graphic fileref="img/voip-ex4.png" width="6in" />
        </figure>

        <para>As far as there are two routers operating in the network, we
        need to adjust the VoIP routing table (tab Routes), as shown
        below.</para>

        <table align="center" frame="all">
          <title>Routing table</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Router #</entry>

                <entry>Router address</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>032</entry>

                <entry>10.0.0.2</entry>

                <entry>Router 032</entry>
              </row>

              <row>
                <entry>033</entry>

                <entry>10.0.0.1</entry>

                <entry>Router 033</entry>
              </row>
            </tbody>
          </tgroup>
        </table>

        <para>For speed-dial adjust the address book for each router as shown
        in tables below.</para>

        <table align="center" frame="all">
          <title>Address book of the router 032</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Short number</entry>

                <entry>Full number</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>00</entry>

                <entry>* 01</entry>

                <entry>Telephone 1</entry>
              </row>

              <row>
                <entry>01</entry>

                <entry>* 02</entry>

                <entry>Telephone 2</entry>
              </row>

              <row>
                <entry>02</entry>

                <entry>033 02</entry>

                <entry>Telephone 5</entry>
              </row>

              <row>
                <entry>03</entry>

                <entry>033 * , 322 123</entry>

                <entry>Telephone 3</entry>
              </row>

              <row>
                <entry>04</entry>

                <entry>033 * , 322 124</entry>

                <entry>Telephone 4</entry>
              </row>
            </tbody>
          </tgroup>
        </table>

        <table align="center" frame="all">
          <title>Address book of the router 033</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Short number</entry>

                <entry>Full number</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>00</entry>

                <entry>032 01</entry>

                <entry>Telephone 1</entry>
              </row>

              <row>
                <entry>01</entry>

                <entry>032 02</entry>

                <entry>Telephone 2</entry>
              </row>

              <row>
                <entry>02</entry>

                <entry>* * , 322 123</entry>

                <entry>Telephone 3</entry>
              </row>

              <row>
                <entry>03</entry>

                <entry>* * , 322 124</entry>

                <entry>Telephone 4</entry>
              </row>
            </tbody>
          </tgroup>
        </table>

        <para>In this configuration the following dialing modes are
        available:</para>

        <itemizedlist>
          <listitem>
            <para>From telephone 1 to telephone 2:</para>

            <orderedlist>
              <listitem>
                <para>directly: * 02</para>
              </listitem>

              <listitem>
                <para>via the address book: #01</para>
              </listitem>
            </orderedlist>
          </listitem>

          <listitem>
            <para>From telephone 2 to telephone 4:</para>

            <orderedlist>
              <listitem>
                <para>directly: 033 *, wait for a signal from the PBX, 322
                124</para>
              </listitem>

              <listitem>
                <para>via the address book: #04</para>
              </listitem>
            </orderedlist>
          </listitem>

          <listitem>
            <para>From telephone 2 to telephone 5:</para>

            <orderedlist>
              <listitem>
                <para>directly: 033 02</para>
              </listitem>

              <listitem>
                <para>via the address book: #02</para>
              </listitem>
            </orderedlist>
          </listitem>

          <listitem>
            <para>From telephone 3 to telephone 2:</para>

            <orderedlist>
              <listitem>
                <para>directly: 322 120, wait for a signal from the router,
                032 02</para>
              </listitem>
            </orderedlist>
          </listitem>
        </itemizedlist>

        <para>Also adjust the Hotline mode as shown in tables below.</para>

        <table align="center" frame="all">
          <title>Hotline table for the router 032</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Channel #</entry>

                <entry>Full number</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>01 (FXS)</entry>

                <entry>033 02</entry>

                <entry>Automatic call when the hand-set is lifted at the
                telephone 1 to telephone 5</entry>
              </row>

              <row>
                <entry>02 (FXS)</entry>

                <entry>033 *, 322 124</entry>

                <entry>Automatic call when the hand-set is lifted at the
                telephone 2 to telephone 4</entry>
              </row>
            </tbody>
          </tgroup>
        </table>

        <table align="center" frame="all">
          <title>Hotline table for the router 033</title>

          <tgroup cols="3">
            <thead>
              <row>
                <entry>Channel #</entry>

                <entry>Full number</entry>

                <entry>Comment</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry>01 (FX0)</entry>

                <entry>032 02</entry>

                <entry>Redirection of the incoming calls from PSTN to
                telephone 2</entry>
              </row>

              <row>
                <entry>02 (FXO)</entry>

                <entry>* * , 322 123</entry>

                <entry>Automatic call when the hand-set is lifted at the
                telephone 5 to telephone 3</entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </section>
    </section>
  </chapter>

  <chapter id="warranty">
    <title>Warranty and liabilities</title>

    <para>The Manufacturer guarantees the operability of the router under the
    condition that the user obliges the operating rules.</para>

    <para>Warranty period - 5 years from the date of purchase indicated in the
    certificate, or, in the absence thereof, from the date of manufacturing
    indicated on the label.</para>

    <warning>
      <para>Warranty is cancelled for routers used in overhead lines or in
      lines with a combined method of construction.</para>
    </warning>
  </chapter>
</book>
